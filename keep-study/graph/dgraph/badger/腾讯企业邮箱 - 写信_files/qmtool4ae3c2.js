!function(e){try{document.domain="exmail.qq.com"}catch(s){}var t="$_home_qspace_dev_tools_codeSyncFiles_webmail_QQMail_tmp_js_ascii__qmtool_Log",n="goJsConlog",i=e;try{for(;i.parent!=i;)i=i.parent}catch(s){}try{if(!i.QMJsConlog){var o=function l(){if(e.ActiveXObject)try{return new e.ActiveXObject("MSXML2.XMLHTTP")}catch(s){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(s){}}if(e.XMLHttpRequest)return new e.XMLHttpRequest;console.log("no ajax plugin")}();o.onreadystatechange=function(){if(4==o.readyState&&200==o.status&&!i.QMJsConlog){var e=i.document,t=e.getElementsByTagName("head")[0]||e.documentElement,n=e.createElement("script");n.type="text/javascript",n.text=o.responseText,t.insertBefore(n,t.firstChild),t.removeChild(n)}},o.open("GET","//"+e.location.host+"/zh_CN/htmledition/js_biz/dev/qmjsconlog.js",!1),o.send()}var a=i.QMJsConlog("/home/qspace/dev_tools/codeSyncFiles/webmail/QQMail/tmp/js_ascii//qmtool.js",e,n);e[t]=a}catch(s){var r=e[n];r||((r=e[n]={}).addJslevel=r.subJslevel=function(){}),e[t]=function(){};try{console.log("QMJsConlog load error")}catch(s){}}}(window);var _gnQmToolStart=(new Date).getTime(),_goClass,_goStatic,qmAnimation=function(e){this._mTimerId=null,this._mOptList=[],this._mDefOpts={},this._setOptions(e,!0)};_goStatic=qmAnimation,_goClass=_goStatic.prototype,_goClass.play=function(e){"function"==typeof e?this._mTimerId?this._mOptList.push(e):this._play(e(),!0):(this.stop(),this._play(e))},_goClass.stop=function(){var n=this,e=this._mOptList;this._mOptList=[],this._stop(),E(e,function(e){var t=e();t&&(n._setOptions(t),"function"==typeof n._mOnComplete&&n._mOnComplete.call(n,n._mTo,!0))})},_goClass.updateStyle=function(e,t,n){var i=this._moBakStyle||(this._moBakStyle={}),o=t.style;if(n)for(var a in i[e]=o.cssText,n)o[a]=n[a];else o.cssText=i[e]},_goClass._action=function(e){var t=!0,n=now();if(e||n>this._mEndTime)this._mDomWindow.clearInterval(this._mTimerId),this._mEndTime=0,this._mTimerId=null,"function"==typeof this._mOnComplete&&this._mOnComplete.call(this,this._mCompleteTo,e),0<this._mOptList.length&&this._play(this._mOptList.shift()(),!0),t=!1;else{var i=n-this._mStartTime;"function"==typeof this._mOnAction&&this._mOnAction.call(this,this._mTween(i,this._mFrom,this._mOffset,this._mDuration),i/this._mDuration)}return t},_goClass._play=function(e,t){if(!t||e){if(this._setOptions(e),this._mStartTime=now(),this._mEndTime=this._mStartTime+this._mDuration,this._action()){var n=this;this._mTimerId=this._mDomWindow.setInterval(function(){n._action()},13)}}else 0<this._mOptList.length&&this._play(this._mOptList.shift()(),!0)},_goClass._setOptions=function(e,t){if(e){var n=this._mDefOpts,i=t?n:this,o=this.constructor;i._mDomWindow=e.win||n._mDomWindow||window,i._mFrom="number"==typeof e.from?e.from:n._mFrom,i._mTo="number"==typeof e.to?e.to:n._mTo,i._mCompleteTo="number"==typeof e.completeto?e.completeto:i._mTo,i._mOffset=i._mTo-i._mFrom,i._mDuration={fast:200,slow:600}[e.speed]||e.speed||n._mDuration;var a=o._TWEEN[e.tween]||n._mTween||o._TWEEN.Linear;i._mTween="function"==typeof a?a:a[e.easing]||a.easeIn,i._mOnAction=e.onaction||n._mOnAction,i._mOnComplete=e.oncomplete||n._mOnComplete}},_goClass._stop=function(){return!!this._mTimerId&&this._action(!0)},_goStatic.play=function(r,a){var e=(l=(n=this)._CONST)._DEF_RUN_CFG,s=now()+Math.random(),t=extend({},e,a);try{o=(i=r.ownerDocument).defaultView||i.parentWindow,c=o[l._CACHE_ID]}catch(g){return r}try{e=(l=(n=this)._CONST)._DEF_RUN_CFG,s=now()+Math.random(),t=extend({},e,a);var n,l,i,o,c=(o=(i=r.ownerDocument).defaultView||i.parentWindow)[l._CACHE_ID]}catch(v){return callBack.call(r,a.oncomplete,[a.to,!1,!1]),r}function u(e,t){r.setAttribute(l._PLAY_ATT,e+"|"+t)}function d(e){return(r.getAttribute(l._PLAY_ATT)||"").split("|")[0]}function f(e){r.setAttribute(l._WAIT_ATT,e)}function p(){return r.getAttribute(l._WAIT_ATT)||""}function m(e,t){var n,i=c[e],o=i[l._STATIC_PLAY_ID];if(u(e,o.actiontype),"function"==typeof o.onready&&(n=o.onready.call(r,t)),t||0==n){var a=n&&n.to;o.oncomplete("number"==typeof a?a:o.to,t,0==n)}else n&&(n.onaction=n.oncomplete=null),i.play(n||{})}if(c||(c=o[l._CACHE_ID]={}),t.onaction=function(e,t){a.onaction.call(r,e,t)},t.oncomplete=function(e,t,n){u("",a.actiontype),delete c[s],a.oncomplete.call(r,e,t,n);var i=p().split("|"),o=i.shift();o&&(f(i.join("|")),0==i.length?m(o):m(o,t))},t.win=o,(c[s]=new n(t))[l._STATIC_PLAY_ID]=t,d()){var h=p();if(f(h+(h?"|":"")+s),"wait"!=t.type){var _=c[d()];_&&_.stop()}}else m(s);return r},_goStatic.stop=function(e){var t,n,i,o=this._CONST;try{n=((t=e&&e.ownerDocument).defaultView||t.parentWindow)[o._CACHE_ID],(i=(e.getAttribute(o._PLAY_ATT)||"").split("|")[0])&&(e.setAttribute(o._WAIT_ATT,""),n[i].stop())}catch(a){}return e},_goStatic.isPlaying=function(e){return!!e.getAttribute(this._CONST._PLAY_ATT)},_goStatic.getActionType=function(e){return(e.getAttribute(this._CONST._PLAY_ATT)||"").split("|").pop()},_goStatic._expandOrFold=function(e,d,t){var f=gbIsIE?1:0,n=t||{},p=n.speed,m=n.from,h=n.to,_=n.durlimit||0,g=n.basespeed||1.8,v=n.unilimit,b=void 0===p||"uniform"==p,T=!1;function y(){var e=arguments,t=n["on"+e[0]];if("function"==typeof t)return t.call(e[1],e[2])}function M(e){return e.scrollHeight-(gbIsIE?0:parseInt(getStyle(e,"paddingTop"))+parseInt(getStyle(e,"paddingBottom")))}return qmAnimation.play(e,extend({},n,{actiontype:d,speed:b?"fast":p,to:f,onready:function(e){if(!e){var t,n,i,o,a=this.style;if(T=!1,i=(o=y("ready",this)||{}).speed,t="number"==typeof o.from?o.from:m,n="number"==typeof o.to?o.to:h,"expand"==d)if("number"!=typeof t||isNaN(t)){var r=parseInt(a.height);t=isNaN(r)?a.height=f:r}else a.height=t;else("number"!=typeof n||isNaN(n)||n<f)&&(n=f);if(a.overflow="hidden",a.visibility="visible","none"==a.display&&(a.display=""),gbIsIE)this.scrollHeight;if("expand"==d)("number"!=typeof n||isNaN(n))&&(n=M(this),T=!0);else if("number"!=typeof t||isNaN(t)){r=parseInt(a.height);t=isNaN(r)?M(this):r}var s=n-t,l=n;if(0<_&&Math.abs(s)>_&&(0<s?n=t+_:t=n+_),!i)if(b){var c=Math.abs(t-n),u=o.unilimit||v;i=(o.basespeed||g)*(u?Math.min(Math.max(c,u[0]),u[1]):c)}else i=p;return n!=t&&{from:Math.max(t,f),to:Math.max(n,f),completeto:l,speed:i}}},onaction:function(e,t){this.style.height=e+"px",y("action",this,t)},oncomplete:function(e,t,n){t||(e==f&&show(this,!1),this.style.height=T?"auto":e+"px",y("complete",this,e,n))}}))},_goStatic.expand=function(e,t){return this._expandOrFold(e,"expand",t)},_goStatic.fold=function(e,t){return this._expandOrFold(e,"fold",t)},_goStatic.moveVerti=function(e,t,n){var i=gbIsIE?1:0,o=n||{},a=o.speed,r=o.from,s=o.to,l=(o.durlimit,o.basespeed,o.interval||13),c=(o.unilimit,void 0===a||"uniform"==a);function u(){var e=arguments,t=o["on"+e[0]];if("function"==typeof t)return t.call(e[1],e[2])}return qmAnimation.play(e,extend({},o,{actiontype:t,speed:c?"fast":a,to:i,interval:l,onready:function(e){if(!e)return u("ready",this),s!=r&&{from:r,to:s,completeto:s,speed:a}},onaction:function(e,t){this.style.top=e+"px",u("action",this,t)},oncomplete:function(e,t,n){t||(this.style.top=e+"px",u("complete",this,e,n))}}))},_goStatic.moveHor=function(e,t,n){var i=gbIsIE?1:0,o=n||{},a=o.speed,r=o.from,s=o.to,l=(o.durlimit,o.basespeed,o.unilimit,void 0===a||"uniform"==a);function c(){var e=arguments,t=o["on"+e[0]];if("function"==typeof t)return t.call(e[1],e[2])}return qmAnimation.play(e,extend({},o,{actiontype:t,speed:l?"fast":a,to:i,onready:function(e){if(!e)return c("ready",this),s!=r&&{from:r,to:s,completeto:s,speed:a}},onaction:function(e,t){this.style.left=e+"px",c("action",this,t)},oncomplete:function(e,t,n){t||(this.style.left=e+"px",c("complete",this,e,n))}}))},_goStatic._CONST={_CACHE_ID:"QMaNiMatiON_CachE",_STATIC_PLAY_ID:"sTatiC_Play_Conf",_PLAY_ATT:"QMaNiMatiON_PlaY",_WAIT_ATT:"QMaNiMatiON_WaiT",_DEF_RUN_CFG:{from:1,to:100,speed:"fast"}},_goStatic._TWEEN={Linear:function(e,t,n,i){return n*e/i+t},Sine:{easeIn:function(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t},easeOut:function(e,t,n,i){return n*Math.sin(e/i*(Math.PI/2))+t},easeInOut:function(e,t,n,i){return-n/2*(Math.cos(Math.PI*e/i)-1)+t}},Cubic:{easeIn:function(e,t,n,i){return n*(e/=i)*e*e+t},easeOut:function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t},easeInOut:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t}},none:!1};var qmTab=function(e){this._initElements(e),this._setElementsEvent()};_goStatic=qmTab,_goClass=_goStatic.prototype,_goClass.change=function(n){var e=this._mTabInfo,t=this._mState,i=t._curTabId,o=e[n];if(!o||!o._enabled)return!1;if(i==n)return!0;if(i){var a=e[i]._container,r=o._container;if(setClass(e[i]._obj,this._mStyle.normal),this._mAnimation){function s(e){var t=e/100;setOpacity(a,t),setOpacity(r,1-t)}this._mAnimation.stop();var l={display:"",position:"absolute",width:getStyle(a,"width"),height:getStyle(a,"height"),zIndex:1};this._mAnimation.updateStyle("pre",a,l),this._mAnimation.updateStyle("cur",r,(l.zIndex=2)&&l);var c=this._mCallBack._onchangeend;this._mAnimation.play({onaction:function(e,t){s(e)},oncomplete:function(e,t){s(e),this.updateStyle("pre",a),this.updateStyle("cur",r),show(a,!1),show(r,!0),"function"==typeof c&&c(n,i)}})}else show(a,!1),show(r,!0)}else show(o._container,!0);return setClass(o._obj,this._mStyle.select),t._curTabId=n,"function"==typeof this._mCallBack._onchange&&this._mCallBack._onchange(n,i),!0},_goClass.enable=function(e,t){var n=this._mTabInfo[e];return!!n&&(setClass(n._obj,this._mStyle[(n._enabled=!(!t&&void 0!==t))?"normal":"disable"]),!0)},_goClass.getSelectedTabId=function(){return this._mState._curTabId},_goClass._initElements=function(e){var t=this._mTabInfo={};for(var n in e.tab)t[n]={_id:n,_obj:e.tab[n].obj,_container:e.tab[n].container,_enabled:!0};this._mStyle=e.style,this._mCallBack={_onchange:e.onchange,_onchangeend:e.onchangeend},this._mState={_curTabId:null},0!=e.isEnableAnimation&&(this._mAnimation=new qmAnimation({win:e.win,from:100,to:0,speed:400,tween:"Sine",easing:"easeOut"}))},_goClass._setElementsEvent=function(){var n=this,e=this._mTabInfo;for(var i in e)!function(){var t=e[i];show(t._container,!1),addEvent(t._obj,"click",function(){n.change(t._id)}),addEvent(t._obj,"mouseover",function(e){t._enabled&&n._mState._curTabId!=t._id&&setClass(t._obj,n._mStyle.over)}),addEvent(t._obj,"mouseout",function(e){t._enabled&&n._mState._curTabId!=t._id&&!isObjContainTarget(t._obj,e.relatedTarget||e.toElement)&&setClass(t._obj,n._mStyle.normal)})}()};var qmSimpleThumb=function(e){this._initElements(e),this._setElementsEvent()};_goStatic=qmSimpleThumb,_goClass=_goStatic.prototype,_goClass.enable=function(){var e=this._mState;if(1!=e._enabled){if(e._enabled=!0,-1==e._curPage)return this.goPage(1);this._romanceState()}},_goClass.disable=function(){var e=this._mState;0!=e._enabled&&(e._enabled=!1,this._romanceState())},_goClass.getDataLength=function(){return this._mData.length},_goClass.getId=function(){return this._mId},_goClass.getSelectedData=function(){var e=this._mState._curSelIdx;return e<0?null:this._mData[e]},_goClass.goPage=function(e){var t=this._mState,n=t._curPage;return!!(t._enabled&&1<=e&&e<=t._totalPage)&&(t._curPage=e,this._romanceState(),this._romanceCurPage()&&this._romanceSelectState(),this._scrollToPage(),callBack.call(this,this._mCallBack._onchangepage,[e,n]),!0)},_goClass.select=function(e){var t=this._mData,n=this._mState;if((e=parseInt(e))<0);else if(isNaN(e)||(e%=t.length)==n._curSelIdx)return this._mCallBack._onselect.call(this,e,n._preSelIdx),!1;return n._preSelIdx=n._curSelIdx,n._curSelIdx=e,this._romanceSelectState(),"function"==typeof this._mCallBack._onselect&&this._mCallBack._onselect.call(this,e,n._preSelIdx),!0},_goClass.onmouseover=function(e){return"function"==typeof this._mCallBack._onmouseover&&this._mCallBack._onmouseover.call(this,e),!0},_goClass.onmouseout=function(e){return"function"==typeof this._mCallBack._onmouseout&&this._mCallBack._onmouseout.call(this,e),!0},_goClass.setExternInfo=function(e,t){var n=parseInt(e),i=this._mData,o=this._mConfig._numperpage,a=i.length-1;if(!isNaN(n)&&0<=n&&n<=a){var r=Math.floor((a-n)/o),s=a-n-r*o,l=this._mDom._pageContainers[r].firstChild.childNodes;if(s<0||s>=l.length)return;l[s].lastChild.innerHTML=t}},_goClass.update=function(e){this._updateData(e),this._romanceContainer(),this.goPage(this._mState._curPage=Math.min(this._mState._curPage,this._mState._totalPage))},_goClass._getContainerCode=function(){for(var e=[],t=qmSimpleThumb._TEMPLATE._CONTAINER,n=this._mState,i=this._mStyle.thumb.container,o=0,a=Math.max(n._totalPage,1);o<a;o++)e.push(t.replace({border:i}));return qmSimpleThumb._TEMPLATE._FRAME.replace({container:e.join("")})},_goClass._getMsgCode=function(e,t){return qmSimpleThumb._TEMPLATE._MSG.replace({images_path:getPath("image"),msg:e,dispload:t?"":"none"})},_goClass._getThumbCode=function(e){var t=this._mData,n=t.length;if(0==n)return this._getMsgCode("\u6682\u65e0\u6570\u636e");var i=this._mConfig._numperpage,o=e*i,a=o-i,r=o-1;if(t[a].indexOf){if(0==t[a].indexOf("loading"))return this._getMsgCode(t[a].substr(7)||"\u6570\u636e\u52a0\u8f7d\u4e2d...",!0);if(0==t[a].indexOf("custom"))return this._getMsgCode(t[a].substr(6))}var s=[],l=qmSimpleThumb._TEMPLATE._THUMB,c=this._mStyle.thumb,u={img:c.img,normal:c.normal,over:c.over,images_path:this._mConfig._imgpath};0==t[a].thumb.indexOf("http")&&(u.images_path="");for(var d=a,f=Math.min(n--,1+r);d<f;d++){var p=n-d;u.value=p,u.url=t[p].thumb,s.push(l.replace(u))}return s.join("")},_goClass._initElements=function(e){this._mId=e.id||T("qmSimpleThumb_$date$").replace({date:now()}),this._mConfig={_imgpath:e.imgpath,_numperpage:e.numperpage||8},this._mDom=e.dom,this._mStyle=e.style,this._mCallBack={_onchangepage:e.onchangepage,_onselect:e.onselect,_onmouseover:e.onmouseover,_onmouseout:e.onmouseout},this._mState={_curPage:-1,_totalPage:0,_curSelIdx:-1,_preSelIdx:-1,_enabled:null};var n=this._mDom.container;this._mAnimation=new qmAnimation({win:e.win,speed:"slow",tween:"Cubic",easing:"easeOut",onaction:function(e){n.scrollLeft=e},oncomplete:function(e,t){t||(n.scrollLeft=e)}}),this.update(e.data),this[e.enabled?"enable":"disable"]()},_goClass._romanceContainer=function(){var e=this._mDom.container;e.innerHTML=this._getContainerCode(),this._mDom._pageContainers=GelTags("td",e)},_goClass._romanceState=function(){var e=this._mDom,t=this._mState,n=this._mStyle.btn,i=t._enabled,o=t._curPage,a=t._totalPage;e.pagetxt&&i&&(e.pagetxt.innerHTML=qmSimpleThumb._TEMPLATE._TEXT.replace({page:o,total:a})),e.prevbtn&&setClass(e.prevbtn,i&&1!=o?n.normal:n.disable),e.nextbtn&&setClass(e.nextbtn,i&&o!=a?n.normal:n.disable)},_goClass._romanceCurPage=function(){var e=this._mState._curPage;if(0<e){var t=this._mDom._pageContainers[e-1].firstChild;if(!t.innerHTML)return t.innerHTML=this._getThumbCode(e),!0}return!1},_goClass._romanceSelectState=function(){var r=this._mStyle.thumb,e=this._mState,s=this._mData.length-1,l=this._mConfig._numperpage,c=this._mDom._pageContainers;function t(e,t){if(!(e<0||s<e)){var n=Math.floor((s-e)/l),i=s-e-n*l,o=c[n].firstChild.childNodes;if(!(i<0||i>=o.length)){var a=o[i];a.setAttribute("select",t&&r.select&&r.select!=r.over&&r.select!=r.normal?"true":"false"),setClass(a,t?r.select:r.normal)}}}t(e._curSelIdx,!0),t(e._preSelIdx,!1)},_goClass._setElementsEvent=function(){var n=this,e=this._mDom,t=this._mState;addEvent(e.prevbtn,"click",function(e){preventDefault(e),n.goPage(t._curPage-1)}),addEvent(e.nextbtn,"click",function(e){preventDefault(e),n.goPage(t._curPage+1)}),addEvent(e.container,"drag",preventDefault),addEvent(e.container,"click",function(e){preventDefault(e);var t=(e.srcElement||e.target).getAttribute("param");t&&n.select(t)}),addEvent(e.container,"mouseover",function(e){n.onmouseover(e)}),addEvent(e.container,"mouseout",function(e){n.onmouseout(e)})},_goClass._scrollToPage=function(){var e=this._mState._curPage;if(0<e){var t=this._mDom.container,n=this._mDom._pageContainers[e-1];this._mAnimation.stop(),this._mAnimation.play({from:t.scrollLeft,to:n.offsetLeft})}},_goClass._updateData=function(e){this._mData=e,this._mState._totalPage=1+parseInt((this._mData.length-1)/this._mConfig._numperpage)},_goStatic._TEMPLATE={},_goStatic._TEMPLATE._FRAME=T(['<table cellpadding="0" cellspacing="0" border="0">',"<tr>$container$</tr>","</table>"]),_goStatic._TEMPLATE._CONTAINER=T(['<td><div class="$border$"></div></td>']),_goStatic._TEMPLATE._THUMBBORDER=T(['<div class="$border$">$content$</div>']),_goStatic._TEMPLATE._THUMB=T(['<div class="$normal$" un="item" param="$value$"','onmouseover="',"this.getAttribute('select')!='true'&&getTop().setClass(this,'$over$');",'" onmouseout="',"this.getAttribute('select')!='true'&&getTop().setClass(this,'$normal$');",'">','<img class="$img$" src="$images_path$$url$" param="$value$"/>',"</div>"]),_goStatic._TEMPLATE._MSG=T(['<div style="text-align:center;">','<img src="$images_path$ico_loading1.gif" style="display:$dispload$;"/>',"$msg$","</div>"]),_goStatic._TEMPLATE._TEXT=T(["$page$ / $total$"]);var qmGroupThumb=function(e){this._initElements(e)};function qmFlash(e){if(!(this._mId=e.id))throw Error(0,"config.id can't use null");if(!(this._mWin=e.win))throw Error(0,"config.win win is null");this._moConstructor=this.constructor,this._mEvent=e,this._initlize()}function clsXfBatchDownload(){this.constructor=arguments.callee}_goStatic=qmGroupThumb,_goClass=_goStatic.prototype,_goClass.changeGroup=function(e){this._mTab.change(e)},_goClass.enable=function(){if(1==this._mState._enabled)return!1;this._mState._enabled=!0;var e=this._mTab.getSelectedTabId();e&&this._mThumbs[e].enable()},_goClass.disable=function(){if(0==this._mState._enabled)return!1;this._mState._enabled=!1;var e=this._mTab.getSelectedTabId();e&&this._mThumbs[e].disable()},_goClass.getDataLength=function(e){return this._mThumbs[e].getDataLength()},_goClass.getId=function(){return this._mId},_goClass.getSelectedData=function(){var e=this._mState._selectedGroupId;return e?this._mThumbs[e].getSelectedData():null},_goClass.goPage=function(e){var t=this._mThumbs[this._mTab.getSelectedTabId()];t&&t.goPage(e)},_goClass.select=function(e,t){var n=this._mThumbs[t||this._mTab.getSelectedTabId()];return!!n&&n.select(e)},_goClass.update=function(e,t){var n=this._mThumbs[t];n&&n.update(e)},_goClass._initElements=function(e){this._mId=e.id||T("qmSimpleThumb_$date$").replace({date:now()}),this._mCallBack={_onselect:e.onselect,_onchange:e.onchange},this._mState={_selectedGroupId:null,_selectedThumbIdx:-1,_enabled:null};var n=this,t=this._mThumbs={},i={},o=e.group;for(var a in o){var r=o[a];i[a]=r.dom,t[a]=new qmSimpleThumb({id:a,win:e.win,imgpath:e.imgpath,numperPage:e.numperpage||8,enabled:!1,dom:{container:r.dom.container,prevbtn:e.dom.prevbtn,nextbtn:e.dom.nextbtn,pagetxt:e.dom.pagetxt},style:{thumb:e.style.thumb,btn:e.style.btn},data:r.data,onselect:function(e,t){n._onThumbSelect(this,e,t)}})}this._mTab=new qmTab({win:e.win,tab:i,style:e.style.group,onchange:function(e,t){n._onGroupChange(e,t)}}),this._mTab.change(e.defgroupid||a),this[0==e.enabled?"disable":"enable"]()},_goClass._onGroupChange=function(e,t){var n=this;n._mState._enabled&&(callBack.call(n,n._mCallBack._onchange,[e,t]),t&&n._mThumbs[t].disable(),n._mThumbs[e].enable())},_goClass._onThumbSelect=function(e,t,n){var i=this._mState,o=i._selectedGroupId,a=i._selectedThumbIdx;if(-1!=t){i._selectedGroupId=e.getId(),i._selectedThumbIdx=t;var r=this._mThumbs[o];-1!=t&&o!=e.getId()&&r&&r.select(-1)}else o==e.getId()&&(i._selectedThumbIdx=-1);o==i._selectedGroupId&&a==i._selectedThumbIdx||"function"!=typeof this._mCallBack._onselect||this._mCallBack._onselect.call(this,{groupid:i._selectedGroupId,thumbidx:i._selectedThumbIdx},{groupid:o,thumbidx:a})},qmActivex=function(){this._mId="qmActiveX_"+(new Date).valueOf(),this._mActiveXObj={},this._mCurUploadInfo=null},_goStatic=qmActivex,_goClass=_goStatic.prototype,_goClass.screenSnap=function(t){var e=this._getActiveXObj("screensnap");if(!e)return!1;try{e._Type="foxmail.com"==getDomain()?1:0}catch(i){}var n=function(e){return function(){"function"==typeof t&&t(e)}};return e.OnCaptureFinished=n(!0),e.OnCaptureCanceled=n(!1),e.DoCapture(),!0},_goClass.upload=function(e){this.stopUpload();var t=(this._mCurUploadInfo=e).config;if(!t||!t.url)throw{message:"qmActivex:no upload cgi url"};return t.mode=t.mode||"download",t.from=t.from||"",t.scale=t.scale||"",t.widthlimit=t.widthlimit||"",t.heightlimit=t.heightlimit||"",!!this._uploadWithActivex()||this._uploadWithForm()},_goClass.stopUpload=function(){var e=this._mCurUploadInfo;e&&(this._mCurUploadInfo=null,"form"==e._uploadMode?removeSelf(e._targetFrameObj):"activex"==e._uploadMode&&90!=e._percent&&this._getActiveXObj("uploader").StopUpload())},_goClass.hasClipBoardImage=function(){var e=this._getActiveXObj("screensnap");return!!e&&e.IsClipBoardImage},_goClass.checkImageType=function(e,t){for(var n=e.toLowerCase(),i="gif|jpg|jpeg|bmp|png".split("|"),o=i.length-1;0<=o&&-1==n.indexOf(i[o]);o--);if(-1!=o)return!0;var a=T("\u53ea\u5141\u8bb8\u4e0a\u4f20 <b>#type#</b> \u683c\u5f0f\u7684\u56fe\u7247","#").replace({type:i});return"showerr"==t&&showError(a),"returnerr"==t&&a},_goClass._getActiveXObj=function(e){var t={screensnap:0,uploader:2}[e];return detectActiveX(t,1)?(this._mActiveXObj[e]||(this._mActiveXObj[e]=createActiveX(t)),this._mActiveXObj[e]):null},_goClass._getScreenSnapImg=function(){var e=this._getActiveXObj("screensnap");return e&&e.IsClipBoardImage?e.SaveClipBoardBmpToFile(1):null},_goClass._uploadWithActivex=function(){var e=this._getActiveXObj("uploader");if(!e)return!1;var t=this._mCurUploadInfo;if(t.fileCtrl&&(6<getTop().gnIEVer||!getTop().gbIsIE))return!1;if(t.screenImg=this._getScreenSnapImg(),!t.fileCtrl&&!t.screenImg)return t.config.url="",!1;t._uploadMode="activex",t._percent=0,t.onupload.call(this,"start"),e.StopUpload(),e.ClearHeaders(),e.ClearFormItems();var n=t.config;0!=n.url.indexOf("http")?e.URL=[location.protocol,"//",location.host,n.url].join(""):e.URL=n.url;var a=this;return e.OnEvent=function(e,t,n,i,o){a._doActivexUploaderEvent(e,t,n,i,o)},e.AddHeader("Cookie",document.cookie),e.AddFormItem("sid",0,0,getSid()),e.AddFormItem("mode",0,0,n.mode),e.AddFormItem("from",0,0,t.fileCtrl?n.from:"snapscreen"),e.AddFormItem("scale",0,0,n.scale),e.AddFormItem("widthlimit",0,0,n.widthlimit||0),e.AddFormItem("heightlimit",0,0,n.heightlimit||0),t.fileCtrl?e.AddFormItemObject(t.fileCtrl):e.AddFormItem("UploadFile",1,4,t.screenImg),e.StartUpload(),!0},_goClass._uploadWithForm=function(){var n=this._mCurUploadInfo;if(!n.fileCtrl)return!1;for(var i=n.fileCtrl.parentNode;i&&"FORM"!=i.tagName&&"BODY"!=i.tagName;)i=i.parentNode;if(!i||"FORM"!=i.tagName)return!1;n._uploadMode="form",n.onupload.call(this,"start");var o=n.window||window,a=this._mId;o[a+"Instance"]=this,o.qmActiveXDoUploadFinish=function(e){var t=o[e.id+"Instance"];t&&t._doFormUploaderEvent()},n._targetFrameObj&&_removeSelf(n._targetFrameObj),createBlankIframe(o,{id:a,onload:function s(e){if(!r){n._targetFrameObj=this;var t=n.config||{};return i.action=t.url||["/cgi-bin/upload?sid=",getTop.getSid()].join(""),i.target=a,i.sid.value=getSid(),i.mode.value=t.mode||"download",i.scale.value=t.scale||"",i.widthlimit.value=t.widthlimit||"",i.heightlimit.value=t.heightlimit||"",i.submit(),r=!0}e.qmActiveXDoUploadFinish(this)}});var r=!1},_goClass._doFormUploaderEvent=function(){var e=this._mCurUploadInfo;if(!e)return debug("_doFormUploaderEvent: upload info not exist",null,61882714);if(e._targetFrameObj)try{var t=e._targetFrameObj.contentWindow.document;if(t.body.className==e._targetFrameObj.id)return;for(var n=[],i=GelTags("script",t),o=0;o<i.length;o++)n.push(i[o].innerHTML);this._processResponse(n.join(""))}catch(a){debug(a.message,61882714),this._uploadFinish(!1)}},_goClass._doActivexUploaderEvent=function(e,t,n,i,o){var a=this._mCurUploadInfo;if(!a)return debug("_doActivexUploaderEvent: upload info not exist",null,61882714);switch(t){case 1:return this._uploadFinish(!1,{errCode:n});case 2:return a._percent=parseInt(90*n/i),a.onupload.call(this,"uploading",{percent:a._percent});case 3:var r=this._getActiveXObj("uploader");if("200"!=r.ResponseCode)return this._uploadFinish(!1,{errCode:n});this._processResponse(r.Response)}},_goClass._processResponse=function(e){var t=e||"",n=t.indexOf('On_upload("'),i=t.indexOf('");',n),o=-1!=n&&-1!=i?t.substring(n+11,i):"err";if("err"!=o)return this._uploadFinish(!0,{imgParam:o.replace(new RegExp('"',"ig"),"").split(",")});n=t.indexOf('On_upload_Fail("'),i=t.indexOf('");',n);var a=function(e){return e=parseInt(e),isNaN(e)?"5":parseInt(100*parseInt(e)/1048576)/100};return-1!=n&&-1!=i?(o=t.substring(n+16,i).replace(new RegExp('"',"ig"),"").split(","),this._uploadFinish(!1,{curSize:a(o[0]),allowSize:a(o[1])})):this._uploadFinish(!1)},_goClass._uploadFinish=function(e,t){if(this._mCurUploadInfo){try{this._mCurUploadInfo.onupload.call(this,e?"ok":"fail",t)}catch(n){doPageError(n.message,this._mCurUploadInfo.window.location.href,"_uploadFinish callback")}this.stopUpload()}},_goStatic=qmFlash,_goClass=_goStatic.prototype,_goStatic.get=function(e,t){var n=t[this._CONST._CACHES];return n&&n[e]},_goStatic.getFlashVer=function(){var e="",t=-1,n=-1,i=-1,o=navigator.plugins;if(o&&o.length)for(var a=0,r=o.length;a<r;a++){var s=o[a];if(-1!=s.name.indexOf("Shockwave Flash")){e=s.description.split("Shockwave Flash ")[1],t=parseFloat(e),i=parseInt(e.split("r")[1]),n=parseInt(e.split("b")[1]);break}}else try{var l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(l){var c=(e=l.GetVariable("$version").split(" ")[1]).split(",");t=parseFloat(c.join(".")),i=parseInt(c[2]),n=parseInt(c[3])}}catch(u){}return{version:(isNaN(t)?-1:t)||-1,build:(isNaN(i)?-1:i)||-1,beta:(isNaN(n)?-1:n)||-1,desc:e}},_goStatic.isSupported=function(){var e=this.getFlashVer();return 10<=e.version||9==e.version&&50<e.build},_goStatic._CONST={_TIMEOUT:5e3,_CACHES:"qmFlashCaches_ASDr431gGas",_CALLBACK:"onFlashEvent_ASDr431gGas"},_goClass.getFlash=function(){return getFlash(this._mId,this._mWin)},_goClass.isDisabled=function(){return this._mDisabled||!1},_goClass.disable=function(e){return this._mDisabled=0!=e,this},_goClass.getLoadedPercent=function(n){var i=this;function o(e){try{n.call(i,e)}catch(t){}}var a=this.getFlash();if(!a)return o("notfound");var r=0;!function(){var e=arguments.callee;e._startTime||(e._startTime=getTop().now());var t=0,n=!1;try{t=a.PercentLoaded()}catch(i){n=!0}t!=r&&o(r=t),100!=t&&(getTop().now()-e._startTime>qmFlash._CONST._TIMEOUT?o(n?"noflash":"timeout"):setTimeout(e,100))}()},_goClass.setup=function(i){var o=this;function t(e,t){try{i.call(o,e,t)}catch(n){}}this.getLoadedPercent(function(e){100==e?setTimeout(function(){try{if(!o.getFlash().setup(qmFlash._CONST._CALLBACK,o._mId))return t(!1,"setuperr")}catch(e){return t(!1,"nosetup")}t(!0)}):"number"!=typeof e&&t(!1,e)})},_goClass._initlize=function(){var r=this._mWin,e=this._moConstructor._CONST,s=e._CACHES,t=e._CALLBACK;r[s]||(r[s]=new r.Object),r[s][this._mId]=this,r[t]||(r[t]=function(){var e=arguments[0],t=arguments[1],n=r[s][e];if(n&&"function"==typeof n._mEvent[t]){for(var i=[],o=2,a=arguments.length;o<a;o++)i.push(arguments[o]);n._mEvent[t].apply(n,i)}})},clsXfBatchDownload.prototype={init:function(){if(!this._checkXfInstall())return!1;var e=new Date;return setCookie("qm_ftn_key","",e,"/","qq.com"),!0},DoXfBatchDownload:function(t){var n=this;waitFor(function(){return"undefined"!=typeof BatchTask},function(e){e?n._doXfBatchDownload(t):showError("\u8c03\u7528\u65cb\u98ce\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5\u3002")})},makeGetUrlArray:function(){return 0},_checkXfInstall:function(){try{new ActiveXObject("QQIEHelper.QQRightClick.2");return 0,loadJsFile(getPath("js")+"lib/xunfeng/"+getFullResSuffix("xflib_xw.js"),!0),!0}catch(e){return confirm("\u4f60\u8fd8\u6ca1\u6709\u5b89\u88c5\u6700\u65b0\u7248\u7684QQ\u65cb\u98ce\uff0c\u5982\u679c\u5df2\u7ecf\u5b89\u88c5\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u88ab\u7981\u7528\u3002\n\u73b0\u5728\u53bb\u4e0b\u8f7d\u5b89\u88c5\u4e48\uff1f\u5b89\u88c5\u5b8c\u540e\u8bf7\u5237\u65b0\u672c\u9875\u9762\u3002")&&window.open("http://xf.qq.com/xf2/index.html"),!1}},_doXfBatchDownload:function(e){var t=e||this.makeGetUrlArray();if(!(t.length<=0)){var n=Math.min(50,t.length),o=new QMAjax,a={},r=this;showProcess(1,!0,"\u6b63\u5728\u83b7\u53d6\u4e0b\u8f7d\u94fe\u63a5..."),function s(i){if(n<=i)return r._completeHandle(a,n);QMAjax.send([t[i],"&nm=",i,"&rn=",Math.random()].join(""),{method:"GET",onload:function(e,t){var n="name"+i;e&&0<t.indexOf(n)&&(a[n]=t.split('"')[1]),s(i+1)}},o)}(0)}},_errorHandle:function(){showError("\u94fe\u63a5\u83b7\u53d6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")},_completeHandle:function(e,t){for(var n=0,i=[],o=0;o<t;o++)if("undefined"!=typeof e["name"+o]){var a=e["name"+o].split("|");if("error"!=a[0]&&0==a[0].indexOf("http://")){i.push(a[0].replace(/#/g,"_"));var r=a[1],s=new Date(now()+36e5),l=getCookie("qm_ftn_key");setCookie("qm_ftn_key",[l,r].join(","),s,"/","qq.com"),n++}}n==t?showProcess(0):showError(t-n+"\u4e2a\u6587\u4ef6\u94fe\u63a5\u83b7\u53d6\u5931\u8d25"),0<n&&this._invokeXf(i)},_invokeXf:function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n]),t.push("http://mail.qq.com/"),t.push("\u6587\u4ef6\u4e2d\u8f6c\u7ad9");BatchTask(t.length,t)}};var QMSender=function(e){this._moWin=e.oWin,this._moItems=[],this._mbIsAutoWidth=!1,this._mfOnclickItemCallBack=null,this._iniSender(e)};_goStatic=QMSender,_goClass=_goStatic.prototype,_goClass._iniSender=function(s){var e=S("Senderdiv",this._moWin);if(e){try{var u=getDefalutAllMail()}catch(x){var t=arguments.callee;return setTimeout(function(){t.apply(this._moWin,arguments)},500)}if(u.length){var a=s.nCurFolderId,r=s.sCurSaveFrom,n=s.bShowNode,i="undefined"==typeof s.sTitle?"\u53ef\u9009\u62e9\u90ae\u7bb1\u522b\u540d\u6216POP\u6587\u4ef6\u5939\u7684\u90ae\u4ef6\u5730\u5740&#10;\u4f5c\u4e3a\u53d1\u4fe1\u5e10\u53f7\u3002":s.sTitle,o="undefined"==typeof s.sDesContent?"\u53d1\u4ef6\u4eba\uff1a":s.sDesContent;this._mfOnclickItemCallBack=function(t){if(S("sendmailname_val",this._moWin)){var e="",n=GelTags("span",S("sendmailname_val",this._moWin))[0],i=GelTags("b",S("sendmailname_val",this._moWin))[0],o=n.getAttribute("nickname"),a=o?o.split("|"):[];if(a[0]==t.email&&(e=a[1]),n.innerHTML=this._TEMPLATE._EMAIL_DISP.replace(t),i.innerHTML=htmlEncode(e)||t.nick.replace(/(^\"|\"$)/g,""),S("sendname",this._moWin).value=htmlDecode(i.innerHTML),this._setSender(t),t.sms){loadJsFileToTop(getPath("js"),[getFullResSuffix("qmtip.js")]);var r=this._moWin;waitFor(function(){return QMTip},function(e){e&&S("sendmailname",r).value==t.email&&QMTip.show({tipid:10001,domid:"sendmailname_val",win:r,msg:['<span class="black">\u5c06\u4f7f\u7528\u624b\u673a\u53f7\u90ae\u7bb1\u53d1\u4fe1\uff0c\u8fd9\u6837\u5bf9\u65b9\u56de<br/>\u4fe1\u60a8\u5c31\u4f1a\u83b7\u5f97\u77ed\u4fe1\u63d0\u9192\u3002<a onclick="window.open(\'http://service.exmail.qq.com/cgi-bin/help?subtype=1&&id=8&&no=1000605\')">\u8be6\u60c5</a></span>'].join(""),arrow_direction:"down",arrow_offset:25,height_offset:4,tip_offset:-110,width:305,auto_hide:1,notlog:!0,bForceShow:!0})})}callBack.call(this,s.onclickItemCallBack,[t])}};var l,c,d="undefined"==typeof s.sAlignType?"left":d,f=s.sVerAlign||"bottom",p=parseInt(s.sWidth)||300;this._mbIsAutoWidth=p<0,this._mbIsAutoWidth?p=(l=getStrDispLen(s.sCurSaveFrom)+60)+(gbIsIE,50):l=p-(gbIsIE,40),c=l-25;for(var m=Math.floor(23*p/300),h=Math.floor(20*p/300),_=[],g=[],v=null,b=this._CONST,T=this._TEMPLATE._EMAIL,y=this._TEMPLATE._EMAIL_DISP,M=this._TEMPLATE._DOMAIN,w=this._TEMPLATE._BASE,E=this._moItems=[],C=this,I=0;I<u.length;I++)!function(){var e=u[I],t=e.email,n=t.split("@").pop(),i=b.hasOwnProperty(n),o={nick:e.nickname&&'"'+e.nickname+'"',email:t,phone:e.phone,emaildisp:this._mbIsAutoWidth?t:subAsiiStr(t,i?h:m,"..."),signid:e.signid,domain:M.replace({images_path:getPath("image"),margin_top:1==e.phone?416:i?b[n]:321}),sms:1==e.phone&&0<e.smsleft};E.push(o),_.push(extend({smtp:(e.smtp,"")},o)),g.push(function(e){C._mfOnclickItemCallBack(o)}),a||r||getDefaultSender()!=t?(r&&r.toLowerCase()==e.email||!r&&a&&a==e.folderid||null==v)&&(v=o):v=o}();var F="";u&&0<u.length&&u[0]&&u[0].nickname?F=v.nick||u[0].nickname:S("useralias")&&S("useralias").innerHTML&&(F=S("useralias").innerHTML),e.innerHTML=w.replace({title:i,desContent:o,email_width:c,sel_width:l,width:p,images_path:getPath("image"),nick:F,email:y.replace(v)});var A=0;S("sendmailname_val",this._moWin).onclick=function(){if(!A){for(var e=0;e<u.length;e++){var t=getStrDispLen(u[e].email+(u[e].smtp,""));A<t&&(A=t)}A=Math.max(this.clientWidth,A+42)}var n=calcPos(this),i=[],o=GelTags("span",this)[0];for(e=0;e<_.length;e++)i.push({sId:e,sItemValue:T.replace(extend({selected:o.innerHTML==_[e].email},_[e]))});var a=this.getElementsByTagName("span")[0],r="",s=a&&a.innerHTML||"";for(e=0;e<u.length;e++)if(u[e].email==s){r=u[e].nickname;var l=a.getAttribute("nickname"),c=l?l.split("|"):[];c[0]==s&&(r=c[1]);break}i.push({sId:"border",nHeight:5,sItemValue:['<div style="border-top:1px solid;margin-top:2px;padding-top:2px;font-size:0;line-height:0;height:0;"></div>'].join(""),bDisSelect:!0}),i.push({sId:"send__nickname",nHeight:25,sItemValue:['<div style="padding-left:15px;overflow:hidden">','<span id="snn_getAlias" style="line-height:25px;">','<font style="color:#000">\u53d1\u4fe1\u6635\u79f0\uff1a</font>','<span title="',r,'">',subAsiiStr(r,16,"...",!0),"</span>","</span>","</div>"].join(""),bDisSelect:!0}),new(getTop().QMMenu)({oEmbedWin:C._moWin,sId:"sendermenu",nX:"left"==d?n[3]:n[3]-(A-this.clientWidth),nY:"bottom"==f?n[2]:n[2]-21*i.length-35,nMinWidth:230,bAnimation:!1,nItemHeight:21,oItems:i,onitemclick:function(e){g[e]()}})},S("sendmailname",this._moWin)&&(S("sendmailname",this._moWin).value=v.email),show(n?e[n]:e,!0),1<_.length&&getTop().requestShowTip("sendmailname_val",17,this._moWin)}}},_goStatic.setAlias=function(){var e=getTop().getMainWin(),t=S("sendermenu_QMMenu",e)?"sendermenu_QMMenu_":"sendermenu__",n=GelTags("input",S(t+"snn_setAlias",e))[0],i=GelTags("span",S(t+"snn_getAlias",e))[0],o=GelTags("span",S("sendmailname_val",e))[0],a=GelTags("b",S("sendmailname_val",e))[0],r=n.value;S("sendname",e).value=r||" ",o.setAttribute("nickname",[o.innerHTML,r].join("|")),a.innerHTML=htmlEncode(r),i.innerHTML=htmlEncode(r),S("useraddr").innerHTML==o.innerHTML&&(S("useralias").innerHTML=htmlEncode(r)),show(S(t+"snn_setAlias",e),!1),show(S(t+"snn_getAlias",e),!0)},_goStatic.initAlias=function(e){var t=getTop().getMainWin(),n=S("sendermenu_QMMenu",t)?"sendermenu_QMMenu_":"sendermenu__",i=GelTags("span",S(n+"snn_getAlias",t))[0],o=GelTags("input",S(n+"snn_setAlias",t))[0];o.value=htmlDecode(i.innerHTML),show(S(n+"snn_setAlias",t),!0),show(S(n+"snn_getAlias",t),!1),setTimeout(function(){o.select()})},_goClass._setSender=function(e){var t=this._moWin;S("sendmailname",t).value=e.email,t.setSignature&&t.setSignature("sign",-2==e.signid?getUserSignatureId():e.signid)},_goClass.setSenderSelected=function(e){for(var t=this._moItems,n=t.length-1;0<=n;n--)if(t[n].email==e)return void this._mfOnclickItemCallBack(t[n])},_goClass._CONST={"hotmail.com":0,"live.com":0,"live.cn":0,"msn.com":0,"msn.cn":0,"yahoo.com.cn":30,"yahoo.cn":30,"yahoo.com":30,"ymail.com":30,"rocketmail.com":30,"gmail.com":61,"vipgmail.com":61,"sina.com":95,"sina.com.cn":95,"vip.sina.com":95,"my3ia.sina.com":95,"sina.cn":95,"163.com":383,"vip.163.com":383,"126.com":352,"vip.126.com":352,"yeah.net":223,"foxmail.com":159,"sohu.com":193,"vip.sohu.com":193,"vip.qq.com":288,"qq.com":288,"21cn.com":256,"21cn.net":256},_goClass._TEMPLATE={_BASE:T(['<div title="$title$" style="float:left; margin-left:-3px;" class="textoftitle">&nbsp;$desContent$</div>','<div id="sendmailname_val" unselectable="on" onmousedown="return false" ','style="cursor:pointer; padding:0 0 0 3px;  float:left;">','<b>$nick$</b> &lt;<span id="sendmailemail_val">$email$</span>&gt;<span class="addrtitle" style="font-family: arial,sans-serif; padding-left:4px; font-size:9px; position:relative; top:-1px;" >\u25bc</span>',"</div>"]),_EMAIL:TE(['<div class="composeAccount" style="">','<input type="button" class="ft_upload_success" style="$@$if(!$selected$)$@$visibility:hidden;$@$endif$@$">$email$$smtp$',"</div>"]),_EMAIL_DISP:T(["$email$"]),_DOMAIN:T(['<img src="$images_path$spacer.gif" style="background-position:0 -$margin_top$px;" valign="absmiddle" >'])};var QMTimeLang={_moBaseDateValue:new Date(1970,0,5,0,0,0,0)};_goStatic=QMTimeLang,_goStatic.formatRefer=function(e,t){return T("$date$$time$").replace({date:this.formatDate(e,t),time:this.formatTime(e)})},_goStatic.formatDate=function(e,t){var n=e,i=t||new Date,o=n-this._moBaseDateValue,a=i-this._moBaseDateValue,r=Math.floor(o/864e5)-Math.floor(a/864e5);if(Math.abs(r)<3)return T("$day$").replace({day:["\u524d\u5929","\u6628\u5929","\u4eca\u5929","\u660e\u5929","\u540e\u5929"][2+r]});var s=Math.floor(o/6048e5)-Math.floor(a/6048e5);return Math.abs(s)<2?T("$weekpos$\u5468$weekday$").replace({weekpos:["\u4e0a","\u672c","\u4e0b"][1+s],weekday:this.formatWeek(n)}):T([n.getYear()==i.getYear()?"":"$YY$\u5e74","$MM$\u6708$DD$\u65e5"]).replace({YY:n.getFullYear(),MM:n.getMonth()+1,DD:n.getDate()})},_goStatic.formatTime=function(e){var t,n=e.getHours(),i=e.getMinutes();return t=n<6?"\u51cc\u6668":n<9?"\u65e9\u4e0a":n<12?"\u4e0a\u5348":n<13?"\u4e2d\u5348":n<18?"\u4e0b\u5348":n<22?"\u665a\u4e0a":"\u6df1\u591c",T("$desc$$hour$:$min$").replace({desc:t,hour:12==n?n:n%12,min:this._format(i)})},_goStatic.formatWeek=function(e){return["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][e.getDay()]},_goStatic._format=function(e){return e<10?"0"+e:e};var QMDragDrop={groups:{},setGroup:function(e,t){if(!this._getGroupById(e)){this.groups[e]=t;for(var n=0;n<t.length;n++)t[n].setGroupId(e)}return this},addGroup:function(e,t){var n;return(n=this._getGroupById(e))||(n=[],this.setGroup(e,n)),n.push(t),t.setGroupId(e),this},delGroup:function(e){return this._getGroupById(e)&&(delete this.groups[e]||debug("error delete dragdrop group:"+e)),this},getDragFromGroup:function(e){var t,n=[];return(t=this._getGroupById(e))&&t[i]instanceof QMDragDrop.Draggable&&n.push(t[i]),n},getDropFromGroup:function(e){var t,n=[];if(t=this._getGroupById(e))for(var i=0;t&&i<t.length;i++)t[i]instanceof QMDragDrop.DropTarget&&n.push(t[i]);return n},_getGroupById:function(e){for(var t in this.groups)if(t==e)return this.groups[t]}};_goStatic=QMDragDrop,_goStatic.Draggable=function(e,t,n){this._moElement=null,this._moTargets=[],this._moOptions={},this._moCallBacks={},this._mnDiffX=0,this._mnDiffY=0,this._mnState=2,this._init(e,t,n)},_goStatic.Draggable.STATE={_DRAGSTART:0,_DRAG:1,_DRAGEND:2},_goStatic.Draggable.prototype={setGroupId:function(e){return this._msId=e,this},addDropTarget:function(e){return e&&this._moTargets.push(e),this},moveTo:function(t,n,e,i){var o=this,a=o._moElement,r=a.offsetLeft,s=a.offsetTop;qmAnimation.play(a,{from:0,to:1,speed:.5*Math.max(Math.abs(t-r),Math.abs(n-s))||10,onaction:function(e){e=e||0,this.style.left=r+(t-r)*e,this.style.top=s+(n-s)*e},oncomplete:function(){this.style.left=t,this.style.top=n,e&&e.call(o,i)}})},exchangePos:function(e){e&&this._moPlaceHolderDom&&(e.parentNode.insertBefore(this._moElement,e),this._moPlaceHolderDom.parentNode.insertBefore(e,this._moPlaceHolderDom),this._moElement.parentNode.insertBefore(this._moPlaceHolderDom,this._moElement))},getElement:function(){return this._moElement},getPlaceHolder:function(){return this._moPlaceHolderDom},lock:function(e){this._moOptions.lockx=!!e,this._moOptions.locky=!!e},_init:function(e,t,n){e&&(this._moElement=e,this._moDocument=e.ownerDocument,this._moWindow=this._moDocument.parentWindow||this._moDocument.defaultView,this._msPosStyle=getStyle(e,"position"),this._setOptions(t)._setEvents(n))},_setOptions:function(e){var t=this,n=t._moOptions;if(n.handle=e.handle||t._moElement,n.maxContainer=e.maxcontainer,n.lockx=!!e.lockx,n.locky=!!e.locky,n.transparent=!!e.transparent,n.placeholder=!!e.placeholder,n.threshold=e.threshold||5,n.holderhtml=e.holderhtml,n.oTitle=e.oTitle,n.transparent){var i=calcPos(t._moElement);insertHTML(t._moElement,"afterBegin",'<div style="display:none;background:#FFF;position:absolute;opacity:0.5;filter:alpha(opacity=50);width:100%;height:100%;z-index:999;cursor:move;"></div>'),t._moMaskDom=t._moElement.firstChild,t._moMaskDom.style.height=i[5]+"px"}return t},_setEvents:function(e){var i=this;return i._moCallBacks={ondragstart:function(){},ondrag:function(){},ondragend:function(){}},extend(i._moCallBacks,e),addEvent(i._moOptions.handle,"mousedown",function o(e){var t=getEventTarget(e).tagName;if((gbIsIE||!t||"input"!=t.toLowerCase())&&(!i._moOptions.lockx||!i._moOptions.locky)){if(i._mnDiffX=e.clientX-i._moElement.offsetLeft+(parseInt(getStyle(i._moElement,"marginLeft"))||0)+bodyScroll(i._moWindow,"scrollLeft"),i._mnDiffY=e.clientY-i._moElement.offsetTop+(parseInt(getStyle(i._moElement,"marginTop"))||0)+bodyScroll(i._moWindow,"scrollTop"),i._moOptions.oTitle){var n=gbIsIE?calcPos(i._moWindow.frameElement):[0,0,0,0];i._mnMouseX=n[3]+e.clientX,i._mnMouseY=n[0]+e.clientY}else i._mnMouseX=e.clientX,i._mnMouseY=e.clientY;i._mnState=QMDragDrop.Draggable.STATE._DRAGEND,i._move(e)}}),i},_move:function(e){var l=this,c=l._moOptions,u=QMDragDrop.DataTransfer;if(l._onmousemove&&l._onmouseup||(l._onmousemove=function(e){if(gbIsIE&&c.oTitle||(l._moWindow.getSelection?l._moWindow.getSelection().removeAllRanges():l._moDocument.selection.empty()),l._mnState==QMDragDrop.Draggable.STATE._DRAGEND&&c.threshold){var t=Math.abs(l._mnMouseX-e.clientX),n=Math.abs(l._mnMouseY-e.clientY);(t>c.threshold||n>c.threshold)&&(callBack.call(l,l._moCallBacks.ondragstart,[e]),l._mnState=QMDragDrop.Draggable.STATE._DRAGSTART,l._changeStyle(),c.oTitle||(l._moElement.style.left=l._mnMouseX-l._mnDiffX+bodyScroll(l._moWindow,"scrollLeft"),l._moElement.style.top=l._mnMouseY-l._mnDiffY+bodyScroll(l._moWindow,"scrollTop")))}else{var i=e.clientX-l._mnDiffX+bodyScroll(l._moWindow,"scrollLeft"),o=e.clientY-l._mnDiffY+bodyScroll(l._moWindow,"scrollTop");if(c.oTitle||(c.lockx||(l._moElement.style.left=i+"px"),c.locky||(l._moElement.style.top=o+"px")),c.maxContainer){var a=calcPos(c.maxContainer),r=calcPos(l._moElement);r[1]>a[1]?l._moElement.style.left=i+a[1]-r[1]+"px":r[3]<a[3]&&(l._moElement.style.left=i+a[3]-r[3]+"px"),r[2]>a[2]?l._moElement.style.top=o+a[2]-r[2]+"px":r[0]<a[0]&&(l._moElement.style.top=o+a[0]-r[0]+"px")}l._mnState=QMDragDrop.Draggable.STATE._DRAG,callBack.call(l,l._moCallBacks.ondrag,[e]);var s=new u(u.TYPE.DOWN,l,e.clientX,e.clientY,e);l._broadcast(s),preventDefault(e)}},l._onmouseup=function(e){if(l._mnState!=QMDragDrop.Draggable.STATE._DRAGEND){l._stop();var t=new u(u.TYPE.UP,l,e.clientX,e.clientY,e);l._broadcast(t),l._mnState=QMDragDrop.Draggable.STATE._DRAGEND,callBack.call(l,l._moCallBacks.ondragend,[e]),l._changeStyle()}else l._stop()}),gbIsIE&&l._moElement.setCapture){var t=c.oTitle||l._moElement;t.setCapture(!0),addEvents(t,{mousemove:l._onmousemove,mouseup:l._onmouseup,losecapture:l._onmouseup})}else addEvents(l._moDocument,{mousemove:l._onmousemove,mouseup:l._onmouseup}),l._moWindow.captureEvents&&l._moWindow.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP),addEvent(l._moWindow,"blur",l._onmouseup);return l},_stop:function(){var e=this,t=e._moOptions.oTitle||e._moElement;return gbIsIE&&t.releaseCapture?(addEvents(t,{mousemove:e._onmousemove,mouseup:e._onmouseup,losecapture:e._onmouseup},!0),t.releaseCapture()):(addEvents(e._moDocument,{mousemove:e._onmousemove,mouseup:e._onmouseup},!0),e._moWindow.releaseEvents&&e._moWindow.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP),removeEvent(e._moWindow,"blur",e._onmouseup)),e},_setPlaceHolder:function(e){var t=this;if(e){var n=t._moElement.cloneNode(!0),i=calcPos(t._moElement);n.style.position="static",n.style.width=i[4]+"px",n.style.height=i[5]+"px",t._moOptions.holderhtml&&(n.innerHTML=t._moOptions.holderhtml),n.removeAttribute("id"),n.removeAttribute("name"),t._moElement.parentNode.insertBefore(n,t._moElement),t._moPlaceHolderDom=n}else t._moPlaceHolderDom&&(t._moElement.parentNode.removeChild(t._moPlaceHolderDom),t._moPlaceHolderDom=null),t._moElement.style.position=t._msPosStyle},_changeStyle:function(){var e=this,t=e._moOptions,n=e._mnState==QMDragDrop.Draggable.STATE._DRAGEND;if(!t.oTitle){if(e._moElement.style.position="absolute",t.transparent&&show(e._moMaskDom,!n),t.placeholder){var i=e._moPlaceHolderDom,o=i&&i.offsetLeft,a=i&&i.offsetTop;!n&&e._setPlaceHolder(!0),n&&e.moveTo(o,a,e._setPlaceHolder,!1)}return e}},_broadcast:function(e){for(var t=QMDragDrop.getDropFromGroup(this._msId),n=0;n<t.length;n++)this!=t[n]&&t[n].listen(e);return this}},_goStatic.DropTarget=function(e,t,n){this._moElement=null,this._moCallBacks={},this._moDragTarget=null,this._mnState=-1,this._init(e,t,n)},_goStatic.DropTarget.STATE={_DRAGENTER:0,_DRAGOVER:1,_DRAGLEAVE:2,_DROP:3},_goStatic.DropTarget.prototype={setGroupId:function(e){return this._msId=e,this},getDragTarget:function(){return this._moDragTarget},listen:function(e){var t=this,n=QMDragDrop.DropTarget.STATE;t._moDragTarget=e.target;var i=t._moDragTarget.getElement(),o=i.offsetLeft+i.offsetWidth/2,a=i.offsetTop+i.offsetHeight/2;switch(t.isOver(o,a,e)?e.type==QMDragDrop.DataTransfer.TYPE.DOWN?t._mnState=t._mnState==n._DRAGENTER||t._mnState==n._DRAGOVER?n._DRAGOVER:n._DRAGENTER:t._mnState=n._DROP:t._mnState=n._DRAGLEAVE,t._mnState){case n._DRAGENTER:callBack.call(t,t._moCallBacks.ondragenter,[e]);break;case n._DRAGOVER:callBack.call(t,t._moCallBacks.ondragover,[e]);break;case n._DROP:callBack.call(t,t._moCallBacks.ondrop,[e]);break;case n._DRAGLEAVE:callBack.call(t,t._moCallBacks.ondragleave,[e])}},isOver:function(e,t){var n=this._moElement,i=n.offsetLeft,o=i+n.offsetWidth,a=n.offsetTop,r=a+n.offsetHeight;return i<e&&e<o&&a<t&&t<r},_init:function(e,t,n){e&&(this._moElement=e,this._moCallBacks={ondragenter:function(){},ondragover:function(){},ondragleave:function(){},ondrop:function(){}},extend(this._moCallBacks,t),n&&(this.isOver=n))}},_goStatic.DataTransfer=function(e,t,n,i,o){this.type=e,this.target=t,this.x=n,this.y=i,this.event=o},_goStatic.DataTransfer.TYPE={DOWN:1,UP:2};var QMPanel=inheritEx("QMPanel",Object,function(e){return{$_constructor_:function(e){if(e){var t=this.constructor,n=t.get(e.sId);n&&n.destroy(),this._genId(e),t.$_add&&t.$_add(e.sId,this),this._init(e)}},configHelp_:function(e,t,n){for(var i in t)(n||"undefined"==typeof e[i]||null==e[i])&&(e[i]=t[i]);return e},autoAlignCenter_:function(){var e=this._moConfig,t=this._moPanelDom,n=e.oEmbedWin||getTop(),i=n.document.body;if(!e.nX){var o=(i.clientWidth-t.offsetWidth)/2+bodyScroll(n,"scrollLeft");e.nX=o,t.style.left=o+"px"}if(!e.nY){var a=Math.max(2,(i.clientHeight-t.offsetHeight)/2+bodyScroll(n,"scrollTop")-25);e.nY=a,t.style.top=a+"px"}},dfConfig_:function(e){var t=e.oEmbedWin||getTop(),n=t.document.body;this.configHelp_(e,{oEmbedWin:t,oEmbedToDom:n,sEmbedPos:"afterBegin",oCallerWin:window,nZIndex:1100,bDisplay:!0,sBodyHtml:""})},_genId:function(e){return this._msPanelId=[e.sId||(e.sId=["__QmDefPanelId","__"].join(unikey())),this.constructor.name].join("_")},processHtml_:function(e){var t=this._msPanelId;return e.toString().replace(/ (id|for)=[\"\']?(\w+)[\"\']?/gi,[' $1="',t,'_$2"'].join(""))},insertHtml_:function(e){e.sPanelId=this._msPanelId,e.sBodyHtml=this.processHtml_(e.sBodyHtml),insertHTML(e.oEmbedToDom,e.sEmbedPos,QMPanel._TEMPLATE._SKIN.replace(e))},initMemVar_:function(e){this._moConfig=e,this._msStatus="",this._moPanelDom=S(this._msPanelId,e.oEmbedWin)},htmlReady_:function(e){this._msStatus="hide",callBack.call(this,e.onload),this.setEvent_(),e.bDisplay&&this.show()},setEvent_:function(){},panelDomCtrl_:function(e,t){show(this._moPanelDom,e),e&&this.autoAlignCenter_(),callBack.call(this,t)},panelDomDestroy_:function(){removeSelf(this._moPanelDom),this._moPanelDom=null},panelDestroy_:function(){var e=this._moConfig.sId,t=this.constructor;t.get(e)&&(t.$_del(e),this.panelDomDestroy_())},_init:function(e){this.dfConfig_(e),this.insertHtml_(e),this.initMemVar_(e),this.htmlReady_(e)},destroy:function(){this.panelDomCtrl_(!1),this.panelDestroy_()},getConfig:function(){return this._moConfig},option:function(e,t){var n,i=this,o={nWidth:"scrollWidth",nHeight:"scrollHeight"};if(void 0!==t&&(i._moConfig[e]=t,(n={nX:"left",nY:"top",nWidth:"width",nHeight:"height",nZIndex:"zIndex"}[e])&&(i._moPanelDom.style[n]="number"==typeof t&&"zIndex"!=n?t+"px":t)),"status"==e)return i._msStatus;if(t||"auto"!=i._moConfig[e]||!o[e])return t?i:i._moConfig[e];var a,r,s=i._moPanelDom;return isShow(s)?r=s[o[e]]:(a=getStyle(s,"left"),s.style.left="-9999px",r=show(s,!0)[o[e]],show(s,!1).style.left=a),r},S:function(e){var t=this._moConfig.oEmbedWin||getTop();return S([this._msPanelId,e].join("_"),t)},isContain:function(e){return isObjContainTarget(this._moPanelDom,e)},getPanelDom:function(){return this._moPanelDom},show:function(){var t=this;return"showing"!=t._msStatus&&"show"!=t._msStatus&&(t._msStatus="showing",t.panelDomCtrl_(!0,function(){t._msStatus="show",setTimeout(function(){try{callBack.call(t,t._moConfig.onshow)}catch(e){debug("onshow error : "+e.message)}})})),t},hide:function(e){var t=this;return"hiding"!=t._msStatus||"hide"!=t._msStatus?(t._msStatus="hiding",t.panelDomCtrl_(!1,function(){t._msStatus="hide",setTimeout(function(){callBack.call(t,t._moConfig.onhide)}),callBack.call(t,e)})):callBack.call(t,e),t},_isValid:function(){try{var e=this._moPanelDom;if(null==e.parentNode)return!1;if(gbIsIE)return!!e.ownerDocument;var t=e.ownerDocument.defaultView,n=t.frameElement;return n?n.contentDocument==e.ownerDocument:t==getTop()}catch(i){return!1}},close:function(e){if("close"!=this._msStatus){var t=this;t._isValid()?(e&&(this._moConfig.bAnimation=!1),this.hide(function(){t._msStatus="close",t.panelDestroy_(),callBack.call(t,t._moConfig.onclose)})):(t._msStatus="close",t.panelDestroy_())}return this},setBody:function(e){return this._moPanelDom.innerHTML=this.processHtml_(e),callBack.call(this,this._moConfig.onload),this},setHtml:function(e,t){return(("string"==typeof e?this.S(e):e)||{}).innerHTML=this.processHtml_(t),this},isShow:function(){return"show"==this._msStatus||"showing"==this._msStatus},isClose:function(){return"close"==this._msStatus}}},{_TEMPLATE:{_SKIN:TE(['<div id="$sPanelId$" class="$sClassName$" $sAttr$ ','style="$sStyle$;display:none;z-index:$nZIndex$;position:absolute;left:$nX$px;top:$nY$px;',"$@$if($nHeight$&&!isNaN($nHeight$))$@$ height:$nHeight$px; $@$endif$@$",'$@$if($nWidth$&&!isNaN($nWidth$))$@$ width:$nWidth$px; $@$endif$@$"',">","$sBodyHtml$","</div>"])}}),QMDialog=inheritEx("QMDialog",QMPanel,function(v){return{initMemVar_:function(e){callBack.call(this,v.initMemVar_,[e]),this._moMaskDom=null,this._moMinAnimation=null,this._moMinDlgDom=null;var t=this.constructor;this._moDlgArray=e.bModal?t._oMdlgArray:t._oNdlgArray},_ioDlgArray:function(e){var o,a=this,t=this.constructor,n=this._moDlgArray,i=function(e,t,n){for(var i=e.length-1;0<=i;i--)(a=e[i]).option("nZIndex",o?n:t),a._lightHead(o),o=!0};if(0<e){for(var r in n)if(n[r]==this){a=n.splice(r,1)[0];break}2==e&&(e=0)}0==e&&n.push(a),i(t._oMdlgArray,1120,1106),i(t._oNdlgArray,1110,1105)},setEvent_:function(){var e=this._moConfig,n=this;e.bModal?addEvent(this._moMaskDom,"mousedown",function(){var e=n.constructor._oMdlgArray,t=e[e.length-1];t&&t.spark()}):addEvent(this._moPanelDom,"mousedown",function(){e.bModal||n._ioDlgArray(2)});e.oEmbedWin;var t=this._moPanelDom;e.bMin&&(this.S("_minbtn_").onclick=function(){return n.min(),!1}),e.bClose&&(this.S("_closebtn_").onclick=function(){return n.close(),!1}),t.tabindex="-1",addEvent(t,"keydown",function(e){e&&27==e.keyCode&&(n.close(),preventDefault(e))}),new QMDragDrop.Draggable(n._moPanelDom,{handle:n.S("_head_"),maxcontainer:e.oEmbedWin.document.body},{ondragstart:function(){callBack.call(n,e.ondragstart)},ondrag:function(){callBack.call(n,e.ondrag)},ondragend:function(){n._moConfig.nX=parseInt(n._moPanelDom.style.left),n._moConfig.nY=parseInt(n._moPanelDom.style.top)}}).lock(!e.bDraggable)},dfConfig_:function(e){this.configHelp_(e,{bModal:!0}),this.configHelp_(e,{sClassName:e.sClassName?"qm_dialog "+e.sClassName:"qm_dialog"},!0);var t={bDraggable:!0,bClose:!0,bAnimation:!0,sEmbedPos:"beforeEnd",sTitle:""},n=this.constructor,i=e.bModal?n._oMdlgArray:n._oNdlgArray,o=i[i.length-1];o&&!e.bAlignCenter&&extend(t,{nX:o.option("nX")+20,nY:o.option("nY")+20}),this.configHelp_(e,t);var a=S("qmdialog_container",getTop());if(!a){var r=getTop().document;insertHTML(r.body,"complete"==r.readyState?"beforeEnd":"afterBegin",'<span id="qmdialog_container"></span>'),a=S("qmdialog_container",getTop())}return this.configHelp_(e,{oEmbedWin:getTop(),oEmbedToDom:a,nZIndex:e.bModal?1110:1105},!0),callBack.call(this,v.dfConfig_,[e])},insertHtml_:function(e){this._msPanelId;e.sBodyHtml=QMDialog._TEMPLATE._SKIN.replace(e),e.sClassName=e.sClassName+(e.sFootHtml?"":" nofoot "),callBack.call(this,v.insertHtml_,[e])},htmlReady_:function(e){var t=this;e.bModal&&(t._moMaskDom=t._getMask(e.oEmbedWin)),e.bMin&&(insertHTML(t._moPanelDom,"afterEnd",t.processHtml_(t.constructor._TEMPLATE._MIN_ANIMATION.replace(e))),this._moMinAnimation=this.S("_min_animation_")),callBack.call(this,v.htmlReady_,[e])},_getMask:function(e){e=e||getTop();var t="qqmail_mask",n=S(t,e);return n||(insertHTML(e.document.body,"beforeEnd",T(['<div id="$id$" class="$class$" style="z-index:98;display:none;"',' onkeypress="return false;" onkeydown="return false;"',' tabindex="0"></div>']).replace({"class":"editor_mask opa50Mask ",id:t})),n=S(t,e)),n},panelDomCtrl_:function(e,t,n){this._ioDlgArray(e?0:1);var i=this,o=i._moConfig,a=(n=n||(o.bAnimation?"ani1":"ani0"),getTop().qmAnimation),r=this.constructor._oMdlgArray.length,s=i._moPanelDom,l=i.S("_content_");function c(){o.sUrl&&e&&(i.S("_dlgiframe_").height="0",i.S("_dlgiframe_").height=i._moPanelDom.offsetHeight-i.S("_head_").offsetHeight)}if(this._moConfig.bModal&&r==(e?1:0)&&(callBack(getTop().iPadPrevent),show(this._moMaskDom,e)),hideWindowsElement(!e),"ani0"==n)callBack.call(this,v.panelDomCtrl_,[e,t]),c();else{if("ani2"==n){var u=i._moMinAnimation,d=i._moMinDlgDom,f=calcPos(show(d,!0)),p=(i._mnPanelWidth||s.offsetWidth)-f[4],m=(i._mnPanelHeight||s.offsetHeight)-f[5],h=o.nX-f[3],_=o.nY-f[0],g=function(n){E(["left","top","width","height"],function(e,t){u.style[e]=n[t]+"px"})};return void(e?a.play(s,{win:window,speed:300,onready:function(){show(u,!0),show(d,!1)},onaction:function(e,t){g([f[3]+h*t,f[0]+_*t,f[4]+p*t,f[5]+m*t])},oncomplete:function(){show(u,!1),s.style.top=s.getAttribute("originTop"),callBack.call(i,t)}}):(i._mnPanelWidth=s.offsetWidth,i._mnPanelHeight=s.offsetHeight,a.play(s,{win:window,speed:300,onready:function(){s.setAttribute("originTop",s.style.top),s.style.top="-1000px",show(u,!0)},onaction:function(e,t){g([o.nX-h*t,o.nY-_*t,i._mnPanelWidth-p*t,i._mnPanelHeight-m*t])},oncomplete:function(){show(u,!1),callBack.call(i,t)}})))}"ani1"==n&&(e?a.play(s,{win:window,speed:300,easing:"easeOut",tween:"Sina",from:-30,to:0,onready:function(){show(setOpacity(s,0),!0),i.autoAlignCenter_(),c(),l.style.visibility="hidden"},onaction:function(e,t){setOpacity(s,t).style.marginTop=e+"px"},oncomplete:function(){setOpacity(s,1).style.marginTop=0,l.style.visibility="visible",callBack.call(i,t)}}):a.play(s,{win:window,speed:300,easing:"easeIn",tween:"Sina",from:0,to:-30,onaction:function(e,t){setOpacity(s,1-t).style.marginTop=e+"px"},oncomplete:function(e){show(s,!1),callBack.call(i,t)}}))}},panelDomDestroy_:function(){var e=this;if(e._moConfig.sUrl)try{e.S("_dlgiframe_").contentWindow.location.replace("javascript:'';")}catch(t){}e._moConfig.bAnimation&&qmAnimation.stop(e._moPanelDom),e._moMinDlgDom&&removeSelf(e._moMinDlgDom),removeSelf(e._moPanelDom),removeSelf(e._moMinAnimation),e._moPanelDom=null},_lightHead:function(e){_oPanelDom=this._moPanelDom,setClass(_oPanelDom,(this._moConfig.sClassName||"qm_dialog ")+(e?" qm_dialog_flash":""))},S:function(e){var t=this._moConfig,n=callBack.call(this,v.S,[e]);return t.sUrl&&!n&&(n=S(e,v.S("_dlgiframe_").contentWindow)),n},close:function(e){var t=this._moConfig.onbeforeclose;if(!t||!1!==t.call(this))return e&&(this._moConfig.bAnimation=!1),callBack.call(this,v.close),callBack(getTop().iPadRemoveEvent),this},min:function(){if("show"==this._msStatus){var e=this,t=S("minimize_container",getTopWin()),n=e._moConfig,i=e._msPanelId+"_min",o=e._moMinDlgDom,a=e._moConfig.onbeforemin;if(!a||a.call(e))return o||(insertHTML(t,"beforeEnd",e.constructor._TEMPLATE._MINTAB_.replace({dialogId:n.sId,id:i,title:n.sTitle})),this._moMinDlgDom=o=S(i,getTopWin())),e.panelDomCtrl_(!1,function(){e._msStatus="min",show(o,!0),callBack.call(e,e._moConfig.onmin)},"ani2"),e}},max:function(){if("min"==this._msStatus){var e=this,t=e._moMinDlgDom;calcPos(t),e._moConfig;return e.panelDomCtrl_(!0,function(){e._msStatus="show",show(t,!1),callBack.call(e,e._moConfig.onmax)},"ani2"),this}},spark:function(){var t=this,n=4;return function(){0<--n&&setTimeout(arguments.callee,80);var e=n%2;t._lightHead(e)}(),t},getMinDom:function(){return this._moMinDlgDom},getDialogWin:function(){var e=this._moConfig;return e.sUrl?this.S("_dlgiframe_").contentWindow:e.oEmbedWin},setHeader:function(e){return this.S("_title_").innerHTML=this.processHtml_(e),this},setBody:function(e){return this.S("_content_").innerHTML=this.processHtml_(e),callBack.call(this,this._moConfig.onload),this}}},{_TEMPLATE:{_SKIN:TE(['<div style="cursor:$@$if($bDraggable$)$@$move$@$endif$@$;" class="dialog_head" id="_head_">','<span id="_title_">$sTitle$</span>',"$@$if($bMin$)$@$",'<a title="\u6700\u5c0f\u5316" class="ico_minimize" href="javascript:;" initlized="true" id="_minbtn_"><em class="ico_minimize_inner"></em></a>',"$@$endif$@$","$@$if($bClose$)$@$",'<a title="\u5173\u95ed" dlg="close" class="ico_close_d" href="javascript:;" id="_closebtn_" initlized="true"></a>',"$@$endif$@$","</div>",'<div id="_content_">',"$@$if($sUrl$)$@$",'<iframe id="_dlgiframe_" frameborder="0" scrolling="no" src="$sUrl$" style="width:100%;"></iframe>',"$@$else$@$","<div>",'<div class="dialog_content" id="_body_">',"$sBodyHtml$","</div>","$@$if($sFootHtml$)$@$",'<div class="dialog_operate" id="_foot_">',"$sFootHtml$",'<div class="clr"></div>',"</div>","$@$endif$@$","</div>","$@$endif$@$","</div>"]),_MINTAB_:T('<span id="$id$" style="display:none;"><a href="javascript:;" onclick="getTop().QMDialog(\'$dialogId$\',\'max\');" nocheck="true">$title$</a>&nbsp;|&nbsp;</span>'),_MIN_ANIMATION:T('<div id="_min_animation_" style="display:none;position:absolute;z-index:$nZIndex$;border-width:2px;left:$nX$;top:$nY$;" class="bd_upload"></div>')},_oNdlgArray:[],_oMdlgArray:[]}),QMTabDialog=inheritEx("QMTabDialog",QMDialog,function(o){return{dfConfig_:function(e){var t={sTitle:"",sBodyHtml:"",sFootHtml:"",sClassName:e.sClassName?"qm_tab_dialog "+e.sClassName:"qm_tab_dialog"};this.configHelp_(e,t,!0),callBack.call(this,o.dfConfig_,[e])},insertHtml_:function(e){var t="",n="",i=e.oTabs||[];0<i.length&&(t=QMTabDialog._TEMPLATE._TABTITLE.replace({oTabs:i}),n=QMTabDialog._TEMPLATE._TABCONTENT.replace({oTabs:i})),e.sTitle=t,e.sBodyHtml=n,callBack.call(this,o.insertHtml_,[e])},setEvent_:function(){var u=this,d=getTopWin(),e={rule:function(){return{click:{click_tab_title:{bPropagable:!1}}}},events:function(){return{click_tab_title:function(e,t){if("true"!=attr(t,"selected")){if(1==attr(t,"isdisabled"))return;var n=u.S("tab_title"),i=d.finds("span[selected='true']",n)[0];attr(i,"selected","false"),rmClass(i,"actived"),addClass(i,"pointer"),attr(t,"selected","true"),rmClass(t,"pointer"),addClass(t,"actived");var o=u.S("tab_content"),a=attr(i,"tab-num"),r=d.finds("div[tab-num='"+a+"']",o)[0],s=attr(t,"tab-num"),l=d.finds("div[tab-num='"+s+"']",o)[0];r.style.position="absolute",r.style.top="-999px",r.style.left="-999px",attr(r,"expanded","false"),l.style.position="static",d.show(l,!0),attr(l,"expanded","true");var c="function"==typeof u._moConfig.ontoggletab?u._moConfig.ontoggletab:function(){};callBack.call(u,c,[i,t])}}}}};d.liveEvent(this.getPanelDom(),e),callBack.call(this,o.setEvent_,[])},_fInitAllTabContent:function(i){var o=getTopWin(),a=this,r=a.S("tab_content");E(i.oTabs,function(e,t){var n=o.finds("div[tab-num='"+t+"']",r)[0];e.fInitTabContent||(e.fInitTabContent=function(){}),i.bUseSelfCallback?e.fInitTabContent.apply(a,[n]):o.callBack(e.fInitTabContent,[n])})},htmlReady_:function(e){this._fInitAllTabContent(e),callBack.call(this,o.htmlReady_,[e])},panelDomDestroy_:function(){this._moConfig.sMinTabId&&(this._moMinDlgDom=null),callBack.call(this,o.panelDomDestroy_,[])},getSelectedTab:function(){var e=getTopWin(),t=this.S("tab_title");return e.finds("span[selected='true']",t)[0]},getSelectedContent:function(){return getTopWin().finds("div[expanded='true']",this.S("tab_content"))[0]},min:function(){if("show"==this._msStatus){var e=this,t=e._moConfig;if(t.sMinTabId){var n=e._moConfig.onbeforemin;if(n&&!n.call(e))return;return e._moMinDlgDom=S(t.sMinTabId,getTopWin()),e.panelDomCtrl_(!1,function(){e._msStatus="min",callBack.call(e,e._moConfig.onmin)},"ani2"),e}return callBack.call(e,o.min,[]),e}},max:function(){if(this._moConfig.sMinTabId){if("min"!=this._msStatus)return;var e=this;return e.panelDomCtrl_(!0,function(){e._msStatus="show",callBack.call(e,e._moConfig.onmax)},"ani2"),e}return callBack.call(this,o.max,[]),this},show:function(){var t=this;if("showing"!=t._msStatus&&"show"!=t._msStatus){t._msStatus="show";var e=t.getPanelDom(),n=e.getAttribute("originTop");e.style.display="block",n&&(e.style.top=n),show(t._moMaskDom,!0),t.autoAlignCenter_(),setTimeout(function(){try{callBack.call(t,t._moConfig.onshow)}catch(e){debug("onshow error : "+e.message)}})}return t},hide:function(e){var t=this;if("hiding"!=t._msStatus&&"hide"!=t._msStatus){t._msStatus="hide";var n=t.getPanelDom();n.setAttribute("originTop",n.style.top);n.style.top="-999px",show(t._moMaskDom,!1),setTimeout(function(){callBack.call(t,t._moConfig.onhide)}),callBack.call(t,e)}else callBack.call(t,e);return t}}},{_TEMPLATE:{_TABTITLE:TE(['<div id="tab_title" class="dialog_tab_title">',"$@$for($oTabs$)$@$",'<span tab-num="$_idx_$" ck="click_tab_title" $@$if($bDefaultHide$==true)$@$style="display:none"$@$endif$@$',"$@$if($bDefault$==true)$@$",' selected="true" class="dialog_tab_list actived" ',"$@$else$@$",' selected="false" class="dialog_tab_list pointer" ',"$@$endif$@$",">$sTabTitle$</span>","$@$endfor$@$","</div>",'<div class="clr"></div>']),_TABCONTENT:TE(['<div id="tab_content">',"$@$for($oTabs$)$@$",'<div tab-num="$_idx_$" class="tab_content_list" ',"$@$if($bDefault$==true)$@$",' expanded="true" ',"$@$else$@$",' expanded="false" style="display:none;" ',"$@$endif$@$",">$sTabContent$</div>","$@$endfor$@$","</div>"]),_MINTAB_:QMDialog._TEMPLATE._MINTAB_,_MIN_ANIMATION:QMDialog._TEMPLATE._MIN_ANIMATION},_oNdlgArray:QMDialog._oNdlgArray,_oMdlgArray:QMDialog._oMdlgArray}),QMMenu=inheritEx("QMMenu",QMPanel,function(c){return{initMemVar_:function(e){var t=this;callBack.call(t,c.initMemVar_,[e]),t._moCurSelDom,t._moItemNode,t._moSubMenu=null,t._moParentMenu=null,t._mnSubMenuTimeoutOpen=null,t._mnSubMenuTimeoutClose=null,t._mnAllMenuTimeoutClose=null},setEvent_:function(){var a=this,r=a._moConfig,o=a.S("_menuall_"),e=(a.S("_foot_"),a.getPanelDom());function s(e,t){for(;e;){var n=e.id||"";if(-1<n.indexOf("_menuitem_"))return!t&&-1<e.className.indexOf("menu_item_nofun")?0:e;if(/_QMMenu$/.test(n))return 0;e=e.parentNode}return null}function t(e){if(!1!==r.bProxyScroll){var t=getEventTarget(e),n="undefined"==typeof e.wheelDelta?e.detail/3:-e.wheelDelta/120,i=o.scrollTop+20*n;for(o.scrollTop=Math.min(Math.max(i,0),o.scrollHeight-o.offsetHeight);t;){if(t.getAttribute&&"true"==t.getAttribute("scroll"))return;t=t.parentNode}preventDefault(e),stopPropagation(e)}}function l(e){var t=r.oItems;for(var n in t)if(t[n].sId==e)return t[n]}addEvents(e,{contextmenu:preventDefault,mousewheel:t,DOMMouseScroll:t,mouseout:function(e){var t=a._moCurSelDom,n=s(e.relatedTarget||e.toElement,1);if(null==n&&r.bAutoClose&&a._closeAllMenu(),0!==n&&n!=t&&t){for(var i=["sub",t.getAttribute("itemid"),"_QMMenu"].join(""),o=n;o;){if(o.id==i)return;o=o.parentNode}if(a._moSubMenu&&null==n&&t==a._moSubMenu._moParentItem)return;return a._clearTimeoutOpenSubMenu()._clearTimeoutCloseSubMenu(),a._mnSubMenuTimeoutClose=setTimeout(function(){a._closeSubMenu()},100),setClass(a._moCurSelDom,"menu_item"),a._moCurSelDom=null}},mouseover:function(e){r.bAutoClose&&a._clearTimeoutCloseAllMenu();var t=s(getEventTarget(e));if(t){a._selectItem(t);var n=l(t.getAttribute("itemid"));n.oSubMenu&&a._openSubMenu(n,t)}a._moParentMenu&&(a._moParentMenu._clearTimeoutOpenSubMenu()._clearTimeoutCloseSubMenu(),a._moParentMenu.selectItem(a._moParentItem))},click:function(e){var t;if("close"==getEventTarget(e).getAttribute("qmmenuopt"))a.close();else if(t=s(getEventTarget(e))){var n=t.getAttribute("itemid"),i=l(n);i.oSubMenu||(a._clearTimeoutOpenSubMenu(),callBack.call(a,r.onitemclick,[n,i]),setClass(t,"menu_item"),a.close(),a._closeParentMenu())}}}),addEvent(a._moPanelDom,"mousedown",stopPropagation)},dfConfig_:function(e){return this.configHelp_(e,{bAutoClose:!0,nZIndex:1121,nWidth:"auto",nMinWidth:100,nMaxWidth:9999,bAnimation:!0,nMaxItemView:1e6,sClassName:"qmpanel_shadow rounded5"}),this.configHelp_(e,{nHeight:"auto",sStyle:"background:#fff"},!0),e.nArrowPos&&(e.nX-=e.nArrowPos,e.nY+=12),callBack.call(this,c.dfConfig_,[e])},insertHtml_:function(e){for(var t=e.oItems,n=e.oFootItems,i=t.length>e.nMaxItemView,o=i?e.nMaxItemView:t.length,a=(this._msPanelId,0),r=0;r<t.length;r++){var s=t[r].nHeight=t[r].nHeight||e.nItemHeight||22;r<o&&(a+=s),0===t[r].sId&&(t[r].sId="0"),this.configHelp_(t[r],{bDisSelect:!t[r].sId})}if(n){r=0;for(var l=n.length;r<l;r++)0===n[r].sId&&(n[r].sId="0"),this.configHelp_(n[r],{nHeight:e.nItemHeight||22,bDisSelect:!n[r].sId})}e.sBodyHtml=QMMenu._TEMPLATE._SKIN.replace({nArrowPos:e.nArrowPos||0,sWidthDetect:e.sWidthDetect||"mini",mwidth:e.nWidth-3,mheight:i?a:"auto",nMinWidth:e.nMinWidth,oItems:e.oItems,oFootItems:e.oFootItems}),callBack.call(this,c.insertHtml_,[e])},adjustSize_:function(){var e=this;if("auto"==e._moConfig.nWidth){var t=e.S("_menuall_"),n=e.S("_foot_");if(t&&10<t.offsetWidth){var i=Math.max(e._moConfig.nMinWidth,Math.min(t.scrollWidth,e._moConfig.nMaxWidth))+(gbIsIE?0:t.offsetWidth-t.scrollWidth);"number"==typeof e._moConfig.nMaxWidth&&i>e._moConfig.nMaxWidth?i=e._moConfig.nMaxWidth:"number"==typeof e._moConfig.nMinWidth&&i<e._moConfig.nMinWidth&&(i=e._moConfig.nMinWidth),n.style.width=t.style.width=i+"px",setClass(t,"txtflow")}}},panelDomCtrl_:function(e,t){var n=this,i=n._moPanelDom;if(!this._moConfig.bAnimation||gbIsIE)return callBack.call(this,c.panelDomCtrl_,[e,t]),n.adjustSize_();if(e){var o=!0;show(i,!0),qmAnimation.expand(i.lastChild,{win:window,from:0,speed:200,easing:"easeOut",tween:"Cubic",oncomplete:function(){callBack.call(n,t)},onaction:function(){o&&(n.adjustSize_(),o=0)}})}else qmAnimation.fold(i.lastChild,{win:window,speed:200,easing:"easeIn",tween:"Cubic",oncomplete:function(){show(i,!1),callBack.call(n,t)}})},panelDomDestroy_:function(){this._moConfig.bAnimation&&qmAnimation.stop(this._moPanelDom),removeSelf(this._moPanelDom),this._moPanelDom=null},_getItemDom:function(e){return"number"==typeof e?this.S("_menuall_").childNodes[e]:this.S("_menuitem_"+e)},_selectItem:function(e){var t="string"==typeof e||"number"==typeof e?this.S("_menuitem_"+e):e;return this._moCurSelDom==t||(t&&(t.className="menu_item_high"),this._moCurSelDom&&(this._moCurSelDom.className="menu_item"),this._moCurSelDom=t),this},_clearTimeoutOpenSubMenu:function(){return this._mnSubMenuTimeoutOpen&&(clearTimeout(this._mnSubMenuTimeoutOpen),this._mnSubMenuTimeoutOpen=null),this},_clearTimeoutCloseSubMenu:function(){return this._mnSubMenuTimeoutClose&&(clearTimeout(this._mnSubMenuTimeoutClose),this._mnSubMenuTimeoutClose=null),this},_clearTimeoutCloseAllMenu:function(){for(var e=this;e._moParentMenu;)e=e._moParentMenu;for(;e;)e._mnAllMenuTimeoutClose&&(clearTimeout(e._mnAllMenuTimeoutClose),e._mnAllMenuTimeoutClose=null),e=e._moSubMenu;return this},_closeAllMenu:function(){var e=this;return e._mnAllMenuTimeoutClose&&clearTimeout(e._mnAllMenuTimeoutClose),e._mnAllMenuTimeoutClose=setTimeout(function(){e._closeParentMenu().close(),e._mnAllMenuTimeoutClose=null},500),e},_openSubMenu:function(e,i){var o=this,a=o._moConfig,r=o.configHelp_(e.oSubMenu,a);if(r.sId="sub"+e.sId,r.nZIndex=a.nZIndex+1,o._moSubMenu&&o._moSubMenu._moConfig.sId==r.sId)return o;o._clearTimeoutOpenSubMenu(),o._mnSubMenuTimeoutOpen=setTimeout(function(){if(o._moSubMenu&&o._closeSubMenu(),o.isShow()){var e=calcPos(i);e[0]-=5,e[1]-=1,e[2]+=7,e[3]+=2;var t=o._moSubMenu=new QMMenu(r),n=calcAdjPos(e,t.option("nWidth"),t.option("nHeight"),a.oEmbedWin,1);t.option("nY",Math.max(0,n[0])).option("nX",Math.max(0,n[3]))._moParentMenu=o,t._moParentItem=i}},100)},_closeSubMenu:function(){return this._moSubMenu&&(this._moSubMenu.close(),this._moSubMenu=null),this},_closeParentMenu:function(){var e=this._moParentMenu;return e&&(e._moSubMenu=null,e._closeParentMenu().close(),this._moParentMenu=null),this},toggle:function(){return this.isShow()?this.hide():this.show(),this},selectItem:function(e){var t=this;return t._selectItem(e),t._moCurSelDom&&scrollIntoMidView(t._moCurSelDom,t.S("_menuall_")),t},addItem:function(e,t){var n=this,i=n._getItemDom(e);if(n.configHelp_(t,{nHeight:22}),i)insertHTML(i,"beforeBegin",n.constructor._TEMPLATE._SKIN.replace(t,"item"));else{n.S("_menuall_").childNodes;insertHTML(n.S("_menuall_"),"beforeEnd",n.constructor._TEMPLATE._SKIN.replace(t,"item"))}},delItem:function(e){var t=this._getItemDom(e);t&&removeSelf(t)},itemOption:function(e,t,n){var i=this._getItemDom(e);if(i)switch(t){case"bDisSelect":i.className=n?"menu_item_nofun":"menu_item";break;case"bDisplay":i.style.display=n?"":"none"}},close:function(e){var t=this,n=t._moConfig.onbeforeclose;if(!n||!1!==n.call(t))return e&&(this._moConfig.bAnimation=!1),t._clearTimeoutOpenSubMenu(),t._closeSubMenu(),callBack.call(t,c.close)},autoClose:function(){return this._closeAllMenu()},option:function(e,t){var n=this;if(void 0!==t){switch(e){case"nHeight":n.S("_menuall_").style.height="number"==typeof t?t-(n._moConfig.nGap?n._moConfig.nGap:12)+"px":t;break;case"nX":n._moConfig.nArrowPos&&(t-=n._moConfig.nArrowPos);break;case"nY":n._moConfig.nArrowPos&&(t+=12)}return callBack.call(n,c.option,[e,t])}var i=callBack.call(n,c.option,[e]);switch(e){case"nX":n._moConfig.nArrowPos&&(i+=n._moConfig.nArrowPos);break;case"nY":n._moConfig.nArrowPos&&(i-=12)}return i}}},{makeMenuItem:function(e,t){for(var n=[],i=0,o=t?Math.min(e.length,t.length):e.length;i<o;i++)n.push({sId:t?t[i]:i,sItemValue:e[i]});return n},_TEMPLATE:{_SKIN:TE(['$@$if($nArrowPos$>0&&$nArrowDirection$=="Up")$@$','<div class="t_arrow" style="left:$nArrowPos$px;">','<div class="t_arrow_d"></div>','<div class="t_arrow_u"></div>',"</div>",'$@$else if($nArrowPos$>0&&$nArrowDirection$=="Left")$@$','<div class="c_arrow" style="left:-10px;top:$nArrowPos$px;">','<div class="c_arrow_d"></div>','<div class="c_arrow_u"></div>',"</div>","$@$else if($nArrowPos$>0)$@$",'<span class="arrow" style="left:$nArrowPos$px;"></span>',"$@$endif$@$",'<div style="margin:0pt;">','<div class="menu_base">','<div class="menu_bd">','<div id="_menuall_"','style="overflow-y:auto;$@$if(isNaN($mwidth$))$@$width:$@$if(gbIsIE&&$sWidthDetect$!="float")$@$$nMinWidth$px;$@$else$@$auto$@$endif$@$;$@$else$@$overflow-x:hidden;width:$mwidth$px;$@$endif$@$','$@$if($mheight$)$@$height:$mheight$$@$endif$@$$@$if(!isNaN($mheight$))$@$px$@$endif$@$;">',"$@$for($oItems$)$@$","$@$sec item$@$",'<div $@$if(!$bDisSelect$ & (""+$sItemValue$).indexOf("<") < 0)$@$title="$@$eval htmlEncode($sItemValue$) $@$"$@$endif$@$ id="_menuitem_$sId$" itemid="$sId$" class="menu_item$@$if($bDisSelect$)$@$_nofun$@$endif$@$"','style="height:$nHeight$$@$if(!isNaN($nHeight$))$@$px$@$endif$@$;line-height:$nHeight$$@$if(!isNaN($nHeight$))$@$px$@$endif$@$;$sStyle$" onclick=";">$sItemValue$</div>',"$@$endsec$@$","$@$endfor$@$","</div>",'<div id="_foot_"','style="overflow-y:auto;$@$if(isNaN($mwidth$))$@$width:$@$if(gbIsIE)$@$$nMinWidth$px;$@$else$@$auto$@$endif$@$;$@$else$@$overflow-x:hidden;width:$mwidth$px;$@$endif$@$','padding-top:3px;border-top:1px solid #ccc;$@$if(!$oFootItems$)$@$display:none;$@$endif$@$height:auto;">',"$@$for($oFootItems$)$@$",'<div id="_menuitem_$sId$" itemid="$sId$" class="menu_item$@$if($bDisSelect$)$@$_nofun$@$endif$@$"','style="height:$nHeight$px;line-height:$nHeight$px;" onclick=";">$sItemValue$</div>',"$@$endfor$@$","</div>","$@$if($nArrowPos$>0)$@$",'<a class="btn_close" qmmenuopt="close"  onmousedown="return false;"></a>',"$@$endif$@$","</div>","</div>","</div>"])}});function QMSelect(e){this.constructor=arguments.callee,this._initialize(e)._setup()}QMSelect.prototype={get:function(e){switch(e=e||1){case 1:case 2:return this._moSelectItem[1==e?"sItemValue":"sId"];case 8:return S(this._msSelectId,this._moWin);case"menu":return this._moMenu}},set:function(e,t){var n=this,i=n._getItem(e,t);return i._customvalue||(S(n._moConfig.sId,n._moWin).innerHTML=(n._moSelectItem=i).sItemValue),n},update:function(e){var t=this;t.configHelp_(e,t._moConfig),t.configHelp_(e.oMenu,t._moConfig.oMenu),t._moConfig=e,t._moSelectItem=t._getItem(e.sDefaultId,2,1),t._setup().set(e.sDefaultId,2)},_getItem:function(e,t,n){var i,o=2==t?"sId":"sItemValue",a=this._moConfig,r=a.oMenu.oItems;a.oMenu.oFootItems&&(r=r.concat(a.oMenu.oFootItems));for(var s=0,l=r.length;s<l;s++)if(r[s].sId||0===r[s].sId){if(r[s][o]==e)return r[s];n&&!i&&(i=r[s])}return i||{sItemValue:a.sDefaultItemValue,_customvalue:1}},configHelp_:function(e,t,n){for(var i in t)(n||"undefined"==typeof e[i]||null==e[i])&&(e[i]=t[i]);return e},_initialize:function(e){var t=this;return t._moWin=e.oContainer.ownerDocument.parentWindow||e.oContainer.ownerDocument.defaultView,t.configHelp_(e,{sDefaultItemValue:"",sId:QMSelect._TEMPLATE._ID_PREFIX+Math.random()}),t._moConfig=e,t._moSelectItem=t._getItem(e.sDefaultId,2,!e.sDefaultItemValue),this},_setup:function(){var e=getTop(),d=this,f=d._moConfig,p=S(f.sId,d._moWin);if(p||(f.sName&&insertHTML(f.oContainer,"beforeEnd",QMSelect._TEMPLATE._CUSTOM_HIDDEN.replace(f)),insertHTML(f.oContainer,"beforeEnd",QMSelect._TEMPLATE._CUSTOM_SELECT.replace(extend(f,{content:d._moSelectItem.sItemValue,images_path:getPath("image")})))),p=S(f.sId+"_div",d._moWin))return d.configHelp_(f.oMenu,{oEmbedWin:d._moWin,sId:"select",sWidthDetect:"\u79fb\u52a8\u5230..."==f.content?"float":"",nWidth:p.clientWidth+3,nMinWidth:p.clientWidth+3,onitemclick:function(e){f.sName&&(S(f.sName,d._moWin).value=e),callBack.call(d,f.onselect,[d._getItem(e,2)])||(d._moSelectItem=d._getItem(e,2),d.set(e,2)),callBack.call(d,f.onchange,[d._getItem(e,2)])},onshow:function(){var e=d._moSelectItem.sId;(e||0===e)&&this.selectItem(e)},onload:function(){var e=calcPos(p),t=bodyScroll(d._moWin,"clientHeight"),n=bodyScroll(d._moWin,"scrollTop"),i=t+n;callBack.call(d,f.onafteropenmenu,[this,p]);var o=parseInt(this.option("nHeight")),a=e[2],r=p.offsetHeight,s=a-o-r,l=!0;if(f.oMenu.bAutoItemView){var c,u=t/2+n;f.oMenu.nMaxHeight?(c=Math.min(o,f.oMenu.nMaxHeight),u<a&&0<a-c-r&&(a=a-c-r,l=!1)):a<u?c=Math.floor(.66*(i-a)):a+o<i?c=o:(c=Math.floor(.66*(t-(i-a+r))),a=a-Math.min(o,c)-r,l=!1),c<o&&this.option("nHeight",c)}else 0<s&&i<a+o&&(a=s);f.oMenu.bOverLap&&(a+=l?-1:1),this.option("nX",e[3]).option("nY",a)}}),addEvent(d._moWin.document.body,gbIsIE?"mousewheel":"DOMMouseScroll",function(){e.QMMenu("select","close")}),p.onclick=function(){callBack.call(d,f.onbeforeopenmenu,[f.oMenu]),d._moMenu=new e.QMMenu(f.oMenu)},d}},QMSelect._TEMPLATE={_CUSTOM_SELECT:T(['<div id="$sId$_div" class="bd" ',' style="border-width:1px 2px 2px 1px;cursor:pointer;width:$nWidth$px;padding:1px 1px 1px 2px;background:#fff;float:left;$sStyle$">','<div class="attbg" style="width:16px;height:18px;overflow:hidden;text-align:center;float:right;"><img src="$images_path$webqqshow_on.gif" align="absmiddle" style="margin:3px 0 0 0;" /></div>','<div id="$sId$" class="txtflow" style="padding-left:3px;padding-left:3px!important;line-height:18px;height:18px;">$content$</div>',"</div>"]),_CUSTOM_HIDDEN:T('<input type="hidden" id="$sName$" name="$sName$" value="$sDefaultId$"/>'),_ID_PREFIX:"QmCs_2_"};var QMAutoComplete=inherit("QMAutoComplete",Object,function(e){return{$_constructor_:function(e){this._initialize(e)},show:function(e){return this._moData=e,this._show()},close:function(){return this._moMenu&&this._moMenu.hide(),this},isShow:function(){var e=this._moMenu;return e&&e.isShow()},getSelection:function(){return this._moData[this._moMenu.getSelectItemId()]},setHeader:function(e){var t=this._moMenu;return t&&t.setHeader(e)},_initialize:function(e){var n=this,t=n._moInput=e.oInput;return n._moPosObj=e.oPosObj||t,n._moWin=n._moPosObj.ownerDocument.parentWindow||n._moPosObj.ownerDocument.defaultView,n._moData=null,n._moMenu=null,n._msDefaultValue=e.defaultValue||"",n._mbsupportKey=!e.notSupportKey,n._msType=e.type||"",t.setAttribute("autocomplete","off"),n._msUrl=e.sUrl,n._ondata=e.ondata,n._nDelay=n._msUrl?500:20,n._nDelay="number"==typeof e.nDelay?e.nDelay:n._nDelay,n._ongetdata=e.ongetdata,n._onselect=e.onselect,n._onclick=e.onclick,n._onkeydown=e.onkeydown,n._ontouchstart=e.ontouchstart,addEvents(t,{keydown:n._bind(n._keydown),keypress:n._bind(n._keypress),keyup:n._bind(n._keyup),focus:n._bind(n._focus),blur:n._bind(n._blur)}),n._moMenu=new QMAutoComplete._QMAutoCompleteMenu({sId:unikey(),oItems:[],supportKey:n._mbsupportKey,oEmbedWin:n._moWin,nWidth:e.nWidth||"auto",nMinWidth:e.nMinWidth||100,nItemHeight:e.nItemHeight||21,nMaxItemView:e.nMaxItemView||0,type:e.type,oClass:e.oClass,bDisplay:!1,onselect:function(e){callBack.call(n,n._onselect,[n._moData[e]])},onclick:function(e,t){callBack.call(n,n._onclick,[e,n._moData[t]])},ontouchstart:function(e){callBack.call(n,n._ontouchstart,[e])}}),n._setTextDefaultValue()},_bind:function(t){var n=this;return function(e){return t.call(n,e)}},_keypress:function(e){gbIsOpera&&13==e.keyCode&&preventDefault(e)},_keyup:function(e){if(!e.ctrlKey){var t=e.keyCode,n=this;38==t||40==t||13==t&&229!=n._mnKeydownCode||27==t||(n._keyupTimeout&&clearTimeout(n._keyupTimeout),n._keyupTimeout=setTimeout(function(){if(n._msUrl){var e=trim(n._moInput.value);""==e?n.close():(e=encodeURIComponent(e),QMAjax.send([n._msUrl,"&resp_charset=UTF8&q=",e].join(""),{method:"get",onload:function(e,t){e&&(n._moData=n._ondata.call(n,t),n._show()._keyupTimeout=0)}}))}else n._moData=n._ongetdata(n._moInput,t),n._show()._keyupTimeout=0},n._nDelay))}},_keydown:function(e){var t=this,n=e.keyCode;if(callBack.call(t,t._onkeydown,[e,1]),t._mnKeydownCode=n,t.isShow()&&this._mbsupportKey)switch(n){case 13:callBack.call(t,t._onselect,[t.getSelection()]),t.close(),preventDefault(e);break;case 38:t._moMenu.selectItem(-1),preventDefault(e);break;case 40:t._moMenu.selectItem(1),preventDefault(e);break;case 9:callBack.call(t,t._onselect,[t.getSelection()]),t.close();break;case 27:t.close(),preventDefault(e)}callBack.call(t,t._onkeydown,[e,0])},_focus:function(e,t){this._mbFocus=!0,t&&this._moInput.focus(),this._setTextDefaultValue()},_blur:function(e){var t=this;t._mbFocus=!1,setTimeout(function(){!t._mbFocus&&t.close()._setTextDefaultValue()},20)},_setTextDefaultValue:function(){var e=this;if(e._msDefaultValue){var t=e._moInput,n=t.value;if(e._mbFocus){if(n==e._msDefaultValue){var i=t.className.replace(/graytext/gi,"");"rss"==this._msType&&(i=i.replace(/textInput/gi," textInput2")),t.className=i,t.value=""}}else if(""==n){i=("rss"==this._msType?t.className.replace(/textInput2/gi," textInput"):t.className)+" graytext";t.className=i,t.value=e._msDefaultValue}}return e},_show:function(){var e=this;if(e._moData&&0!=e._moData.length){var t=calcPos(e._moPosObj);e._moMenu.setContent({oItems:e._moData}).option("nX",t[3]).option("nY",t[2])}else e.close();return e}}});function _AjaxSendMailMgr(r){r._oQuery.push("&t=mail_mgr2&resp_charset=UTF8&ef=js&sid=",getSid(),getTop().bnewwin?"&newwin=true":""),QMAjax.send(r._sUrl||"/cgi-bin/mail_mgr",{content:r._oQuery.join(""),onload:function(e,t,n){var i=0<=t.indexOf(r._sSuccessMask),o=0<=t.indexOf("cgi exception");if(e&&(i||o)){var a=evalValue(t);o?showError(filteScript(a.errmsg)):r._fOnload(a,t,n)}else r._sDefErrMsg&&showError(r._sDefErrMsg)}})}QMAutoComplete._QMAutoCompleteMenu=inheritEx("QMAutoCompleteMenu",QMPanel,function(i){return{processHtml_:function(e){return e},initMemVar_:function(e){callBack.call(this,i.initMemVar_,[e]),e.supportKey&&this._selectItemWithId(this._mnSelectItem=0)},setEvent_:function(){var i=this._moConfig,o=this,n=this.S("_menuall_"),e=this.S("_title_"),a=function(e){e=e||i.oEmbedWin.event;for(var t=getEventTarget(e);t&&t!=n&&t.parentNode!=n;)t=t.parentNode;return t};i.supportKey&&(n.onmouseover=function(e){if(500<now()-(o._mnRenderTime||0)){var t=a(e),n=parseInt(t.id.substr(o._msPanelId.length+1));isNaN(n)||o._selectItemWithId(n)}},e.onclick=function(e){e=e||i.oEmbedWin.event;callBack.call(o,i.onclick,[e,""])},n.onclick=function(e){var t=a(e),n=t.getAttribute("key");callBack.call(o,i.onclick,[e,n]),n&&(callBack.call(o,i.onselect,[n]),setClass(t,"menu_item"),"rss"!=i.type&&o.hide())}),addEvents(this._moPanelDom,{mousedown:preventDefault,touchstart:function(e){callBack.call(o,i.ontouchstart,[e])}})},dfConfig_:function(e){var t=e.oItems,n=(e.nItemHeight||21)*(e.nMaxItemView||t.length);return this.configHelp_(e,{mheight:n,nWidth:"auto",nHeight:n,nZIndex:1121}),this.configHelp_(e,{sStyle:"background:#fff"},!0),callBack.call(this,i.dfConfig_,[e])},genItemCode_:function(e){for(var t=e.oItems,n=[],i=this._moConfig,o=i&&i.oClass&&i.oClass.classnormal?i.oClass.classnormal:"menu_item",a=this._mnItemLen=0,r=t.length;a<r;a++){n.push('<div unselectable="on" style="height:',t[a].nItemHeight||e.nItemHeight,'px;" onclick=";" ');var s=t[a].sId;s||0===s?n.push('key="',a,'" id="',this._msPanelId,"_",this._mnItemLen++,'" class="',o,'" >'):n.push('class="menu_item_onfun">'),n.push(t[a].sItemValue,"</div>")}return n},insertHtml_:function(e){e.oItems;var t=['<div style="margin:0px;">','<div class="menu_base">','<div class="menu_bd bd" style="padding:0;">','<div unselectable="on" id="',this._msPanelId,'__title_" style="white-space:nowrap;width:',e.nMinWidth,"px;line-height:",e.nItemHeight,"px;",e.header?"":"display:none;",'">',e.header,"</div>",'<div unselectable="on" id="',this._msPanelId,'__menuall_" style="overflow-y:auto;height:auto;line-height:',e.nItemHeight,"px;width:"];"auto"==e.nWidth?t.push(getTop().gbIsIE?"auto":e.nMinWidth+"px"):t.push(e.nWidth-(getTop().gbIsIE?0:2),"px;overflow-x:hidden;"),t.push('">'),(t=t.concat(this.genItemCode_(e))).push("</div></div></div></div>"),e.sBodyHtml=t.join(""),callBack.call(this,i.insertHtml_,[e])},adjustSize_:function(e,t){var n=this._moConfig.nMaxItemView||this._moConfig.oItems.length,i=this._mnItemLen<=n?"auto":this._moConfig.nItemHeight*n;this.option("nHeight",i),e.style.height="auto"==i?"auto":i+"px","auto"!=this._moConfig.nWidth?e.style.width!=this._moConfig.nWidth&&(t.style.width=e.style.width=this._moConfig.nWidth-(getTop().gbIsIE?0:2)+"px"):(6<gnIEVer&&e.ownerDocument.documentElement.clientHeight&&(t.style.width=e.style.width="auto"),10<e.offsetWidth&&(t.style.width=e.style.width=Math.max(e.offsetWidth,t.offsetWidth,this._moConfig.nMinWidth)+(gbIsIE?6<gnIEVer?18:0:e.offsetWidth-e.scrollWidth)+"px"))},setHeader:function(e){e?(this.S("_title_").innerHTML=this.processHtml_(e),show(this.S("_title_"),1)):""==e&&show(this.S("_title_"),0)},setContent:function(e){var t=this,n=t.S("_menuall_"),i=t.S("_title_");return this.configHelp_(t._moConfig,e,!0),"auto"==t._moConfig.nWidth&&(i.style.width=n.style.width=gbIsIE&&7!=gnIEVer?t._moConfig.nMinWidth+"px":"auto"),t.setHeader(e.oItems.header),n.innerHTML=t.genItemCode_(e).join(""),t._moConfig.supportKey&&t.selectItem(t._mnSelectItem=0),t.show(),t.adjustSize_(n,i),callBack.call(t,t._moConfig.onload,[e]),t._mnRenderTime=now(),t},selectItem:function(e){var t=this,n=t._selectItemWithId((t._mnSelectItem+e+t._mnItemLen)%t._mnItemLen);scrollIntoMidView(n,t.S("_menuall_"))},getSelectItemId:function(){var e=this.S(this._mnSelectItem);return e&&e.getAttribute("key")},_selectItemWithId:function(e){var t=this.S(this._mnSelectItem),n=this._moConfig,i=n&&n.oClass&&n.oClass.classnormal?n.oClass.classnormal:"menu_item",o=n&&n.oClass&&n.oClass.classhigh?n.oClass.classhigh:"menu_item_high";return t&&(t.className=i),(t=this.S(e))&&(t.className=o,this._mnSelectItem=e),t}}});var QMMailList={};function BaseMailOper(e){this._init(this._moConfig=e)}QMMailList.getCBInfo=function(e,m){var h={oMail:[],oWin:e,sFid:e.location.getParams().folderid,bML:!0};return E(GelTags("input",S("list",e)),function(e){if("\u9009\u4e2d/\u53d6\u6d88\u9009\u4e2d"==e.title)h.oACB=e;else if("checkbox"==e.type&&"mailid"==e.name&&(m&&e.value==m||!m&&e.checked)){for(var t=e.value,n=e.parentNode;"TABLE"!=n.tagName.toUpperCase();)n=n.parentNode;for(var i,o=n.rows[0].cells,a=o[o.length-1],r=GelTags("input",a)[0],s=CN("fg",a,"td")[0],l=GelTags("table",a),c=[],u={},d=0,f=l.length;d<f;d++)(i=l[d].getAttribute("tagid"))&&c.push(i);u.sMid=t,u.bSys=r&&{s1bg:1}[r.className],u.bDft=r&&{drifticon:1}[r.className],u.bUnr="true"==e.getAttribute("unread"),u.bStar="fg fs1"==s.className,u.bBsm="true"==e.getAttribute("bsm"),u.bTms=1==e.getAttribute("isendtime"),u.oTagIds=c,u.sSName=e.getAttribute("fn"),u.sSEmail=e.getAttribute("fa"),u.sColId=e.getAttribute("colid");e.getAttribute("rf");u.oTable=n,u.oStar=s,u.oChk=e,h.oMail.push(u);var p=GelTags("div",a);for(d=0,f=p.length;d<f;d++)if("TagDiv"==p[d].className){u.oTCont=p[d];break}}}),h},QMMailList.selectedUI=function(s){var e=getMainWin(),l={},c=!1;if(!(e.location.href.indexOf("/cgi-bin/mail_list")<0)){for(var t=s.oMail,n=t.length-1;0<=n;n--)l[t[n].sMid]=1;s=s||this.getCBInfo(e),E(SN("mailid",e),function(e){if("checkbox"==e.type){for(var t=(e.value in l),n="true"==e.getAttribute("unread")&&4!=s.sFid,i=e;"TABLE"!=i.tagName.toUpperCase();)i=i.parentNode;""!=i.style.backgroundColor&&(i.style.backgroundColor=""),setClass(i,[n?"i F":"i M",t?" B":""].join("")),setClass(GelTags("table",i)[0],n?"i bold":"i");var o=e.getAttribute("isendtime"),a=e.getAttribute("rf"),r=0<finds(".cir",i)[0].className.indexOf("Mu");setClass(GelTags("div",i.rows[0].cells[1])[1],"cir "+((n?"Ru":"")||{0:"Rc",1:"Ti"}[o]||{r:"Rh",f:"Rz"}[a]||(n?"":"Rr"))+(r?" Mu":"")),e.checked=t,c=c||t}}),!c&&s.oACB&&(s.oACB.checked=c)}},QMMailList._singleAddrNick=function(e){for(var t=null,n=null,i=e.oMail,o=i.length-1;0<=o;o--){var a=i[o],r=a.sSName,s=a.sSEmail;n!=r&&(n=null===n?r:""),t!=s&&(t=null===t?s:"")}return[t,n]},BaseMailOper._craeteInstance=function(e){var t=BaseMailOper,n=e.oWin;return t.getInstance(n)||new t(e),t.getInstance(n)},BaseMailOper.getInstance=function(e){return e.__gBmOi_},BaseMailOper.prototype={_init:function(e){var t=e.oWin,n=t.location,i=n.href;return 0<i.indexOf("/cgi-bin/mail_list")?e._mnFolderType=0:0<i.indexOf("t=readmail_conversation")?e._mnFolderType=2:0<i.indexOf("readmail_group.html")?e._mnFolderType=3:e._mnFolderType=1,e.bAutoTag=1==n.getParams().folderid||1==e.sFolderid||e.bAutoTag,t.__gBmOi_=this},getConfig:function(){return this._moConfig},setMailInfo:function(e){this._moConfig._moSelectMailInfo=e},getMailInfo:function(){return this._moConfig._moSelectMailInfo},apply:function(e,t){var n=this._moConfig,i=n._moSelectMailInfo;n.oWin;switch(e){case"mark":case"move":case"preview":return!1;case"new":if(configPreRmMail(i,"moveMailJs"),getLeftWin().SwiTchFoLdErComM_gLoBaldATa&&getLeftWin().SwiTchFoLdErComM_gLoBaldATa.match(/folder_.*/)){i.sSelectFolderId="personal";for(var o=0;o<getTop().originUserFolderNodes.length;o++)if(getTop().originUserFolderNodes[o].id==getLeftWin().SwiTchFoLdErComM_gLoBaldATa.replace("folder_","")){i.sSelectFolderId=getLeftWin().SwiTchFoLdErComM_gLoBaldATa.replace("folder_","");break}}moveMailJs("new","",i.sFid,i);break;case"new_folderlock":showError("\u8bf7\u5148\u4e3a\u201c\u6211\u7684\u6587\u4ef6\u5939\u201d\u89e3\u9501");break;case"delmail":configPreRmMail(i,"rmMail"),rmMail(0,i);break;case"predelmail":configPreRmMail(i,"rmMail"),rmMail(1,i);break;case"frwmail":i.oWin.FwMailML();break;case"spammail":configPreRmMail(i,"spammail"),reportSpamJson({bBlackList:!0},i);break;case"read":case"unread":setMailRead("unread"==e,i);break;case"star":case"unstar":starMail("star"==e,i,"toolbar");break;case"rmalltag":QMTag.rmTag("",i);break;case"newtag":QMTag.newMailTag(i);break;case"autotag":QMTag.setMailAutoTag(i);break;case"createreceiverule":getTop().ossLog("delay","all","stat=donothing&locval=maillist,clickcreatereceiverule,,1,1"),showSimpleRuleFilter(i&&i.oMail&&i.oMail[0]&&i.oMail[0].sSEmail,"mail_list");break;case"newwintoread":for(o=0;o<i.oMail.length;o++){CN("cir",i.oMail[o].oTable,"div")[0].click()}break;default:if(/fid_(.+)/.test(e))configPreRmMail(i,"moveMailJs"),moveMailJs(RegExp.$1,t,i.sFid,i);else if(/tid_(.+)/.test(e)){var a=RegExp.$1;QMTag.setMailTag(a,i)}}return!0}};var QMTag={_msTimeStamp:"",_moTagData:{},_moTagIndex:[]};function colorTag(e,c,u){e=e||u.event,stopPropagation(e),preventDefault(e);var t="tag"+c;if(!1!==QMMenu(t,"isClose")){var d=getEventTarget(e),f=function(e){return/\bflagbg(\d+)\b/.test(e)&&RegExp.$1},p=f(d.className),n=TE(['<div class="flag_menu_item"><div id="flagbg$flagbg$" class="flagbg$flagbg$" style="$@$if($rgbcolor$)$@$background:#$rgbcolor$$@$endif$@$"></div></div>']),i=[["0","1","2","3","4"],["5","6","7","8","9"],["11","12","13","14","15"],["16","17","18","19","20"],["21","22","23","24","25"],["26","27","28","29","30"],["31","32","33","34","35"]],o={nHeight:5,sItemValue:'<div style="height:1px; overflow:hidden;"></div>'},a=[];a.push(o);for(var r=0,s=i.length;r<s;r++){for(var l=[],m=0,h=i[r].length;m<h;m++)l.push(n.replace({flagbg:i[r][m],rgbcolor:QMTag.getItem(i[r][m],"rgbcolor")||""}));a.push({nHeight:24,sItemValue:l.join("")}),1==r&&a.push(o)}a.push(o),new QMMenu({oEmbedWin:u,sId:t,nWidth:148,oItems:a,onshow:function(){},onload:function(){var n=this,e=calcPos(d),t=parseInt(n.option("nHeight")),i=e[2],o=bodyScroll(u,"clientHeight")+bodyScroll(u,"scrollTop"),a=i-t-d.clientHeight;0<a&&o<i+t&&(i=a),n.option("nX",e[3]).option("nY",i);var r=n.S("_menuall_"),s=null;function l(e){for(var t=getEventTarget(e);t&&t!=r;){if(-1<t.id.indexOf("flagbg"))return t;t=t.parentNode}return null}addEvents(r,{mousemove:function(e){var t=l(e);s&&(s.parentNode.style.borderColor="#fff"),(s=t)&&(t.parentNode.style.borderColor="#aaa")},click:function(e){var t=l(e);t&&(colorTag._apply(c,f(t.className),p,d,u),n.close())}})}})}}function readTag(e,t,n){n=100<n?n:"all",goUrlMainFrm(T("/cgi-bin/mail_list?sid=$sid$&tagid=$tagid$&folderid=$folderid$&page=0").replace({tagid:e,folderid:n,sid:getSid()}))}function setMailRead(s,e){var l=e.oMail,c=l.length,t=0,n=0,i=s?1:-1,o=["mailaction=mail_flag&flag=new&status=",s];if(!c)return showError("\u672a\u9009\u4e2d\u4efb\u4f55\u90ae\u4ef6");for(var a=0;a<c;a++){var r=l[a];if(r.bUnr!=s){if(r.oChk){r.oChk.setAttribute("unread",s?"true":"false");var u=r.oChk.getAttribute("gid");setGroupUnread(u,getGroupUnread(u)+i)}if(t++,r.bBsm&&n++,o.push("&mailid=",r.sMid),r.oTable&&!s){var d=GelTags("table",r.oTable)[0].rows[0].cells[1];"new_g"==d.className&&(d.innerHTML="")}for(var f=r.oTagIds,p=f.length,m=0;m<p;m++){var h="tag_"+f[m];setTagUnread(h,getFolderUnread(h)+i)}p&&setTagUnread("tag",getFolderUnread("tag")+i)}}if(QMMailList.selectedUI({oMail:[],oACB:e.oACB}),n&&(n*=i,setFolderUnread("bsm",getFolderUnread("bsm")+n)),t){t*=i,setFolderUnread(e.sFid,getFolderUnread(e.sFid)+t),setMailListInfo(getMailListInfo().unread+t,null);var _=e.oWin;8==e.sFid&&setGroupUnread("gall",getGroupUnread("gall")+t),_AjaxSendMailMgr({_oQuery:o,_sSuccessMask:"new successful",_sDefErrMsg:T(["\u8bbe\u7f6e",s?"\u672a\u8bfb":"\u5df2\u8bfb","\u90ae\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"]),_fOnload:function(e,t,n){for(var i=0,o=0,a=0;a<c;a++){var r=l[a];r.bUnr!=s&&r.bStar&&i++,s?o=1:QMMailCache.addData(r.sMid)}o&&QMMailCache.setExpire(),setFolderUnread("starred",getFolderUnread("starred")+(s?1:-1)*i),_.goback&&_.goback(),/folderid=(pop|personal|all)/i.test(_.location.href)&&reloadLeftWin()}})}}function starMail(o,a,e){var t=a.oMail,n=t.length,i={fg:0,"fg fs1":1,qm_ico_flagoff:2,qm_ico_flagon:3},r=["fg","fg fs1","qm_ico_flagoff","qm_ico_flagon"],s=["mailaction=mail_flag&flag=star&from_list_page="+e];if(!n)return showError("\u672a\u9009\u4e2d\u4efb\u4f55\u90ae\u4ef6");for(var l=0;l<n;l++){var c=t[l];s.push("&mailid=",c.sMid),null==o&&(o=!(1&i[c.oStar.className]))}l=0;for(var u=0;l<n;l++){var d=(c=t[l]).oStar;c.oChk&&c.oChk.setAttribute("star",o?"1":"0"),c.bStar!=o&&(u+=c.bUnr?1:0,QMMailCache.addData(c.sMid,{star:o}),rdVer(c.sMid,1)),setClass(d,r[(2&i[d.className])+(o?1:0)]),d.title=(o?"\u53d6\u6d88":"\u6807\u4e3a")+"\u661f\u6807"}u&&setFolderUnread("starred",getFolderUnread("starred")+(o?1:-1)*u),s.push("&status="+o),_AjaxSendMailMgr({_oQuery:s,_sSuccessMask:"star successful",_sDefErrMsg:(o?"\u6807\u8bb0":"\u53d6\u6d88")+"\u661f\u6807\u90ae\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){if(QMMailList.selectedUI({oMail:[],oACB:a.oACB}),!callBack(a.oncomplete,[a,o])){var i=a.oWin;i.showMailFlag&&i.showMailFlag(o)}}})}function moveMailJs(u,e,d,f){if(d==u)return showError(gsMsgMoveMailSameFldErr);for(var t=f.bML,n=f.oMail,p=n.length,m=unikey("mv"),i=[f.bML?"&location=mail_list":""],h="new"==u,o=!0,_=!1,a=QMMailList._singleAddrNick(f),r=a[1],s=a[0],l=p-1;0<=l;l--){var c=n[l],g=c.oChk;if(c.bTms)return showError("\u8bf7\u4e0d\u8981\u9009\u62e9\u5b9a\u65f6\u90ae\u4ef6\uff0c\u60a8\u4e0d\u80fd\u79fb\u52a8\u5b9a\u65f6\u90ae\u4ef6\u3002");g&&/^[@C]/.test(g.value)&&(o=!1),_=_||c.bUnr,i.push("&mailid=",c.sMid)}(o=o&&1==d&&1<p&&s&&(h||128<parseInt(u))&&!/(10000|newsletter-noreply|postmaster)@qq.com/g.test(s)&&e&&"QQ\u90ae\u4ef6\u8ba2\u9605"!=e)&&i.push("&nick=",r,"&addr=",s,"&confirm=1&srcfolderid=",d),f.oWin[m]=1;var v=function(l){!f.bIsJump&&showInfo("\u90ae\u4ef6\u79fb\u52a8\u4e2d...",-1);var c=h?"\u5df2\u5c06\u90ae\u4ef6\u6210\u529f\u79fb\u52a8":T("\u5df2\u5c06\u90ae\u4ef6\u6210\u529f\u79fb\u52a8 <a href='/cgi-bin/mail_list?sid=$sid$&folderid=$folderid$&page=0&fromindex=1' style='color:white' onclick='getTop().hiddenMsg();' target='mainFrame' >[\u67e5\u770b]</a>").replace({sid:getSid(),folderid:u});_AjaxSendMailMgr({_oQuery:i,_sSuccessMask:"mail_move successful",_sDefErrMsg:"\u79fb\u52a8\u90ae\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){var i;f.oWin[m]&&(i=callBack(f.onbeforesend,[{sucMsg:c}]));var o=callBack(f.oncomplete,[f,e]);if((!i||!o)&&e.msg&&showInfo(e.msg),h&&getTop().folderTree.addFolderNode(e.selfFolderId,e.selfFolderName,l||f.sSelectFolderId),f.oWin[m]){var a=0;if(E(SN("mailid",f.oWin),function(e){"checkbox"==e.type&&a++}),a==p&&(getTop().setFolderUnread(d,getTop().getFolderUnread(d)-p),getTop().getMainWin().location.reload()),"1"==e.selfFolderId)getTop().setFolderUnread(e.selfFolderId,p+getTop().getFolderUnread(e.selfFolderId));else if("3"==e.selfFolderId)getTop().setFolderUnread(e.selfFolderId,p+getTop().getFolderUnread(e.selfFolderId));else if(_&&!h){if(getTop().setFolderUnread(u,p+getTop().getFolderUnread(u)),"1"==S("folder_"+u+"_td",getTop()).getAttribute("level")){var r=S("personalfolders",getTop());S(u+"folders",getTop())&&(s=r.removeChild(S(u+"folders",getTop())),r.insertBefore(s,r.firstChild)),s=r.removeChild(S("folder_"+u+"_td",getTop())),r.insertBefore(s,r.firstChild)}}else if(_&&h){var s;if("1"==S("folder_"+e.selfFolderId+"_td",getTop()).getAttribute("level"))s=(r=S("personalfolders",getTop())).removeChild(S("folder_"+e.selfFolderId+"_td",getTop())),r.insertBefore(s,r.firstChild)}0<=getTop().getMainWin().location.href.indexOf("/cgi-bin/readmail?")&&!(f.bML&&f.oWin.location&&0<f.oWin.location.href.indexOf("s=search"))&&e&&e.url&&!f.bIsJump&&(getTop().getMainWin().location.href=e.url),o&&QMMailList.selectedUI({oMail:[],oACB:f.oACB})}else _&&!h&&reloadLeftWin()}})};i.push("&mailaction=",t&&!p&&h?"onlyaddfolder":"mail_move"),i.push("&destfolderid=",h?-1:u),h?promptFolder({type:0<getTop().userFolderTree.length?"folderselect":"folder",selectedId:0<getTop().userFolderTree.length?f.sSelectFolderId:-1,onreturn:function(e,t){o&&i.push("&destfolder=",e),i.push("&foldername=",e),i.push("&folderfatherid=",t),v(t)}}):p?(o&&i.push("&destfolder=",e),v()):showError("\u672a\u9009\u4e2d\u4efb\u4f55\u90ae\u4ef6")}function configPreRmMail(e,t){var n=e.oWin.location.getParams();if("search"==n.s||!e.bML||("pop"==e.sFid||"personal"==e.sFid)&&"moveMailJs"==t)return!1;var i=e,o=i.onbeforesend,a=i.oncomplete,r=!1;return"star"!=n.s&&"1"!=n.showtag||"moveMailJs"!=t?i.onbeforesend=function(e){return callBack(o,[e]),r=configPreRmMail._preRmMailUI(i,e)}:r=!0,i.oncomplete=function(e,t){return callBack(a,[e,t]),r},!0}function isInArray(e,t){for(var n=0;n<t.length;n++)if(e==t[n])return!0;return!1}function checkGrpSendSkipSelf(e,t){for(var n=getDefalutAllMail(),i=new Array,o=0,a=0;o<n.length;o++)"1"==n[o].type&&(i[a++]=n[o].email);var r=isInArray(e,i);for(o=0;r&&o<t.length;o++)isInArray(t[o],i)&&(r=!1);if(r)new(getTop().QMDialog)({sTitle:"\u786e\u8ba4",sBodyHtml:T(['<div style="padding:10px;" class="txt_left">',"<div>\u60a8\u521a\u521a\u5220\u9664\u4e86\u4e00\u5c01\u7531\u81ea\u5df1\u53d1\u51fa\u7684\u90ae\u4ef6\u3002</div><br/>","<div>\u5f53\u53d1\u4fe1\u7ed9\u5305\u542b\u81ea\u5df1\u7684\u90ae\u4ef6\u7fa4\u7ec4\u65f6\uff0c\u5982\u679c\u60a8\u4e0d\u60f3\u6536\u53d6\uff0c\u53ef\u4ee5\u5728\u201c\u8bbe\u7f6e - \u5e38\u89c4\u201d\u4e2d\u5173\u95ed\u3002</div>",'<div class="txt_right" style="padding:26px 10px 5px;">','<button id="confirm" class="wd3 btn">\u73b0\u5728\u5c31\u53bb\u8bbe\u7f6e</button>','<button id="cancel" class="wd3 btn">\u597d\uff0c\u6211\u77e5\u9053\u4e86</button',"</div>","</div>"]),onload:function(){var e=this;addEvent(e.S("confirm"),"click",function(){goUrlMainFrm(T("/cgi-bin/setting1?sid=$sid$&fun=list#sendmailopt").replace({sid:getSid()}),!1),e.close()}),addEvent(e.S("cancel"),"click",function(){e.close()})},onshow:function(){this.S("confirm").focus()},nHeight:146})}function rmMail(e,o,t){var n=o.oMail,i=n.length,a=0,r=["mailaction=mail_del",o.bML?"&location=mail_list":""],s={},l=[];if(!i)return showError(gsMsgNoMail),!1;for(var c=0;c<i;c++){var u=n[c],d=(u.sSName,u.sSEmail);if(r.push("&mailid=",u.sMid),a=u.bUnr||a,u.bUnr&&d.match(/tuan@mail-admin.qq.com|newsletter-noreply@qq.com/)){var f=u.sColId;s[f]?s[f]++:s[f]=1,5==s[f]&&l.push(f)}}if(1==e){var p=l.length,m=getTop().getSid();confirmBox({title:"\u5220\u9664\u786e\u8ba4",mode:"prompt",msg:TE(["<div>\u5f7b\u5e95\u5220\u9664\u540e\u90ae\u4ef6\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f</div>","$@$if($bUnsubscribe$)$@$",'<div style="margin:12px 0 0 0;">','<input style="vertical-align:middle; height:13px; width:13px; padding:0; margin:0 5px 0 0" id="unsubscribe" type="checkbox" name="Unsubscribe" >','<label for="unsubscribe"><span id="unsubscribe_text" style="color:#333; font-size:12px;">\u540c\u65f6\u9000\u8ba2\u9009\u4e2d\u7684\u8ba2\u9605\u90ae\u4ef6</span></label>',"</div>","$@$endif$@$"]).replace({bUnsubscribe:0<p}),onreturn:function(e){if(e){var t=this.S("unsubscribe");if(r.push("&Fun=PerDel"),t&&t.checked){for(var n="",i=0;i<p;i++)n+="&colid="+l[i];getTop().QMAjax.send(getTop().T("/cgi-bin/setting10?action=desubscribe&sid=$sid$$colidlist$").replace({sid:m,colidlist:n}),{method:"GET",onload:function(e,t){}}),o.sDelRetMsg="\u5220\u9664\u90ae\u4ef6\u5e76\u9000\u8ba2\u6210\u529f"}_doRmMail(o,r,a)}}})}else _doRmMail(o,r,a);return!0}function readmailCheckGrpSendSkipSelf(e){for(var t=e.from.addr,n=e.to,i=e.cc,o=new Array,a=0,r=0;r<n.length;r++)n[r]&&(o[a++]=n[r].addr);for(r=0;r<i.length;r++)i[r]&&(o[a++]=i[r].addr);checkGrpSendSkipSelf(t,o)}function _doRmMail(a,e,r){var s=a.sDelRetMsg||"\u5df2\u5c06\u90ae\u4ef6\u6210\u529f\u5220\u9664",t=a.sFid,l=unikey("rm");a.bPop&&getGlobalVarValue("POP_PROPOSE")&&confirmBox({title:"\u90ae\u7bb1\u529f\u80fd\u63a8\u8350",mode:"prompt",msg:T(['<div style="margin-top:8px" class="bold">\u5728$dn$\u90ae\u7bb1\u4e2d\u5220\u9664\u90ae\u4ef6\uff0c\u540c\u65f6\u4e5f\u5220\u9664\u539f\u90ae\u7bb1\u4e2d\u7684\u5bf9\u5e94\u90ae\u4ef6?</div>','<div class="addrtitle" style="margin:4px 0 0 0;">',"\u60a8\u4e5f\u53ef\u4ee5\u8fdb\u5165\u201c\u4fee\u6539\u8bbe\u7f6e\u201d\u4e2d\u8bbe\u7f6e\u3002",'<a href="http://service.exmail.qq.com/cgi-bin/help?subtype=1&&id=26&&no=326" target="_blank" >\u4e86\u89e3\u8be6\u8bf7</a>',"</div>"]).replace({dn:getDomain(!0)}),onreturn:function(e){e&&(runUrlWithSid(T("/cgi-bin/foldermgr?fun=updpop&updflag=22&folderid=$folderid$").replace({folderid:t})),showInfo("\u8bbe\u7f6e\u6210\u529f\uff01\u5e76\u5c06\u5f53\u524d\u9009\u4e2d\u90ae\u4ef6\u5220\u9664\u3002"))}}),showInfo("\u90ae\u4ef6\u5220\u9664\u4e2d...",-1),a.oWin[l]=1;var c=callBack(a.onbeforesend,[{sucMsg:s}]);_AjaxSendMailMgr({_oQuery:e,_sSuccessMask:"mail_del successful",_sDefErrMsg:"\u5220\u9664\u90ae\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){var i=e.url,o=callBack(a.oncomplete,[a,e]);(!c||!o)&&showInfo(s),!o&&a.oWin[l]&&(a.bML&&0<a.oWin.location.href.indexOf("s=search")?reloadFrmLeftMain(!1,!0):a.oWin.location.href=i),r&&reloadLeftWin()}})}function reportSpamJson(e,c){var t=c.oMail,n=t.length,i=6==c.sFid,u=[c.bML?"&location=mail_list":"","&mailaction=mail_spam&isspam=true&Fun=",3<c.sFid&&c.sFid<7?"PerDel":"Del","&srcfolderid=",c.sFid];if(!n)return showError(gsMsgNoMail),!1;for(var o,a=!1!==e.bBlackList,r={},s=0;s<n;s++)o=t[s],u.push("&mailid=",o.sMid),/(@groupmail.qq.com|10000@qq.com)/.test(o.sSEmail)&&(a=!1),"undefined"==typeof r.sender?(r.sender=o.sSEmail,r.nickname=o.sSName):r.sender!=o.sSEmail&&(r.sender="");QMMailList.selectedUI(c);var l=["\u53d1\u4ef6\u4eba"];r&&r.sender&&r.sender.indexOf(",")<0&&(l[0]=r.sender);var d=e.oAddrList,f=0;d&&(0<d[0].length&&(l[f++]=d[0]),d[1]&&(l[f++]=d[1]));var p=T(["<div>",'<input type="radio" name="reporttype" id="r$value$" value="$value$" $checked$>','<label for="r$value$">$content$</label>',"</div>"]),m=["<div class='cnfx_content'>","<form id='frm_spamtype'>","<div style='margin:3px 0 3px 3px'><b>\u8bf7\u9009\u62e9\u8981\u4e3e\u62a5\u7684\u5783\u573e\u7c7b\u578b\uff1a</b></div>",p.replace({value:i?11:8,checked:"checked",content:"\u5176\u4ed6\u90ae\u4ef6"}),p.replace({value:i?10:4,checked:"",content:"\u5e7f\u544a\u90ae\u4ef6"}),p.replace({value:i?9:1,checked:"",content:"\u6b3a\u8bc8\u90ae\u4ef6"}),a?'<div style="padding:5px 0 2px 0;">'+reportSpamJson._getRefuseText(l)+"</div>":"","<div style='margin:6px 3px 0px 3px' class='addrtitle' >\u6e29\u99a8\u63d0\u793a\uff1a\u6211\u4eec\u5c06\u4f18\u5148\u91c7\u7eb3\u51c6\u786e\u5206\u7c7b\u7684\u4e3e\u62a5\u90ae\u4ef6\u3002</div>","</form>","</div>"].join(""),h=['<a class="btn_blue" id="btn_ok" href="javascript:;">\u786e\u5b9a</a>','<a class="btn_gray" id="btn_cancel" href="javascript:;">\u53d6\u6d88</a>'].join("");return new QMDialog({sId:"reportSpam",sTitle:"\u4e3e\u62a5\u5e76\u62d2\u6536\u9009\u4e2d\u90ae\u4ef6",sBodyHtml:m,sFootHtml:h,nWidth:450,onload:function(){var l=this;addEvent(l.S("btn_ok"),"click",function(){for(var e,t=l.S("frm_spamtype").reporttype,n=l.S("frm_spamtype").refuse0,i=l.S("frm_spamtype").refuse1,o="readmail_spam",a=0,r=t.length;a<r;a++)if(t[a].checked){e=t[a].value;break}var s=n&&n.checked?["1","1"]:["0","0"];i&&(s[0]=n&&n.checked?"1":"0",s[1]=i.checked?"1":"0"),(n&&n.checked||i&&i.checked)&&(o="readmail_reject"),u.push("&s=",o,"&reporttype=",e,"&s_reject_what=",s[0]+s[1]),reportSpamJson._doReportSpam(u,o,c),l.close()}),addEvent(l.S("btn_cancel"),"click",function(){l.close()})},onshow:function(){this.S("btn_ok").focus()}}),!1}function reportNoSpamJson(e,a){var t,r="\u6210\u529f\u6807\u8bb0\u4e3a\u201c\u975e\u5783\u573e\u90ae\u4ef6\u201d",n=a.oMail,i=n.length,s=0,l=unikey("spam"),o=[a.bML?"&location=mail_list":"","&mailaction=mail_spam&isspam=false"];if(!i)return showError(gsMsgNoMail),!1;for(var c=0;c<i;c++)t=n[c],o.push("&mailid=",t.sMid),s+=t.bUnr?1:0;a.oWin[l]=1;var u=callBack(a.onbeforesend,[{sucMsg:r}]);_AjaxSendMailMgr({_oQuery:o,_sSuccessMask:"spam successful",_sDefErrMsg:"\u8bbe\u7f6e\u4e0d\u662f\u5783\u573e\u90ae\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){var i=e.url,o=callBack(a.oncomplete,[a,e]);(!u||!o)&&showInfo(r),i&&!o&&a.oWin[l]&&(a.oWin.location.href=i),s&&reloadLeftWin()}})}function initMailSelect(t,e,n,i,o,a,r){var l={sFolderid:o,bReadMode:e&&4!=o,bStarMode:e,bAutoTag:a||!1,bTagMode:n&&5!=o&&6!=o,_moMoveItem:t,bSpam:r||!1,oWin:i},s=BaseMailOper._craeteInstance(l);l=s.getConfig(),t&&E(SN("selmContainer",i),function(e){e.innerHTML||new QMSelect({oContainer:e,nWidth:80,sDefaultItemValue:"\u79fb\u52a8\u5230...",oMenu:{nWidth:"auto",nMaxWidth:180,bAutoItemView:!0,bAutoClose:!0,oItems:t},onafteropenmenu:function(e,t){var n;n=0==l._mnFolderType?QMMailList.getCBInfo(l.oWin):l.oWin.QMReadMail.getCBInfo(l.oWin),s.setMailInfo(n)},onselect:function(e){return s.apply(e.sId,e.sItemValue),!0}})}),E(SN("markContainer",i),function(e){e.innerHTML||(l.bReadMode||l.bStarMode||l.bTagMode?new QMSelect({oContainer:e,nWidth:80,sDefaultItemValue:"\u6807\u8bb0\u4e3a...",oMenu:{nWidth:"auto",nMaxWidth:180,bAutoItemView:!0,bAutoClose:!0,oItems:[]},onselect:function(e){var t=this.get("menu");return s.apply(e.sId,e.sItemValue),t.hide(),!0},onbeforeopenmenu:function(e){l._moTagItems=l.bTagMode?QMTag.get():[],e.sDefaultId="",e.oItems=function s(){var e=[],t={nHeight:10,sItemValue:'<div style="background:#CCC; height:1px; margin-top:5px; overflow:hidden;"></div>'},n=TE(['<div style="white-space:nowrap;zoom:1;">','<input type="button" class="item_square flagbg$flagbg$" style="$@$if($rgbcolor$)$@$background:#$rgbcolor$$@$endif$@$"/>','<span class="item_square_txt" title="$name$">$name$ &nbsp</span>',"</div>"]);if(l.bReadMode&&e.push({sId:"read",sItemValue:"\u5df2\u8bfb\u90ae\u4ef6"},{sId:"unread",sItemValue:"\u672a\u8bfb\u90ae\u4ef6"},t),l.bStarMode&&(e.push({sId:"star",sItemValue:"\u661f\u6807\u90ae\u4ef6"},{sId:"unstar",sItemValue:"\u53d6\u6d88\u661f\u6807"}),l.bTagMode&&e.push(t)),l.bTagMode){e.push({sId:"rmalltag",sItemValue:"\u53d6\u6d88\u6807\u7b7e"},extend({bDisSelect:!0,sId:"deltaghr"},t));for(var i=QMTag.get(),o=0,a=i.length;o<a;o++){var r=i[o];e.push({sId:"tid_"+r.id,sItemValue:n.replace(r)})}a&&e.push(t),e.push({sId:"newtag",sItemValue:"\u65b0\u5efa\u6807\u7b7e"}),l.bAutoTag&&e.push(t,{sId:"autotag",sItemValue:"\u65b0\u5efa\u81ea\u52a8\u6807\u7b7e"})}return e}()},onafteropenmenu:function(e){var t;if(0==l._mnFolderType){var n=(t=QMMailList.getCBInfo(l.oWin)).oMail.length;e.itemOption("rmalltag","bDisplay",n),e.itemOption("deltaghr","bDisplay",n)}else t=l.oWin.QMReadMail.getCBInfo(l.oWin);s.setMailInfo(t)}}):show(e,!1))})}function navRightMenu(e,t){for(var c,u,d=e.ownerDocument,i=d.defaultView||d.parentWindow,o=Scale.fixCursorPos(t.clientX,"x")+bodyScroll(i,"scrollLeft"),a=Scale.fixCursorPos(t.clientY,"y")+bodyScroll(i,"scrollTop"),f=getEventTarget(t),n={_OPEN:{sId:"open",sItemValue:"\u6253\u5f00",oUrl:T("/cgi-bin/mail_list?sid=$sid$&s=unread&folderid=personal&flag=new&page=0&stype=myfolders&topmails=0")},_HR:{nHeight:10,sItemValue:'<div style="background:#CCC; height:1px; margin-top:5px; overflow:hidden;"></div>'},_WRITE_GROUP_MAIL:{sId:"writegroupmail",sItemValue:"\u5199\u7fa4\u90ae\u4ef6"},_READ_RECORD:{sId:"readrecord",sItemValue:"\u7ffb\u9605\u6240\u6709\u8bb0\u4e8b"},_READ_NEW:{sId:"readnew",sItemValue:"\u67e5\u770b\u672a\u8bfb"},_WRITE_MESSAGE:{sId:"writemessage",sItemValue:"\u5199\u77ed\u6d88\u606f"},_CHECK_MAILING:{sId:"checkmailing",sItemValue:"\u67e5\u8be2\u6295\u9012\u72b6\u6001"},_EMPTY_DEL:{sId:"emptydel",sItemValue:"\u6e05\u7a7a\u5df2\u5220\u9664"},_MARK:{sId:"mark",sItemValue:"\u5168\u90e8\u6807\u4e3a\u5df2\u8bfb"},_CREATE_TAG:{sId:"createtag",sItemValue:"\u65b0\u5efa\u6807\u7b7e"},_SETTING:{sId:"setting",sItemValue:"\u8bbe\u7f6e"},_CREATE_REMIND:{sId:"createremind",sItemValue:"\u65b0\u5efa\u63d0\u9192"},_UPLOAD:{sId:"upload",sItemValue:"\u4e0a\u4f20\u6587\u4ef6"},_ADD_SUBSCRIPTION:{sId:"addsubscription",sItemValue:"\u6dfb\u52a0\u8ba2\u9605"},_MANAGE_GROUP_MAIL:{sId:"managegroupmail",sItemValue:"\u7fa4\u90ae\u4ef6\u7ba1\u7406"},_CHECK_UNANSWERED:{sId:"checkunanswered",sItemValue:"\u67e5\u8be2\u672a\u88ab\u56de\u590d\u72b6\u6001"},_DEL_INQUIRY:{sId:"delinquiry",sItemValue:"\u5220\u4fe1\u67e5\u8be2"},_EMPTY_TRASH:{sId:"emptytrash",sItemValue:"\u6e05\u7a7a\u5783\u573e\u7bb1"},_MANAGE_SUBSCRIPTION:{sId:"managesubscription",sItemValue:"\u8ba2\u9605\u7ba1\u7406"},_WRITE_LOG:{sId:"writelog",sItemValue:"\u5199\u8bb0\u4e8b"},_WRITE_DAILY:{sId:"writedaily",sItemValue:"\u5199\u65e5\u5fd7"},_RECIEVED_INQUIRY:{sId:"revievedinquiry",sItemValue:"\u6536\u4fe1\u67e5\u8be2"},_REPORT:{sId:"report",sItemValue:"\u4e3e\u62a5\u67e5\u8be2"},_CREATE_FOLDER:{sId:"createfolder",sItemValue:"\u65b0\u5efa\u6587\u4ef6\u5939"},_CREATE_MAILBOX:{sId:"createmailbox",sItemValue:"\u6dfb\u52a0\u5176\u4ed6\u90ae\u7bb1"},_MANAGE_FOLDER:{sId:"managefolder",sItemValue:"\u6587\u4ef6\u5939\u7ba1\u7406"},_MANAGE_MAILBOX:{sId:"managemailbox",sItemValue:"\u5176\u4ed6\u90ae\u7bb1\u7ba1\u7406"},_MANAGE_TAG:{sId:"managetag",sItemValue:"\u6807\u7b7e\u7ba1\u7406"},_RECIEVE_RECORD:{sId:"recieverecord",sItemValue:"\u6536\u53d6\u8bb0\u5f55"},_RECIEVE_POPMAIL:{sId:"recievepopmail",sItemValue:"\u6536\u53d6\u90ae\u4ef6"},_RECIEVE_ALL_POPMAIL:{sId:"recieveallpopmail",sItemValue:"\u5168\u90e8\u6536\u53d6"},_DEL_MAILBOX:{sId:"delmailbox",sItemValue:"\u5220\u9664\u6b64\u90ae\u7bb1"},_MAILBOX_SETING:{sId:"mailboxsetting",sItemValue:"\u4fee\u6539\u8bbe\u7f6e"}},r={_NORMAL_OPEN:[n._OPEN,n._HR],_GROUPMAIL:[n._WRITE_GROUP_MAIL,n._MARK,n._HR],_NOTEPAD_OPEN:[n._OPEN,n._READ_RECORD,n._HR],_MAIL_LIST:[n._READ_NEW,n._MARK,n._HR],_SENDED:[n._CHECK_MAILING,n._CHECK_UNANSWERED],_DELETED:[n._EMPTY_DEL,n._DEL_INQUIRY],_TRASH:[n._MARK,n._EMPTY_TRASH,n._HR,n._REPORT],_MAIL_SUBSCRIPTION:[n._MARK,n._MANAGE_SUBSCRIPTION],_TAG:[n._CREATE_TAG,n._MANAGE_TAG],_MYTAG:[n._CREATE_TAG,n._HR],_SETTING:[n._SETTING,n._HR],_MAILBOX_SETING:[n._MAILBOX_SETING,n._HR],_REMIND:[n._CREATE_REMIND],_ATTACH:[n._OPEN],_NOTEPAD:[n._WRITE_LOG],_UPLOAD:[n._UPLOAD],_READER:[n._ADD_SUBSCRIPTION,n._WRITE_DAILY,n._MARK,n._HR],_FOLDER_MANAGER:[n._CREATE_FOLDER,n._MANAGE_FOLDER],_MAILBOX_MANAGER:[n._CREATE_MAILBOX,n._MANAGE_MAILBOX]},s={1:{oMenu:r._NORMAL_OPEN.concat(r._MAIL_LIST).concat([n._RECIEVED_INQUIRY]),sName:"recievebox"},starred:{oMenu:[n._OPEN],sName:"starred"},9:{oMenu:r._NORMAL_OPEN.concat([n._WRITE_MESSAGE]),sName:"message"},8:{oMenu:r._NORMAL_OPEN.concat(r._GROUPMAIL).concat([n._MANAGE_GROUP_MAIL]),sName:"groupmail"},4:{oMenu:[n._OPEN],sName:"draftbox"},3:{oMenu:r._NORMAL_OPEN.concat(r._SENDED),sName:"sended"},5:{oMenu:r._NORMAL_OPEN.concat(r._DELETED),sName:"deleted"},6:{oMenu:l=r._NORMAL_OPEN.concat(r._TRASH),sName:"trashbox"},personal:{oMenu:r._NORMAL_OPEN.concat(r._MAIL_LIST).concat(r._FOLDER_MANAGER),sName:"personal"},pop:{oMenu:r._NORMAL_OPEN.concat([n._READ_NEW,n._MARK]).concat([n._RECIEVE_ALL_POPMAIL,n._HR]).concat(r._MAILBOX_MANAGER),sName:"pop"},tag:{oMenu:r._NORMAL_OPEN.concat(r._TAG),sName:"tag"},11:{oMenu:r._NORMAL_OPEN.concat(r._SETTING),sName:"plp"},note:{oMenu:r._NOTEPAD_OPEN.concat(r._NOTEPAD),sName:"note"},mydisk:{oMenu:r._NORMAL_OPEN.concat(r._UPLOAD),sName:"mydisk"},reader:{oMenu:r._NORMAL_OPEN.concat(r._READER).concat(r._SETTING),sName:"reader"},bookfolders:{oMenu:r._NORMAL_OPEN.concat(r._MAIL_SUBSCRIPTION),sName:"bookfolders"},personalfolders:{oMenu:r._NORMAL_OPEN.concat(r._MAIL_LIST).concat(r._FOLDER_MANAGER),sName:"personalfolders"},popfolders:{oMenu:r._NORMAL_OPEN.concat([n._RECIEVE_POPMAIL]).concat(r._MAIL_LIST).concat(r._MAILBOX_MANAGER),sName:"popfolders"},tagfolders:{oMenu:r._NORMAL_OPEN.concat([n._CREATE_TAG,n._HR,n._MANAGE_TAG]),sName:"tagfolders"}},p={readnew:TE('/cgi-bin/mail_list?sid=$sid$&s=unread&folderid=$menuid$&flag=new&page=0&topmails=0&stype=$@$if($menuid$=="personal")$@$myfolders$@$else if($menuid$=="pop")$@$myotherinbox$@$endif$@$'),writegroupmail:T("/cgi-bin/grouplist?t=compose_group&sid=$sid$&newwin="),managegroupmail:T("/cgi-bin/grouplist?sid=$sid$&t=setting_group&oper=list"),checkmailing:T("/cgi-bin/help_static_send?sid=$sid$"),checkunanswered:T("/cgi-bin/mail_list?sid=$sid$&folderid=3&daterange=5&collolimit=0&combinetype=and&t=help_static_unreply"),revievedinquiry:T("/cgi-bin/help_static_receive?sid=$sid$"),delinquiry:T("/cgi-bin/help_static_delete?sid=$sid$"),report:T("/cgi-bin/help_report_spam?sid=$sid$"),managesubscription:T("/cgi-bin/setting10?action=list&t=setting10&sid=$sid$"),writelog:T("/cgi-bin/cataloglist?sid=$sid$&t=note_edit_show&catid="),writedaily:T("/cgi-bin/readtemplate?sid=$sid$&t=compose&s=SendToQZone&entrance=rss"),writemessage:T("/cgi-bin/readtemplate?sid=$sid$&t=sms_list_v2&go=compose"),createremind:T("/cgi-bin/reminder_list?t=remind&sid=$sid$&sorttype=create&filter=1&fn=1&loc=folderlist,,,39&pageaction=createremind"),readrecord:T("/cgi-bin/note_list?sid=$sid$&catid=0"),createmailbox:T("/cgi-bin/foldermgr?sid=$sid$&fun=detailpop&t=pop_detail&acctid=0"),folder:TE('/cgi-bin/folderlist?t=folderlist_setting&s=null&sid=$sid$&jump=myfolders&info=true$@$if($itemid$=="managetag")$@$#mytagdiv$@$endif$@$'),mailbox:T("/cgi-bin/folderlist?t=poplist_setting&s=null&sid=$sid$"),addsubscription:T("http://r.mail.qq.com/cgi-bin/reader_main?sid=$sid$&t=r_index&source=folderlist&hash=search%3Fkeyworkd%3D"),recieverecord:T("/cgi-bin/help_static_pop?sid=$sid$&domain=$etitle$"),mailboxsetting:T("/cgi-bin/foldermgr?sid=$sid$&fun=detailpop&t=pop_detail&folderid=$menuid$&acctid=$acctid$&s=maillist"),upload:{mydisk:T("/cgi-bin/ftnList?sid=$sid$&t=exs_ftn_mydisk&listtype=mydisk&bus=6&list=0&display=list&autostart=1")},setting:{reader:T("http://r.mail.qq.com/cgi-bin/reader_main?sid=$sid$&t=r_index&source=folderlist&hash=setting/general"),11:T("/cgi-bin/bottle_panel?sid=$sid$&t=bottle&loc=folderlist,,,33&func=setting")}},l=[];"LI"!=f.tagName&&"BODY"!=f.tagName;){var m=f.id,h=f.parentNode;if(m.match(/folder_.*/)){var _;u=f.getAttribute("etitle"),l=(_=s[c=m.replace("folder_","").replace("_td","")]?s[c]:s[f.getAttribute("name")+"folders"])?_.oMenu:[],_sMenuName=_?_.sName:"",f="LI"==h.tagName?h:f,switchFolder("folder_"+c,getLeftWin());break}f=h}if(l&&0<l.length){(h=f.parentNode).id;ossLog("delay","all","stat=right&menuid="+_sMenuName);var g=new QMMenu({sId:c,oEmbedWin:i,nWidth:"auto",nMaxWidth:180,nMaxItemView:14,sClassName:"qmpanel_shadow",bAnimation:!1,bAutoClose:!0,oItems:l,onitemclick:function(e,t){var n,i="",o="",a=getTop().getMainWin().location;switch(ossLog("delay","all","stat=right&menuid="+_sMenuName+"&opr="+e),e){case"open":var r=S("folder_"+c);fireMouseEvent(r,"mousedown"),fireMouseEvent(r,"click");break;case"writemessage":r=S("folder_9");switchFolder("folder_"+c),a.href=r.href+"&go=compose";break;case"mark":if("reader"==c){var s=d.createElement("form");s.action=gsRssDomain+"/cgi-bin/reader_mgr?fun=setfeedread&type=all&sid="+getSid(),s.method="post",s.target="actionFrame",d.body.appendChild(s),s.submit(),setRssUnread(0,0),getTop().showInfo("\u9605\u8bfb\u7a7a\u95f4\u6807\u4e3a\u5df2\u8bfb\u64cd\u4f5c\u6210\u529f"),"fn"==S("folder_reader_td").className&&reloadFrm(getTop().getMainWin())}else QMAjax.send("/cgi-bin/mail_mgr?mailaction=read_all&t=unreadmail_reg_data",{method:"POST",content:T("sid=$sid$&folderid=$folderid$").replace({sid:getSid(),folderid:c}),onload:function(e,t){if(e){var n=S("folder_"+c+"_td"),i=n.parentNode;if(reloadLeftWin(),("fn"==n.className||"personalfolders"==i.id&&"fn"==S("folder_personal_td").className||"popfolders"==i.id&&"fn"==S("folder_pop_td").className)&&(reloadFrm(getTop().getMainWin()),getTop().showInfo("\u6587\u4ef6\u5939\u6807\u4e3a\u5df2\u8bfb\u64cd\u4f5c\u6210\u529f")),"personal"==c||"pop"==c)for(var o=S(c+"folders").getElementsByTagName("LI"),a=0;a<o.length;a++)if("fn"==o[a].className){reloadFrm(getTop().getMainWin()),getTop().showInfo("\u6587\u4ef6\u5939\u6807\u4e3a\u5df2\u8bfb\u64cd\u4f5c\u6210\u529f");break}}}});break;case"emptydel":case"emptytrash":var l=S("folder_"+c).nextSibling;(l="A"==l.tagName?l:l.nextSibling)&&fireMouseEvent(l,"click");break;case"createtag":QMTag.newMailTag();break;case"createfolder":moveMailJs("new","","",{bML:!0,oMail:[],oWin:[],bIsJump:!0,sSelectFolderId:f.getAttribute("dr")||"-1"});break;case"managefolder":case"managetag":n=p.folder;break;case"managemailbox":case"delmailbox":n=p.mailbox;break;case"show":case"hide":case"morefunction":break;case"upload":getTop().setUserCookie("ftAutoStart",1),getTop().ftSendStatic("1106",getUin()),n=p.upload[c];break;case"setting":n=p.setting[c];break;case"mailboxsetting":o=S("folder_"+c).getAttribute("acctid"),n=p[e];break;case"createremind":getTop().setUserCookie("ftAutoStart",1),getTop().ftSendStatic("1106",getUin());case"recieveallpopmail":getTop().recvPopAll();break;case"recievepopmail":o=S("folder_"+c).getAttribute("acctid"),getTop().recvPop(o,c,getTop().getMainWin());break;case"createmailbox":toAddAccountPage();break;default:n=p[e]}n&&(i=n.replace({sid:getSid(),menuid:c,itemid:e,etitle:u,acctid:o}),switchFolder("folder_"+c),a.href=i)},onload:function(){if(this.option("sId")==c){var e=parseInt(this.option("nHeight")),t=parseInt(this.option("nWidth")),n=calcAdjPos([a,o,a,o],t,e,i,1);this.option("nX",n[3]).option("nY",n[0])}}});if("reader"==c||f.getElementsByTagName("B").length){if("reader"==c){var v=S("folder_reader").className;v.match(/bold/)&&!v.match(/normal/)||g.itemOption("mark","bDisSelect",!0)}}else g.itemOption("readnew","bDisSelect",!0),g.itemOption("mark","bDisSelect",!0);29<S("popfolders").getElementsByTagName("A").length&&g.itemOption("createmailbox","bDisSelect",!0),f.getElementsByTagName("A").length<2&&(g.itemOption("emptydel","bDisSelect",!0),g.itemOption("emptytrash","bDisSelect",!0));var b=f.getElementsByTagName("IMG");0<b.length&&b[0].src.match(/ico_pwd/)&&(g.itemOption("readnew","bDisSelect",!0),g.itemOption("mark","bDisSelect",!0),g.itemOption("createfolder","bDisSelect",!0),g.itemOption("createmailbox","bDisSelect",!0),g.itemOption("recieverecord","bDisSelect",!0))}preventDefault(t)}function mailRightMenu(e,t){var n=e.ownerDocument,i=n.defaultView||n.parentWindow,o=t.clientX+bodyScroll(i,"scrollLeft"),a=t.clientY+bodyScroll(i,"scrollTop"),r=BaseMailOper.getInstance(i),s=GelTags("input",e)[0],l=1==s.checked;if(r){l||QMMailList.selectedUI({oMail:[]}),ossLog("delay","all","stat=right"),s.checked=!0;var c,p=r._moConfig;0==p._mnFolderType?(c=QMMailList.getCBInfo(p.oWin),QMMailList.selectedUI(c)):c=p.oWin.QMReadMail.getTag(),r.setMailInfo(c);var u=null,d=unikey(),f=new QMMenu({sId:d,oEmbedWin:i,nWidth:"auto",nMaxWidth:180,nMaxItemView:14,sClassName:"qmpanel_shadow",bAnimation:!1,bAutoClose:!0,oItems:function h(t){var e=[],n=[],i=0,o=t.oMail,a=o.length,r={nHeight:10,sItemValue:'<div style="background:#CCC; height:1px; margin-top:5px; overflow:hidden;"></div>'},s=TE(['<div style="white-space:nowrap;zoom:1;">','<input type="button" class="item_square flagbg$flagbg$" style="$@$if($rgbcolor$)$@$background:#$rgbcolor$$@$endif$@$"/>','<span class="item_square_txt">$name$ &nbsp</span>',"</div>"]);1==a&&e.push({sId:"preview",sItemValue:'<div class="right"><img src="/zh_CN/htmledition/images/spacer.gif" class="arrow_meunico" /></div>\u9884\u89c8',oSubMenu:{sClassName:"rightpre qmpanel_shadow",nWidth:450,oItems:[{nHeight:350,sItemValue:T('<div scroll="true" id="pre" style="height:350px;width:430px;overflow-x:hidden;overflow-y:auto;"><div style="*margin:100px 0 0 0;height:64px;text-align:center;width:100%;"><center><img src="$images$ico_loading2.gif"/></center></div></div>').replace({images:getPath("image")})}],onload:function(){var o=this,e=t.oMail[0].sMid;QMAjax.send(T("/cgi-bin/readmail?sid=$sid$&folderid=$f$&t=quickreadmail&mailid=$m$&mode=preview&maxage=3600&ver=$v$").replace({v:rdVer(e,0),sid:getSid(),f:t.sFid,m:e}),{method:"GET",onload:function(e,t,n){if(e){ossLog("delay","all","stat=right&opr=preview");var i=o.S("pre");i&&(i.style.lineHeight=1,i.innerHTML=filteScript(t).replace(/<style ?.*>[\s\S]*?<\/style>/gi,""),swapLink(i,"preview",i.ownerDocument))}}})}}},r),e.push({sId:"newwintoread",sItemValue:"\u65b0\u7a97\u53e3\u6253\u5f00"});for(var l=0;l<a;l++)i+=o[l].bUnr?1:0;if(5!=t.sFid&&6!=t.sFid?e.push({sId:"delmail",sItemValue:"\u5220\u9664"}):e.push({sId:"predelmail",sItemValue:"\u5f7b\u5e95\u5220\u9664"}),p.bSpam&&6!=t.sFid&&e.push({sId:"spammail",sItemValue:"\u8fd9\u662f\u5783\u573e\u90ae\u4ef6"}),e.push(r),p.bReadMode&&(i&&e.push({sId:"read",sItemValue:"\u6807\u8bb0\u4e3a\u5df2\u8bfb"}),i!=a&&e.push({sId:"unread",sItemValue:"\u6807\u8bb0\u4e3a\u672a\u8bfb"})),1==a&&1==t.sFid&&e.push({sId:"createreceiverule",sItemValue:"\u521b\u5efa\u6536\u4fe1\u89c4\u5219"}),p.bTagMode){var c=0;for(l=0;l<a;l++)if(o[l].oTagIds.length){c=!0;break}c&&n.push({sId:"rmalltag",sItemValue:"\u53d6\u6d88\u6807\u7b7e"},extend({bDisSelect:!0,sId:"deltaghr"},r));for(var u=QMTag.get(),d=(l=0,u.length);l<d;l++){var f=u[l];n.push({sId:"tid_"+f.id,sItemValue:s.replace(f)})}d&&n.push(r),n.push({sId:"newtag",sItemValue:"\u65b0\u5efa\u6807\u7b7e"}),p.bAutoTag&&n.push(r,{sId:"autotag",sItemValue:"\u65b0\u5efa\u81ea\u52a8\u6807\u7b7e"}),e.push({sId:"mark",sItemValue:'<div class="right"><img src="/zh_CN/htmledition/images/spacer.gif" class="arrow_meunico" /></div>\u6807\u7b7e',oSubMenu:{oItems:n}})}return e.push({sId:"move",sItemValue:'<div class="right"><img src="/zh_CN/htmledition/images/spacer.gif" class="arrow_meunico" /></div>\u79fb\u52a8\u5230',oSubMenu:{oItems:p._moMoveItem}}),e}(c),onitemclick:function(e,t){ossLog("delay","all","stat=right&opr="+e),r.apply(u=e,t.sItemValue)},onbeforeclose:function(){if(this._moConfig.sId==d){if(!l&&(null==u||"|spammail|new|newtag|autotag|".indexOf(u)<0))try{s.checked=!1;var e=QMMailList.getCBInfo(i);QMMailList.selectedUI(e)}catch(t){}u=null}return!0},onload:function(){if(this.option("sId")==d){var e=parseInt(this.option("nHeight")),t=parseInt(this.option("nWidth")),n=calcAdjPos([a,o,a,o],t,e,i,1);this.option("nX",n[3]).option("nY",n[0])}}});if(0==p._mnFolderType){var m=c.oMail.length;f.itemOption("rmalltag","bDisplay",m),f.itemOption("deltaghr","bDisplay",m)}}}QMTag.set=function(e,t){var n=this;if(!t||t>n._msTimeStamp){t&&(n._msTimeStamp=t),n._moTagIndex=[],n._moTagData={};for(var i=0,o=e.length;i<o;i++){var a=e[i],r=a.id;null!=r&&(n._moTagIndex.push(r),(n._moTagData[r]=a)._mnIndex=i)}}},QMTag.get=function(){for(var e=[],t=this._moTagIndex,n=0,i=t.length;n<i;n++)e.push(this._moTagData[t[n]]);return e},QMTag.setItem=function(e,t,n){var i=this._moTagData;i[e]&&(i[e][t]=n)},QMTag.getItem=function(e,t){var n=this._moTagData[e];return n&&t?n[t]:n},QMTag._disposeResponse=function(_asParam){try{var _oResult=eval(_asParam);_oResult.mailids.length--,_oResult.taglist.length--,QMTag.set(_oResult.taglist,_oResult.timestamp)}catch(e){}return _oResult},QMTag.setMailTag=function(o,a){var e=a.oMail,t=e.length,n=0,i=["mailaction=mail_tag&fun=add&tagid=",o];if(!t)return showError("\u672a\u9009\u4e2d\u4efb\u4f55\u90ae\u4ef6");for(var r=0;r<t;r++){var s=e[r],l=s.sMid;if(QMTag.addTagUI(s.oTCont,o,a.sFid,l,!a.bML)&&(n++,i.push("&mailid=",l),rdVer(l,1),QMMailCache.addData(l,{addTagId:o}),s.bUnr)){var c="tag_"+o;setTagUnread(c,getFolderUnread(c)+1),s.oTagIds.length||setTagUnread("tag",getFolderUnread("tag")+1)}}QMMailList.selectedUI({oMail:[],oACB:a.oACB}),n&&_AjaxSendMailMgr({_oQuery:i,_sSuccessMask:"mail_tag successful",_sDefErrMsg:"\u8bbe\u7f6e\u6807\u7b7e\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){QMTag._disposeResponse(t);var i=a.oWin;i.QMReadMail&&i.QMReadMail.modifyTag(o,0)}})},QMTag.newMailTag=function(l){promptFolder({type:"tag",onreturn:function(e){for(var r=l&&l.oMail,s=r&&r.length,t=["&mailaction=mail_tag&fun=add&tagname=",encodeURI(e)],n=0;n<s;n++)t.push("&mailid=",r[n].sMid);_AjaxSendMailMgr({_oQuery:t,_sSuccessMask:"mail_tag successful",_sDefErrMsg:"\u521b\u5efa\u6807\u7b7e\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){showInfo("\u6807\u7b7e\u521b\u5efa\u6210\u529f");var i=l&&l.oWin.QMReadMail;if(i)return rdVer(i.getMailId(),1),reloadFrmLeftMain(!0,!0);if(!l)return reloadFrmLeftMain(!0,!0);e=QMTag._disposeResponse(t);QMMailList.selectedUI({oMail:[],oACB:l.oACB});for(var o=0;o<s;o++){var a=r[o];QMTag.addTagUI(a.oTCont,e.newtag.id,l.sFid,a.sMid,!l.bML)}reloadFrmLeftMain(!0,!1)}})}})},QMTag._autoTagOldMail=function(_asFilterId,_abMailList){confirmBox({title:"\u6536\u4fe1\u89c4\u5219",msg:"\u5bf9\u4e8e\u6536\u4ef6\u7bb1\u4e2d\u7b26\u5408\u6761\u4ef6\u7684\u5df2\u6709\u90ae\u4ef6\uff0c\u60a8\u662f\u5426\u4e5f\u8981\u6807\u4e0a\u6b64\u6807\u7b7e\uff1f",confirmBtnTxt:"\u662f",cancelBtnTxt:"\u5426",onreturn:function(_abIsOk){_abIsOk?_AjaxSendMailMgr({_oQuery:["&fun=AutoTag&mailaction=mail_filter&filterid=",_asFilterId],_sSuccessMask:"mail_tag successful",_sDefErrMsg:"\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(_oResult,_asParam,_aoXmlObj){var _oResult=eval(_asParam);return _oResult.count&&reloadFrmLeftMain(1,1),showInfo(T(_oResult.count?"\u64cd\u4f5c\u6210\u529f\uff0c\u6807\u8bb0\u4e86$count$\u5c01\u90ae\u4ef6\u3002<a href='/cgi-bin/mail_list?sid=$sid$&folderid=all&tagid=$tagid$'  style='color:white' onclick='getTop().hiddenMsg();' target='mainFrame'>[\u67e5\u770b]</a>":"\u64cd\u4f5c\u6210\u529f\uff0c\u60a8\u6ca1\u6709\u9700\u8981\u79fb\u52a8\u6216\u6807\u8bb0\u7684\u90ae\u4ef6\u3002").replace(_oResult),3e4)}}):reloadFrmLeftMain(1,!_abMailList)}})},QMTag.setMailAutoTag=function(r){for(var s=r.oMail,o=!1,a=/[~!#\$%\^&\*\(\)=\+|\\\[\]\{\};\':\",\?\/<>]/gi,l=["&mailaction=mail_tag&Fun=AutoTag"],e=s.length-1;0<=e;e--){if(s[e].bSys)return showError("\u7cfb\u7edf\u90ae\u4ef6\u4e0d\u80fd\u65b0\u5efa\u81ea\u52a8\u6807\u7b7e");l.push("&mailid=",s[e].sMid)}confirmBox({mode:"prompt",width:597,height:242,title:"\u65b0\u5efa\u81ea\u52a8\u6807\u7b7e",msg:['<div style="_margin-top:8px;">','<div style="margin-bottom:10px;"><strong>\u5bf9\u4e8e\u53d1\u4ef6\u4eba</strong><input type="text" id="addr" style="width:300px;margin-left:60px;"/></div>','<div style="margin-bottom:10px;"><b>\u6765\u4fe1\u81ea\u52a8\u6807\u4e3a\u6807\u7b7e</b><input type="text" id="name" style="width:300px;margin-left:15px;"/></div>','<div class="graytext" style="margin-bottom:10px;">\u8be5\u53d1\u4ef6\u5730\u5740\u7684\u6765\u4fe1\uff0c\u4f1a\u81ea\u52a8\u52a0\u4e0a\u6807\u7b7e\uff0c\u4fbf\u4e8e\u60a8\u8bc6\u522b\u548c\u7ba1\u7406\u90ae\u4ef6\u3002</div>',"</div>"].join(""),onload:function(){var t=this;addEvents([t.S("addr"),t.S("name")],{keydown:function(e){13==e.keyCode&&(o=!0,t.close())}})},onshow:function(){r._moSelectMailInfo;var e=QMMailList._singleAddrNick(r),t=e[1],n=e[0];t&&n?(this.S("addr").value=n.split(",")[0],this.S("name").value=trim(htmlDecode(t).split(/[,@]/)[0].replace(a,""))+"\u7684\u6765\u4fe1"):this.S("addr").focus()},onreturn:function(e){var t=trim(this.S("addr").value),n=trim(this.S("name").value);if(e||o){if(!t)return showError("\u8bf7\u8f93\u5165\u53d1\u4ef6\u4eba\u540d\u79f0\u6216\u5730\u5740");var i=getAsiiStrLen(n);if(0==i||50<i)return showError(i?"\u6807\u7b7e\u540d\u79f0\u592a\u957f\uff0c\u8bf7\u4f7f\u7528\u5c11\u4e8e50\u4e2a\u5b57\u7b26(25\u4e2a\u6c49\u5b57)\u7684\u540d\u79f0":"\u8bf7\u8f93\u5165\u6807\u7b7e\u540d\u79f0");if(a.test(n))return showError("\u6807\u7b7e\u540d\u79f0\u4e0d\u80fd\u5305\u542b ~!#$%^&*()=+|\\[]{};':\",?/<> \u7b49\u5b57\u7b26");l.push("&sender=",encodeURI(t),"&tagname=",encodeURI(n)),_AjaxSendMailMgr({_sUrl:"/cgi-bin/setting2",_oQuery:l,_sSuccessMask:"mail_tag successful",_sDefErrMsg:"\u8bbe\u7f6e\u81ea\u52a8\u6807\u7b7e\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){showInfo("\u8bbe\u7f6e\u81ea\u52a8\u6807\u7b7e\u6210\u529f\uff0c\u901a\u8fc7\u6536\u4fe1\u89c4\u5219\uff0c\u6765\u4fe1\u5c06\u81ea\u52a8\u6807\u4e0a\u6807\u7b7e\u3002");var i=r.oWin;e=QMTag._disposeResponse(t);if(!r.bML&&i.QMReadMail)rdVer(i.QMReadMail.getMailId(),1);else{QMMailList.selectedUI({oMail:[],oACB:r.oACB});for(var o=s.length-1;0<=o;o--){var a=s[o];QMTag.addTagUI(a.oTCont,e.newtag.id,r.sFid,a.sMid,!r.bML)}}QMTag._autoTagOldMail(e.filterid,r.bML)}})}}})},QMTag.rmTag=function(e,t){var n=t.oMail,i=0,o=["&mailaction=mail_tag&fun=del"];if(!n.length)return showError("\u672a\u9009\u4e2d\u4efb\u4f55\u90ae\u4ef6");e&&o.push("&tagid=",e);for(var a=n.length-1;0<=a;a--)if(QMTag.rmTagUI(n[a].oTCont,e)){i++;var r=n[a],s=r.sMid;if(o.push("&mailid=",s),rdVer(s,1),QMMailCache.addData(s,{removeTagId:e}),r.bUnr){e&&r.oTagIds;if(e){var l="tag_"+e;setTagUnread(l,getFolderUnread(l)-1)}else E(r.oTagIds,function(e){var t="tag_"+e;setTagUnread(t,getFolderUnread(t)-1)});1!=r.oTagIds.length&&e||setTagUnread("tag",getFolderUnread("tag")-1)}}QMMailList.selectedUI({oMail:[],oACB:t.oACB}),i&&_AjaxSendMailMgr({_oQuery:o,_sSuccessMask:"mail_tag successful",_sDefErrMsg:T(["\u79fb\u9664\u6807\u7b7e\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"]),_fOnload:function(e,t,n){QMTag._disposeResponse(t)}})},QMTag.rmTagUI=function(e,t){if(!t)return!(e.innerHTML="");for(var n=GelTags("table",e),i=n.length-1;0<=i;i--)if(n[i].getAttribute("tagid")==t)return removeSelf(n[i]),!0;return!1},QMTag.addTagUI=function(e,t,n,i,o){for(var a=GelTags("table",e),r=a.length-1;0<=r;r--)if(a[r].getAttribute("tagid")==t)return!1;var s=TE(['<table cellspacing="0" cellpadding="0" border="0" class="tagleftDiv flagbg$flagbg$" tagid="$id$" style="$@$if($rgbcolor$)$@$background:#$rgbcolor$$@$endif$@$">',"<tr>",'<td class="falg_rounded">\n',"</td>",'<td colspan="2">\n',"</td>",'<td class="falg_rounded">\n',"</td>","</tr>","<tr>","<td>\n","</td>",'<td class="tagbgSpan" tid2="$id$">',"<span>\u4e2da</span>$name$<span>\u4e2da</span>",'$@$if($t$=="mail_list")$@$<div class="closeTagSideDiv flagbg$flagbg$" style="display:none;$@$if($rgbcolor$)$@$background-color:#$rgbcolor$$@$endif$@$" title="\u53d6\u6d88\u6b64\u6807\u7b7e" tid2="$id$">&nbsp;&nbsp;&nbsp;</div>$@$endif$@$',"</td>",'$@$if($t$!="mail_list")$@$<td title="\u53d6\u6d88\u6b64\u6807\u7b7e" class="closeTagDiv $disclose$" tid2="$id$">&nbsp;</td>$@$endif$@$',"<td>\n","</td>","</tr>","<tr>",'<td class="falg_rounded">\n',"</td>",'<td colspan="2">\n',"</td>",'<td class="falg_rounded">\n',"</td>","</tr>","</table>"]).replace(extend({t:o?"readmail":"mail_list",folderid:n,mailid:i||""},QMTag.getItem(t)));return insertHTML(e,"beforeEnd",s),!0},QMTag.showTagClose=function(e,t){function n(e,t){try{for(var n=GelTags("div",e),i=n.length-1;0<=i;i--)if(-1<n[i].className.indexOf("closeTagSideDiv"))return void show(n[i],t)}catch(o){}}var i=arguments.callee;i._mnTimeout&&clearTimeout(i._mnTimeout),i._moTable!=e&&n(i._moTable,0),i._moTable=e,i._mnTimeout=setTimeout(function(){n(e,t)},t?500:100)},colorTag._colorMap={0:"729c3b",1:"609022",2:"35909e",3:"3d6aaa",4:"4d53a5",5:"b48e43",6:"c26502",7:"b3341a",8:"c24d96",9:"aa41cd",10:"b20e0e",11:"e59c00",12:"ec6928",13:"9d569d",14:"955959",15:"ae7841",16:"abab4e",17:"ec5105",18:"ab4646",19:"950695",20:"703b70",21:"3b994f",22:"21b1b1",23:"1e87ef",24:"4b9d8f",25:"7c657c",26:"5487ed",27:"354b66",28:"2768ea",29:"7044b2",30:"1f28df",31:"a59f79",32:"8899ab",33:"585858",34:"343434",35:"000"},colorTag._apply=function(e,r,t,s,l){var c="\u9009\u62e9\u6807\u7b7e\u989c\u8272\u6210\u529f";if(r==t)return showInfo(c);QMAjax.send("/cgi-bin/foldermgr",{content:["&fun=setcolor&sid=",getSid(),"&tagid=",e,"&flagbg=",r].join(""),onload:function(e,t,n){var i=l.location.href,o=getMainWin().location.href;if(e&&0<t.indexOf(c))return setClass(s,s.className.replace(/\bflagbg\d+\b/i,"flagbg"+r)),colorTag._colorMap[r]&&(s.style.background="#"+colorTag._colorMap[r]),-1<i.indexOf("t=folderlist_setting")?reloadLeftWin():/cgi-bin\/(mail_list|readmail)|t=folderlist_setting/.test(o)&&reloadFrmLeftMain(!1,!0),showInfo(c);var a=getErrMsg(n,"msg_txt");showError(a||"\u6807\u7b7e\u989c\u8272\u8bbe\u7f6e\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}})},QMTag.readclose=function(e,t){for(var n,i=getEventTarget(e);i;){if(n=i.className,/closeTag(Side)?Div/.test(n))return QMTag.rmTag(i.getAttribute("tid2"),t),!0;if("tagbgSpan"==n)return readTag(i.getAttribute("tid2"),t.oWin,t.sFid),!0;i=i.parentNode}return!1},configPreRmMail._preRmMailUI=function(u,s){var d=u.oWin,l=u.oMail,c=l.length,e=S("nextpage",d),t=null,f=null,p=null,m=null,h=null,_="_pReRmMaIl_",n=0;if(E(SN("mailid",d),function(e){"checkbox"==e.type&&n++}),n==c||0==c)return!1;return d[_]=d[_]||{_oWin:d,_nCnt:0},e&&(t=[e.href.replace(/(&|\?)(loc|r|t)=.*?(&|$)/gi,"$1"),"&ef=js&resp_charset=UTF8&record=n&t=mail_list_fragment&listcount=",c,"&r=",Math.random()].join("")),function g(){for(var e=getMailListInfo(),t=0,n=0;n<c;n++){e.totle--,l[n].bStar&&e.star--,l[n].bUnr&&t++;var i=l[n].oTable.parentNode,o=i.previousSibling;if(o.tagName&&"a"==o.tagName.toLowerCase()||(o=o.previousSibling),!h){for(h=i;(h=h.nextSibling)&&"list_btline"!=h.className;);for(m=h;(m=m.previousSibling)&&"toarea"!=m.className;);}removeSelf(l[n].oTable),p=i;var a=GelTags("span",f=o)[0];if(a.innerHTML=parseInt(a.innerHTML)-1+" \u5c01",0==GelTags("table",i).length&&(removeSelf(o),removeSelf(i)),l[n].oChk&&l[n].bUnr){var r=l[n].oChk.getAttribute("gid");setGroupUnread(r,getGroupUnread(r)-1)}}u.oACB.checked=!1,setMailListInfo(4==u.sFid?null:e.unread-t,e.star,e.totle),8==u.sFid&&setGroupUnread("gall",getGroupUnread("gall")-t),c&&(s||{}).sucMsg&&showInfo(s.sucMsg),t&&setFolderUnread(u.sFid,getFolderUnread(u.sFid)-t),QMMailCache.setExpire()}(),t&&(d[_]._nCnt?d[_]._nCnt+=c:(d[_]._nCnt=c,QMAjax.send(t,{method:"GET",onload:function v(e,t){if(e){var n,i=getMainWin(),o=(t=trim(t)).substr(0,19);if(/<!--mlf\d{8}-->/.test(o)&&(n=t.split(o)).shift(),i[_]._oWin!=i||!n||!n.length)return;if(h){m==p&&(h.parentNode.insertBefore(p,h),h.parentNode.insertBefore(f,p));for(var a=0,r=Math.min(i[_]._nCnt,n.length);a<r;a++)insertHTML(m,"beforeEnd",n[a]);i[_]._nCnt=0;var s=m.previousSibling;s.tagName&&"a"==s.tagName.toLowerCase()||(s=s.previousSibling);var l=GelTags("span",s)[0];l.innerHTML=parseInt(l.innerHTML)+r+" \u5c01";var c=SN("mailid",i);for(a=c.length-1;0<=a;a--)"true"!=c[a].getAttribute("init")&&"checkbox"==c[a].type&&MLIUIEvent(c[a],d,u.sFid)}}}}))),!0},reportSpamJson._getAddrSub=function(e){var t=e.indexOf("@");if(-1<t){var n=e.substr(0,t),i=e.substr(t);return subAsiiStr(n,18,"...")+subAsiiStr(i,18,"...")}return subAsiiStr(e,36,"...")},reportSpamJson._getRefuseText=function(e){var t,n=T(['<div><input type="checkbox" name="refuse$id$" id="refuese$id$" $TCHECK$>\u5c06<label for="refuese$id$">$TVALUE$</label>\u52a0\u5165\u9ed1\u540d\u5355</div>']),i=[];for(t=0;t<e.length;t++)i.push(n.replace({id:t,TVALUE:"\u53d1\u4ef6\u4eba"!=e[t]?"&lt;"+reportSpamJson._getAddrSub(e[t])+"&gt;":e[t],TCHECK:""}));return i.join("")},reportSpamJson._doReportSpam=function(e,t,r){var s,l="\u8bbe\u4e3a\u5783\u573e\u90ae\u4ef6\u6210\u529f",c=unikey("spam"),n=r.oMail,i=!1;switch(t){case"readmail_spam":case"readmail_spam_newwin":l="\u4e3e\u62a5\u6210\u529f\uff0c\u611f\u8c22\u60a8\u5bf9\u817e\u8baf\u4f01\u4e1a\u90ae\u7bb1\u53cd\u5783\u573e\u90ae\u4ef6\u5de5\u4f5c\u7684\u652f\u6301";break;case"readmail_reject":case"readmail_reject_newwin":l="\u5df2\u5c06\u6b64\u53d1\u4ef6\u4eba\u6dfb\u52a0\u5230\u9ed1\u540d\u5355\uff0c\u5e76\u5c06\u8be5\u90ae\u4ef6\u79fb\u5165\u5783\u573e\u90ae\u4ef6\u7bb1";break;case"readmail_group":case"readmail_group_newwin":l="\u62d2\u6536\u6210\u529f\uff0c\u5c06\u4e0d\u518d\u6536\u53d6\u6b64\u8bdd\u9898\u90ae\u4ef6"}for(var o=n.length-1;0<=o;o--)i=i||n[o].bSys,n[o].bUnr?1:0;showInfo("\u90ae\u4ef6\u4e3e\u62a5\u4e2d...",-1),r.oWin[c]=1,r.bML&&!getTop().QMTip&&loadJsFileToTop(getPath("js"),[getFullResSuffix("qmtip.js")]),!i&&(s=callBack(r.onbeforesend,[{sucMsg:l}])),_AjaxSendMailMgr({_oQuery:e,_sSuccessMask:"spam successful",_sDefErrMsg:"\u4e3e\u62a5\u90ae\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5",_fOnload:function(e,t,n){var i=e.url,o=callBack(r.oncomplete,[r,e]);if((!s||!o)&&showInfo(l),i&&!o&&r.oWin[c])r.bML&&0<r.oWin.location.href.indexOf("s=search")?reloadFrmLeftMain(!1,!0):goUrl(r.oWin,i+"&r="+Math.random(),!1),!e.nodlg&&e.showReportInfo&&e.showReportInfo(e.reportCnt,e.acceptCnt,e.allCnt,e.trushCnt);else if(r.bML&&!e.nodlg&&getTop().QMTip&&r.oWin[c]){e.sid=getSid(),e.tipid=10002;var a=TE(["<p>\u60a8\u603b\u5171\u4e3e\u62a5\u4e86 $reportCnt$ \u6b21</p>","<p style='font-weight:normal;'>$@$if($acceptCnt$)$@$\u88ab\u7cfb\u7edf\u91c7\u7eb3\u4e86 $acceptCnt$ \u6b21<br/>$@$endif$@$\u4eca\u5929\u6211\u4eec\u7cfb\u7edf\u6536\u5230 $allCnt$ \u6b21\u4e3e\u62a5<br/>\u603b\u5171\u62e6\u622a\u4e86 $trushCnt$ \u5c01\u5783\u573e\u90ae\u4ef6<br/>\u611f\u8c22\u60a8\u5bf9\u817e\u8baf\u4f01\u4e1a\u90ae\u7bb1\u53cd\u5783\u573e\u5de5\u4f5c\u7684\u652f\u6301\uff01","<div style=''></div>","<div style='text-align:right;font-weight:normal;'><a onclick=\"javascript: getTop().goUrlMainFrm('/cgi-bin/help_report_spam?sid=$sid$', false);getTop().QMTip.close('', $tipid$, false, true);\" style='text-decoration:underline;'>\u4e3e\u62a5\u6570\u636e\u4e2d\u5fc3</a>&nbsp;<a href='javascript;' onclick='getTop().runUrlWithSid(\"/cgi-bin/help_report_spam?type=0&ixspaminfo=1\");getTop().QMTip.close(\"\", $tipid$, false, true);return false;' style='text-decoration:underline;'>\u4ee5\u540e\u4e0d\u518d\u63d0\u793a</a></div>"]).replace(e);QMTip.show2({bForceShow:!0,type:4,win:r.oWin,tipid:10002,domid:"gotnomail",msg:a,arrow_direction:"none",arrow_offset:0,width:400,height_offset:150,tip_offset:-300,close_fork:1})}}})},QMIme={_JS:"//ime.qq.com/fcgi-bin/getjs ",_CONF:{"ime-cfg":"lt=102"},_detect:function(e){return!!window.QQWebIME&&!!e&&QQWebIME[e]},_change:function(e){var t=S("imeIcon");t&&(setClass(t,t.getAttribute("css")+e).title=t.getAttribute(e)),setUserCookieFlag("CCSHOW",4,{on:4,off:3}[e])},_opt:function(e){return!!this._detect("set")&&(QQWebIME.set(e),this._setEvt()._change(e),!0)},_setEvt:function(){var e=this;return e._detect("event")&&!QQWebIME._setevt_&&(QQWebIME._setevt_=!0,QQWebIME.event("on",function(){e._change("on")}),QQWebIME.event("off",function(){e._change("off")})),e},ison:function(){return this._detect("get")&&QQWebIME.get("on")},load:function(e){var t=this;loadJsFile(t._JS,!0,document,function(){callBack.call(t,e,[t._opt("on")])},t._CONF)},panel:function(e,t,n){var i=S("imePanel"),o=!1!==e,a=o?3:1;return n&&this._change("off"),!o&&this.off(),show(i,o),n||getCookieFlag("CCSHOW")[4]==a||(setCookieFlag("CCSHOW",4,a),ossLog("realtime","all","loc=py,"+(o?"on":"off")+",0")),o&&!1!==t&&this[n?"load":"on"](),!!i},off:function(){return this._opt("off")},on:function(){!this._opt("on")&&(showProcess(1,0,"\u6b63\u5728\u52a0\u8f7d\u4e91\u8f93\u5165\u6cd5\u6a21\u5757...","",!1)||this.load(function(e){(e?showInfo:showError)(["\u4e91\u8f93\u5165\u6cd5",e?"\u6210\u529f\u542f\u52a8":"\u542f\u52a8\u5931\u8d25 - <a href='http://service.exmail.qq.com/cgi-bin/help?subtype=1&&id=10000&&no=1000561' target='_blank'>\u5e2e\u52a9</a>"].join(""))}))},toggle:function(){this.ison()?this.off():this.on()}};var gnQmToolLoad=(new Date).getTime()-_gnQmToolStart,QMFileAdaptor=function(t){var l=navigator.userAgent.toLowerCase(),e=navigator.appVersion.toLowerCase(),n=navigator.appName.toLowerCase(),r=-1<l.indexOf("opera"),i=-1<l.indexOf("applewebkit"),o=-1<l.indexOf("khtml")||-1<l.indexOf("konqueror")||i,m=-1<l.indexOf("compatible")&&!r||-1<l.indexOf("msie"),s=(m&&e.indexOf("tencenttraveler"),i&&-1!=e.indexOf("qqbrowser")?1:0),a=-1<l.indexOf("qplus"),c=-1!=l.indexOf("edge"),u=i&&!s&&!c&&-1<l.indexOf("chrome")&&l.indexOf("se 2.x metasr 1.0")<0&&!a,d=i&&!u&&!s,f=(m&&e.indexOf("qqbrowser"),-1!=e.indexOf("trident")),p=-1<l.indexOf("gecko")&&!o&&!m&&!c&&!f,h=(!m&&!r&&!o&&l.indexOf("mozilla"),-1<l.indexOf("windows")||-1<l.indexOf("win32")),_=(h&&(-1<l.indexOf("nt 6.0")||l.indexOf("windows vista")),h&&l.indexOf("nt 6.1"),-1<l.indexOf("macintosh")||-1<l.indexOf("mac os x")),g=/mac os x (\d+)(\.|_)(\d+)/.test(l)&&parseFloat(RegExp.$1+"."+RegExp.$3),v=(l.indexOf("linux"),l.indexOf("adobeair"),/MSIE (\d+.\d+);/i.test(l)&&parseFloat(RegExp.$1)),b=/firefox\/((\d|\.)+)/i.test(l)&&RegExp.$1,T=""+(/version\/((\d|\.)+)/i.test(l)&&RegExp.$1),y=""+(/chrome\/((\d|\.)+)/i.test(l)&&RegExp.$1),M=""+(/qqbrowser\/((\d|\.)+)/i.test(l)&&RegExp.$1);function w(){var e=arguments.callee;if(!e._moTop)try{window!=parent?e._moTop=parent.getTop?parent.getTop():parent.parent.getTop():e._moTop=window}catch(t){e._moTop=window}return e._moTop}var E=w()||window,S=E.T||E.Q.T,C=E.TE||E.Q.TE;function I(e,t){try{return(t&&(t.document||t)||document).getElementById(e)}catch(n){return null}}function F(){return+new Date}function A(e){try{e.parentNode.removeChild(e)}catch(t){}return e}function x(e,t,n){if(!e)return!1;try{if(e.insertAdjacentHTML)e.insertAdjacentHTML(t,n);else{var i=e.ownerDocument.createRange(),o=0==t.indexOf("before"),a=-1!=t.indexOf("Begin");if(o==a)i[o?"setStartBefore":"setStartAfter"](e),e.parentNode.insertBefore(i.createContextualFragment(n),a?e:e.nextSibling);else{var r=e[o?"lastChild":"firstChild"];r?(i[o?"setStartAfter":"setStartBefore"](r),e[o?"appendChild":"insertBefore"](i.createContextualFragment(n),r)):e.innerHTML=n}}return!0}catch(s){return!1}}function k(e,t){var n=e&&(e.currentStyle?e.currentStyle:e.ownerDocument.defaultView.getComputedStyle(e,null));return n&&n[t]||""}var $=function(){function o(e,t,n,i){return e&&n&&(e.addEventListener?e[i?"removeEventListener":"addEventListener"](t,n,!1):e.attachEvent?e[i?"detachEvent":"attachEvent"]("on"+t,n):e["on"+t]=i?null:n),e}return function(e,t,n,i){return e&&(e.join||e._For_E_Built)?L(e,function(e){o(e,t,n,i)}):o(e,t,n,i),e}}();function D(n,e,i){return L(e,function(e,t){$(n,t,e,i)}),n}function R(e,t,n,i){var a,r=this,s=i;function l(e){return!!a&&(clearTimeout(a),a=null,"ok"!=e&&function t(e){r.onError(s,e)}(e),!0)}if(this.method=t||"POST",this.url=e,this.async=!0,this.content="",this.timeout=n,this.onComplete=function(){},this.onError=function(){},!s)try{s=new XMLHttpRequest}catch(c){try{s=new ActiveXObject("MSXML2.XMLHTTP")}catch(c){try{s=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}}if(!s)return!1;this.abort=function(){l("abort"),s.abort()},this.send=function(e){if(!this.method||!this.url||!this.async)return!1;"object"==typeof this.url&&(this.url=this.url.replace({}));var t=this.method.toUpperCase(),n=H();if(this.abort(),"fucntion"==typeof QMDistributeDomain){var i=QMDistributeDomain(this.url,s);s=i.oXhr;i.sUrl}s.open(t,this.url+(n&&"POST"==t&&-1==((this.url.split("?")[1]||"")+"&").indexOf("&sid=")?(-1==this.url.indexOf("?")?"?sid=":"&sid=")+n:""),this.async),"POST"==t&&(s.setRequestHeader("Content-Type",document.charset),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),L(this.headers,function(e,t){s.setRequestHeader(t,e)}),s.onreadystatechange=function(){try{4==s.readyState&&(200==s.status?l("ok")&&function e(){r.onComplete(s)}():l(s.status))}catch(t){l(t.message)}},function o(e){a||(a=setTimeout(function(){r.abort()},e))}(this.timeout||15e3);try{"POST"==t?s.send(e||this.content):s.send(null)}catch(c){l(c.message)}return!0}}function P(){for(var e=arguments,t=e[0],n=1,i=e.length;n<i;n++){var o=e[n];for(var a in o)t[a]=o[a]}return t}function U(e,t){return"function"==typeof e?e.apply(this,t||[]):null}function N(e,t){if(window.Console)return U.call(this,e,t);try{return U.call(this,e,t)}catch(n){debug(n.message)}}function O(e){return[e,F(),Math.random()].join("").split(".").join("")}function L(e,t,n,i){if(e)if(null!=e.length){var o,a=e.length;o=i<0?a+i:i<a?i:a;for(var r=n||0;r<o;r++)try{if(!1===t(e[r],r,a))break}catch(s){debug([s.message,"<br>line:",s.lineNumber,"<br>file:",s.fileName,"<br>",t])}}else for(var r in e)try{if(!1===t(e[r],r))break}catch(s){debug([s.message,"<br>",t])}}function H(){return w().g_sid||(I("sid")?I("sid").value:getParams(w().location.href).sid)||QMWin.sid()}function B(){var e={images_path:"/zh_CN/htmledition/images/",js_path:"/zh_CN/htmledition/js/",js_path:"/zh_CN/htmledition/js/",css_path:"/zh_CN/htmledition/css/",style_path:"/cgi-bin/getcss?sid="+H()+"ft=",swf_path:"/zh_CN/htmledition/swf/",stationery_path:"http://res.mail.qq.com/zh_CN/",card_path:"http://res.mail.qq.com/zh_CN/",mo_path:"http://res.mail.qq.com/zh_CN/",editor_path:"/zh_CN/htmledition/qqmaileditor/",base_path:"/",skin_path:"0",swf_cdn_path:"//res.mail.qq.com/bizmail/zh_CN/htmledition/swf/"};for(var t in e)e[t]=Q(w()[t])||e[t];return e}function W(e,t){"image"==e&&(e+="s");var n=B()[e+"_path"]||"";return n&&t&&"skin"!=e&&0!=n.indexOf("http")&&(n=[location.protocol,"//",location.host,n].join("")),n}function Q(e){return(e&&e.replace?e:"").replace(/(^\s*)|(\s*$)/g,"")}function j(e,t){for(var n=t||{},i=n.win||w(),o=n.id||O("_"),a=[n.attrs],r=[],s=0,l=e&&e.length||0;s<l;s++)for(var c=e[s],u=2,d=c.length;u<d;u++)r.push(c[0],":",c[1],c[u],"|");a.push(' _file="',encodeURIComponent(r.join("")),'"'),a.push(' _header="',encodeURIComponent(n.header||""),'"'),a.push(' _body="',encodeURIComponent(n.body||""),'"'),function f(n,e,t){var i="_creAteifRAmeoNlQAd_",o=t||{},a=t.id||O(),r=I(a,n);"function"!=typeof n[i]&&(n[i]=function(e,t){N.call(t,arguments.callee[e],[n])});n[i][a]=t.onload,r?"true"==r.getAttribute("loaded")&&n[i](a,r):(x(o.obj||n.document.body,o.where||"afterBegin",C(['<iframe frameborder="0" scrolling="$scrolling$" id="$id$" name="$id$" ','$@$if($transparent$)$@$allowTransparent$@$endif$@$ class="$className$" ',"onload=\"this.setAttribute('loaded','true');$cb$('$id$',this);\" ",'src="$src$" style="$style$" $attrs$>',"</iframe>"]).replace(P({id:a,cb:i,style:"display:none;",scrolling:"no",src:e},t))),(r=I(a,n))._onload=t.onload);return r}(i,function p(e){var t=(e||w()).location,n="/zh_CN/htmledition/domain.html";return[n,"?",document.domain!=t.host?encodeURIComponent(document.domain):"",-1!=t.href.indexOf(n)?"&r="+Math.random():""].join("")}(i),P({},n,{id:o,attrs:a.join(""),onload:function(e){var t=this;N.call(t,n.onload,[e]),(0!=n.destroy||"true"==t.getAttribute("destroy"))&&i.setTimeout(function(){A(t)},100)}}))}function X(e){if(!(this._mId=e.id))throw Error(0,"config.id can't use null");if(!(this._mWin=e.win))throw Error(0,"config.win win is null");this._moConstructor=this.constructor,this._mEvent=e,this._initlize()}R.newXhr=function(e){var t=e||window;if(t.ActiveXObject)try{return new t.ActiveXObject("MSXML2.XMLHTTP")}catch(n){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}if(t.XMLHttpRequest)return new t.XMLHttpRequest;Log("gen xhr fail")},R.send=function(e,n,t){var i;if("function"==typeof QMDistributeDomain){var o,a=n||{};t?((o=QMDistributeDomain(e,t.getXhr())).bNewXhr&&t.setXhr(o.oXhr),i=t,e=o.sUrl):(o=QMDistributeDomain(e,a.xhr),i=new R("","",0,o.oXhr)),e=o.sUrl}else i=t||new R,a=n||{};i.url=e,L("method,timeout,content,headers".split(","),function(e){a[e]&&(i[e]=a[e])}),i.onComplete=function(e){N.call(e,n.onload,[!0,function o(e){if(e&&e.substring){for(var t=/\s/,n=-1,i=e.length;t.test(e.charAt(--i)););for(;t.test(e.charAt(++n)););return e.substring(n,i+1)}}(e.responseText||""),e])},i.onError=function(e,t){N.call(e,n.onload,[!1,t,e])},i.send()},getParams=function(e){var t=window.location;t._bIsAnalyse=!1,t.params={};var n={},i=e?e.substr(e.indexOf("?")+1).split("#")[0]:t.search.substr(1);return i&&L(i.split("&"),function(e){var t=e.split("=");n[t.shift()]=unescape(t.join("="))}),e||(t.params=n,t._bIsAnalyse=!0),n};var q=X,V=q.prototype;function z(e){return h&&(p&&b&&3<=b.split(".")[0]&&(0<b.split(".")[1]||8<=b.split(".")[2]||20090701<=parseInt(navigator.buildID.substr(0,8)))||u&&6<=(""+y).split(".")[0]||d&&l.indexOf("se 2.x metasr 1.0")<0||r||s&&0<z._compareVersion(M,"6.5"))||_&&e<=g&&(p&&3.6<=parseFloat(b)||u&&8<=parseFloat(y)||d&&5<=parseFloat(T)||s)}q.get=function(e,t){var n=t[this._CONST._CACHES];return n&&n[e]},q.getFlashVer=function(){var e="",t=-1,n=-1,i=-1,o=navigator.plugins;if(o&&o.length)for(var a=0,r=o.length;a<r;a++){var s=o[a];if(-1!=s.name.indexOf("Shockwave Flash")){e=s.description.split("Shockwave Flash ")[1],t=parseFloat(e),i=parseInt(e.split("r")[1]),n=parseInt(e.split("b")[1]);break}}else try{var l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(l){var c=(e=l.GetVariable("$version").split(" ")[1]).split(",");t=parseFloat(c.join(".")),i=parseInt(c[2]),n=parseInt(c[3])}}catch(u){}return{version:(isNaN(t)?-1:t)||-1,build:(isNaN(i)?-1:i)||-1,beta:(isNaN(n)?-1:n)||-1,desc:e}},q.isSupported=function(){var e=this.getFlashVer();return 10<=e.version||9==e.version&&50<e.build},q._CONST={_TIMEOUT:5e3,_CACHES:"qmFlashCaches_ASDr431gGas",_CALLBACK:"onFlashEvent_ASDr431gGas"},V.getFlash=function(){return function o(e,t){var n=t||window,i=n[e]||n.document[e];return i&&(i.length?i[0]:i)}(this._mId,this._mWin)},V.isDisabled=function(){return this._mDisabled||!1},V.disable=function(e){return this._mDisabled=0!=e,this},V.getLoadedPercent=function(n){var i=this;function o(e){try{n.call(i,e)}catch(t){}}var a=this.getFlash();if(!a)return o("notfound");var r=0;!function(){var e=arguments.callee;e._startTime||(e._startTime=F());var t=0,n=!1;try{t=a.PercentLoaded()}catch(i){n=!0}t!=r&&o(r=t),100!=t&&(F()-e._startTime>X._CONST._TIMEOUT?o(n?"noflash":"timeout"):setTimeout(e,100))}()},V.setup=function(i){var o=this;function t(e,t){try{i.call(o,e,t)}catch(n){}}this.getLoadedPercent(function(e){100==e?setTimeout(function(){try{if(!o.getFlash().setup(X._CONST._CALLBACK,o._mId))return t(!1,"setuperr")}catch(e){return t(!1,"nosetup")}t(!0)}):"number"!=typeof e&&t(!1,e)})},V._initlize=function(){var r=this._mWin,e=this._moConstructor._CONST,s=e._CACHES,t=e._CALLBACK;r[s]||(r[s]=new r.Object),r[s][this._mId]=this,r[t]||(r[t]=function(){var e=arguments[0],t=arguments[1],n=r[s][e];if(n&&"function"==typeof n._mEvent[t]){for(var i=[],o=2,a=arguments.length;o<a;o++)i.push(arguments[o]);n._mEvent[t].apply(n,i)}})},z._compareVersion=function(e,t){for(var n=e.split("."),i=n.length,o=t.split("."),a=o.length,r=0;r<i&&r<a;r++){var s=parseInt(n[r]),l=parseInt(o[r]);if(s!=l)return l<s?1:-1}return r<i?1:r<a?-1:0};var G,K={_moInfos:{path:"/activex/",cab:["TencentMailActiveX.cab","TencentMailActiveX_2.cab"],exe:"TencentMailActiveXInstall.exe",obj:[["TXGYMailActiveX.ScreenCapture","TXGYMailActiveX.UploadFilePartition","TXGYMailActiveX.Uploader","TXFTNActiveX.FTNUpload","TXGYMailActiveX.DropFile"]],available:["ScreenCapture","Uploader","FTNUpload","DropFile","UploadFilePartition"],lastVer:["1.0.1.35","1.0.1.29","1.0.1.35","1.0.0.18","1.0.0.8"],miniVer:["foxmail.com"==function ie(e){return[["foxmail.com","qq.com","biz"],["Foxmail.com","QQ","\u817e\u8baf"]][e?1:0][/,7$/.test(H())?2:-1<location.href.indexOf("foxmail.com")?0:1]}()?"1.0.0.5":"1.0.1.28","1.0.1.28","1.0.1.28","1.0.0.11","1.0.0.7"]},_moInfos_FF:{path:"/xpi/",xpi:"TencentMailPlugin.xpi",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","Uploader","FTNUpload"],name:["QQMail Plugin","","QQMail Plugin","Tencent FTN plug-in","QQMail Plugin"],type:(G="application/txftn-webkit",["application/x-tencent-qmail","","application/x-tencent-qmail","undefined"!=typeof navigator.mimeTypes&&navigator.mimeTypes[G]?G:"application/txftn","application/x-tencent-qmail"]),lastVer:["1.0.1.35","","1.0.1.35","1.0.0.3","1.0.0.0"],miniVer:["1.0.1.28","","1.0.1.28","1.0.0.1","1.0.0.0"]},_moInfos_WebKit:{path:"/crx/",crx:"TencentMailPlugin.crx",exe:"QQMailWebKitPlugin.exe",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","FTNUpload"],name:["QQMail Plugin","","QQMail Plugin","Tencent FTN plug-in",""],type:["application/x-tencent-qmail-webkit","","application/x-tencent-qmail-webkit","application/txftn-webkit",""],lastVer:["1.0.1.35","","1.0.1.35","1.0.0.3",""],miniVer:["1.0.1.28","","1.0.1.28","1.0.0.1",""]},_moInfos_WebKitForMac:{path:"/crx/",pkg:"TencentMailPluginForMac.pkg",obj:["ScreenCapture","","Uploader","FTNUpload",""],available:["ScreenCapture","Uploader"],name:["QQMailPlugin","","QQMailPlugin","Tencent FTN Plug-in",""],type:["application/x-tencent-qmail-webkit","","application/x-tencent-qmail-webkit","application/txftn",""],lastVer:["1.0.1.34","","1.0.1.34","1.0.0.3",""],miniVer:["1.0.1.34","","1.0.1.34","1.0.0.3",""]},mbAblePlugin:z(10.6),mbAbleUsePlugin:z(10.6),_mbIsChecked:!0,getTitle:function(){return m?"\u63a7\u4ef6":"\u63d2\u4ef6"},getinfo:function(){if(K.mbAblePlugin){if(h){if(m)return K._moInfos.available;if(p)return K._moInfos_FF.available;if(u||d||r||s)return K._moInfos_WebKit.available}if(_)return K._moInfos_WebKitForMac.available}return[]},installer:function(e,t){var n=this.get("whole"),i="";return/^online/.test(e)?i=n.cab||n.xpi||u&&n.crx:/^download/.test(e)&&(t&&(n="chrome"==t?this.get("whole","WebKit"):this.get("whole",t)),i=t?n.exe||n.pkg:!u&&n.exe||n.pkg,"chrome"==t&&(i=n.crx)),i&&/Abs$/.test(e)&&(i=n.path+i),i},get:function(e,t){t||(m&&(t="IE"),p&&(t="FF"),(u||d||r||s)&&(t="WebKit"),!m&&_&&(t="mac"));var n={IE:this._moInfos,FF:this._moInfos_FF,WebKit:this._moInfos_WebKit,mac:this._moInfos_WebKitForMac}[t];if(this._mbIsChecked||this._grayUpdate(),"whole"==e)return n;if("cab"!=e)return n[e];var i=Y(0),o=i?"":"_2.dll";try{o=i.GetDLLFileName()}catch(a){}return n.cab[o&&-1!=o.indexOf("_2.dll")?0:1]}};function Y(e,t){if(!m)return Z(e,!1,t);if(0<=e&&e<=4)for(var n=K.get("obj"),i=0,o=n.length;i<o;i++)try{return new ActiveXObject(n[i][e])}catch(a){}return null}function J(e){if(!K.mbAbleUsePlugin)return!1;try{navigator.plugins.refresh(!1)}catch(s){}var t=K.get("name")[e],n=K.get("type")[e],i=navigator.plugins;if(i&&t)for(var o=i.length-1;0<=o;o--)for(var a=i[o].length-1;0<=a;a--)if(-1!=i[o].name.indexOf(t)&&i[o][a].type==n){if(3!=e&&(-1<l.indexOf("vista")||/nt 6/gi.test(l))&&"application/x-tencent-qmail"==n)if(!(r=i[o].description.split("#")[1]))continue;var r=/(\d+(?:\.\d+)+)/.test(i[o].description||"")?RegExp.$1:"1.0.0.0";if(_&&3!=e&&"1.0.0.0"==r)continue;return!0}return!1}function Z(e,t,n,i){var o=null;switch(n=n||window,e){case 0:case 2:case 4:d&&Z._createQQMailPlugin(e,n,i),o=Z._createQQMailPlugin(e,w(),i);break;case 3:o=function a(e,t){if(!J(3))return null;Z._createFTNPlugin(e,t);var n=Z._createFTNPlugin(w(),t);t&&ne("delay","all",S(["stat=ff_addon","&type=%type%&info=%info%"],"%").replace({type:n&&n.Version?"successcreatePlugin":"failcreatePlugin",info:["ver:",b,",pluginId:3,insId:",t].join("")}));return n.Version?n:null}(n,i)}return!t&&J(e)&&ne("delay","all",S(["stat=ff_addon","&type=%type%&info=%info%"],"%").replace({type:o?"successcreatePlugin":"failcreatePlugin",info:["ver:",b,",pluginId:",e,",brtpe:",p?1:u?2:d?3:r?4:5].join("")})),o}function ee(e){var t,n="";try{n=(t="number"==typeof e?Z(e,!0):e)&&t.Version||""}catch(i){}return n}Z._createQQMailPlugin=function(e,t,n){var i,o=null,a=p?"application/x-tencent-qmail":"application/x-tencent-qmail-webkit";if(t=t||w(),J(e)){var r=n||"QQMailFFPluginIns";(i=I(r,t))||(x(t.document.body,"beforeEnd",S('<embed id="$id$" type="$type$" hidden="true"></embed>').replace({type:a,id:r})),i=I(r,t));var s={0:"CreateScreenCapture",2:"CreateUploader",4:"CreateDragDropManager"}[e];"undefined"!=typeof i[s]&&(o=i[s](),0==e?o.OnCaptureFinished=function(){}:2==e&&(o.OnEvent=function(){}))}return o},Z._createFTNPlugin=function(e,t){var n=null,i=K.get("whole").type[3],o=t||"npftnPlugin";return(n=I(o,e=e||w()))||(x(e.document.body,"beforeEnd",S('<embed id="$id$" type="$type$" style="z-index:99999;position:absolute;top:0;left:0;width:1px;height:1px;"></embed>').replace({type:i,id:o})),(n=I(o,e))&&(n.onEvent=function(){})),n};var te={};function ne(){return te._ossLog.apply(te,arguments)}return te._ossLog=function(e,t,n,i){var o=this,a=e||"realtime",r=o._pasteLog(n),s=o._oLogList||(o._oLogList=[]),l="number"==typeof t?t:{all:1}[t||"all"]||.1;"realtime"==a?o._isSample(l)&&o._doReport(r):(o._isSample(l)&&s.push(["delayurl","=",encodeURIComponent(r)].join("")),1e3<=s.length?o._doReport():!o._nTimer&&0<s.length&&(o._nTimer=setTimeout(o._doReport,5e3)))},te._doReport=function(e){var t=ne,n=t._oLogList||(t._oLogList=[]);(e||0<n.length)&&(R.send("/cgi-bin/getinvestigate",{method:"POST",timeout:500,content:S("sid=$sid$&$rl$&$ls$").replace({sid:H(),rl:e,ls:n.join("&")})}),n.length=0,t._nTimer&&clearTimeout(t._nTimer),t._nTimer=null)},te._isSample=function(e){return(this._nTimeStamp||(this._nTimeStamp=F()))%100<100*e},te._pasteLog=function(e){var n=[];return"string"==typeof e?n.push("&",e):L(e,function(e,t){n.push("&",t,"=",encodeURIComponent(e))}),n.shift()&&n.join("")},{isBrowser:function(e){return{ie:m,trident:!/Trident\/[67]\./.test(l),safari:d,chrome:u,edge:c,firefox:p}[e]},browserVer:function(){return v},getDomWin:function(e){var t=e.ownerDocument;return t.parentWindow||t.defaultView},isSystem:function(e){return{win:h,mac:_}[e]},S:I,C:function(e){return document.createElement(e)},$:function(e,t){return(t||document).getElementsByTagName(e)},removeSelf:A,attr:function oe(e,t,n){return e&&e.nodeType&&3!==e.nodeType&&8!==e.nodeType?n===undefined?e.getAttribute(t):(e.setAttribute(t,n),e):undefined},insertHTML:x,bodyScroll:function ae(e,t,n){var i=(e||window).document||e,o=i.body,a=i.documentElement;if("number"!=typeof n)return"scrollTop"==t&&"undefined"!=typeof e.pageYOffset?e.pageYOffset:a[t]||o[t];o[t]=a[t]=n},contain:function re(e,t){try{if(!e||!t)return!1;if(e.contains)return e.contains(t);if(e.compareDocumentPosition){var n=e.compareDocumentPosition(t);return 20==n||0==n}}catch(i){}return!1},show:function se(e,t,n){var i="string"==typeof e?I(e,n):e;return i&&(i.style.display=t?"":"none"),i},isShow:function le(e,t){return"none"!=(k("string"==typeof e?I(e,t):e,"display")||"none")},getStyle:k,hasClass:function ce(e,t){return e&&-1<(" "+e.className+" ").indexOf(" "+t+" ")},addClass:function ue(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")<0&&(e.className+=e.className?" "+t:t),e},setClass:function de(e,t){return e&&void 0!==t&&e.className!=t&&(e.className=t),e},rmClass:function fe(e,t){if(e)if(t){var n=" "+e.className+" ";n=n.replace(" "+t+" "," "),e.className=Q(n)}else e.className="";return e},addEvent:$,addEvents:D,delEvent:function pe(e,t,n){return $(e,t,n,!0)},target:function me(e){return e&&(e.srcElement||e.target)},stopPropagation:function he(e){return e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0),e},preventDefault:function _e(e){return e&&(e.preventDefault?e.preventDefault():e.returnValue=!1),e},QMAjax:R,get:function(e,t){"function"==typeof t?R.send(e,{method:"GET",onload:t}):R.send(e,{method:"GET",timeout:t.nTimeout,onload:t.oncomplete},t.bGlobal&&(_oGlobalQMAjax||(_oGlobalQMAjax=new R)))},getSid:H,createActiveX:Y,getUin:function ge(){return w().g_uin||QMWin.uin()},createBlankIframe:function ve(e,t){j(t&&0==t.defcss?[]:[["css","",function n(e){return S(e).replace(B(),!0)}("$css_path$comm.css")],["css",W("style"),"skin"]],P({className:"menu_base_if",transparent:!1,destroy:!1},t,{win:e,header:["<script>",w.toString().replace(/[\r\n]/g,""),"<\/script>",t&&t.header||""].join(""),onload:function(e){"true"!=this.getAttribute("cbi_inited")&&(t&&t.transparent&&(this.contentWindow.document.body.style.background="transparent"),this.setAttribute("cbi_inited","true")),N.call(this,t&&t.onload,[e])}}))},getCookie:function be(e){if(new RegExp(["(^|;|\\s+)",function t(e){return e.replace(/([\^\.\[\$\(\)\|\*\+\?\{\\])/gi,"\\$1")}(e),"=([^;]*);?"].join("")).test(document.cookie))try{return decodeURIComponent(RegExp.$2)}catch(n){return RegExp.$2}},unikey:O,generateFlashCode:function Te(e,t,n,i){var o=[],a=[],r=[],s=i||{},l=S(" $name$=$value$ "),c=S('<param name="$name$" value="$value$" />'),u=S(m?['<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ',"$codebase$ ","$attr$ $id$ >","$param$",'<embed $embed$ type="application/x-shockwave-flash" ',"$pluginspage$ "," $name$ ></embed>","</object>"]:['<embed $embed$ type="application/x-shockwave-flash" ',"$pluginspage$ "," $name$ $id$ ></embed>"]);function d(e,t){return{name:e,value:t}}for(var f in s.allowScriptAccess="always",s.quality="high",s){var p=d(f,s[f]);a.push(c.replace(p)),r.push(l.replace(p))}for(var f in n)p=d(f,n[f]),o.push(l.replace(p)),r.push(l.replace(p));return t&&(a.push(c.replace(d("movie",t))),r.push(l.replace(d("src",t)))),u.replace({id:e&&[' id="',e,'"'].join(""),name:e&&[' name="',e,'"'].join(""),attr:o.join(""),param:a.join(""),embed:r.join(""),codebase:"https:"==location.protocol?"":'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" ',pluginspage:"https:"==location.protocol?"":'pluginspage="http://www.adobe.com/cn/products/flashplayer" '})},detectActiveX:function ye(e,t,n,i){if(!m)return function l(e,t,n,i){var o=!1,a=n||Z(e,!0,null,i),r=ee(a);return a&&r&&(1!=t&&2!=t?o=!0:parseInt(ee(a).split(".").join(""))>=parseInt(K.get(1==t?"miniVer":"lastVer")[e].split(".").join(""))&&(o=!0)),o}(e,t,n,i);var o=void 0===n,a=!1,r=o?Y(e):n,s=function c(e){if(!m)return ee(e);var t,n="";try{t="number"==typeof e?Y(e):e,n=t&&(t.version?t.version:"1.0.0.8")||""}catch(i){}return n}(r);return r&&s&&(1!=t&&2!=t?a=!0:0<=z._compareVersion(s,K.get(1==t?"miniVer":"lastVer")[e])&&(a=!0),o&&(delete r,r=null)),a},qmFlash:X,getParams:getParams,getPath:W,E:L,trim:Q,T:S,TE:C,callBack:N,extend:P,htmlEncode:function Me(e){return e&&e.replace?e.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;"):e},htmlDecode:function we(e){return e&&e.replace?e.replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'"):e},ossLog:ne,LogKvEx:function Ee(e){var t=w().extend({type:"session_statistics"},e);return!(!t.businame||!t.item)&&!!("session_statistics"!=t.type&&"session_str_statistics"!=t.type||t.sid)&&void((new Image).src="/cgi-bin/sellonlinestatic?type="+t.type+"&businame="+t.businame+"&item="+t.item+"&r="+Math.random()+(t.sid?"&sid="+t.sid:""))},evalValue:function(e){var t=w();return t.evalValue?t.evalValue(e):QMWin.evalVal(e)},funcProxy:function(e,t){return function(){t.apply(e,arguments)}},speedNow:function Se(){return+new Date},getSafariVer:function Ce(){return T},getNormalUploadCom:function Ie(){var e=w()||window;return e&&e.goExpers&&e.goExpers.localUpload?"RawLocal":this.h5cDetectForNormal()?"H5CPopupMail":!this.qmFlash||!this.qmFlash.isSupported()||e.goExpers&&e.goExpers.dropFlash?"NoFlash":"FlashPopupFMail"},useNewNormalUploadCom:function Fe(){var e=this.getNormalUploadCom();return"H5CPopupMail"==e||"FlashPopupFMail"==e},html5DetectForNormal:function Ae(){var e=window.document.createElement("input");return e.type="file","multiple"in e&&window.File!=t&&window.XMLHttpRequest!=t&&(new XMLHttpRequest).upload!=t},h5cDetectForNormal:function xe(e,t){var n=this,i=w()||window;return"function"==typeof Array.prototype.every&&(!n.isBrowser("firefox")||n.isBrowser("firefox")&&50<parseFloat(n.gsFFVer))&&(i.goExpers&&i.goExpers.h5cJsUpload||function o(){return!!(E.location&&E.location.pathname&&-1<E.location.pathname.indexOf("bizmail"))}())&&n.html5DetectForNormal()&&("bigAttach"==t||"bigAttach"!=t&&!(i.goExpers&&i.goExpers.localUpload))&&(!n.isBrowser("ie")||!!window.MSInputMethodContext&&!!document.documentMode&&i.goExpers&&i.goExpers.ie11h5cUpload)&&"Promise|FileReader|DataView|ArrayBuffer|Uint8Array|URL|Blob".split("|").every(function(e){return e in window})},gsFFVer:b,getMigrateFlag:function(e){return e=e||"",w()[e]}}}();function qmtool_js(){}!function(l,t){var r,e={},n=window;r=e.components={};var i=[location.protocol,"//",location.hostname,"/cgi-bin/upload"].join("");-1<location.pathname.indexOf("/cgi-bin/bizmail")&&(i=[location.protocol,"//",location.hostname,"/cgi-bin/bizmail_upload"].join(""));var o=function(){};function a(){var e=n.document.createElement("input");return e.type="file","multiple"in e&&n.File!=t&&n.XMLHttpRequest!=t&&(new XMLHttpRequest).upload!=t}function s(){var e;return((e="function"==typeof getTop?getTop():{goExpers:{h5cJsUpload:!0}}).goExpers&&e.goExpers.entDiskNewLogic||"entdisk"!==e.ftnApp&&"favor"!==e.ftnApp)&&!(e.goExpers&&e.goExpers.localUpload)&&"function"==typeof Array.prototype.every&&e.goExpers&&e.goExpers.h5cJsUpload&&(!e.gbIsFF||e.gbIsFF&&50<parseFloat(e.gsFFVer))&&(!e.gbIsIE||!!window.MSInputMethodContext&&!!document.documentMode&&e.goExpers&&e.goExpers.ie11h5cUpload)&&a()&&"Promise|FileReader|DataView|ArrayBuffer|Uint8Array|URL|Blob".split("|").every(function(e){return e in window})}function c(){var e;return(e="function"==typeof getTop?getTop():{goExpers:{wasmJsUpload:!0}}).goExpers&&e.goExpers.wasmJsUpload&&"entdisk"!==e.ftnApp&&s()&&"object"==typeof WebAssembly&&[WebAssembly.compile,WebAssembly.instantiate,WebAssembly.Memory].every(function(e){return"function"==typeof e})}var u=function(){};u.prototype={create:function(e,t,n){var i=this._getService(e,n),o=r[i];if(debug("original logic, uploader implement:"+i),t.sType=e,o)return/Flash/.test(i)&&!/FlashH5/.test(i)&&new r.RawinputPopup(t),new o(t)},orders:{base:["base"],popup:["WasmH5CPopupMail","H5CPopupMail","RawinputPopupMail","RawinputPopup"],drag:["H5CDragFMail","Html5Drag","ActivexDrag"],paste:["ActivexPaste"]},detects:{base:function(){return!0},RawinputPopupMail:function(){return!0},RawinputPopup:function(){return"entdisk"==getTop().ftnApp?!(getTop().goExpers&&getTop().goExpers.entDiskNewLogic):!getTop().ftnApp||!(getTop().goExpers&&getTop().goExpers.ftnNewLogic)},ActivexPopup:function(){return l.isBrowser("ie")&&l.detectActiveX(2)},FlashPopup:function(){return l.qmFlash&&l.qmFlash.isSupported()&&!(getTop().goExpers&&getTop().goExpers.dropFlash)},FlashH5PopupMail:function(){return!l.isBrowser("ie")&&a},FlashPopupFMail:function(){return l.qmFlash&&l.qmFlash.isSupported()},Html5Popup:a,WasmH5CPopupMail:c,H5CPopupMail:function(e,t){return l.h5cDetectForNormal(e,t)},Ftn:function(){return l.detectActiveX(3,1)},ActivexDrag:function(){return l.detectActiveX(4,1)},H5CDragFMail:function(){return s()},Html5Drag:a,FlashH5DragMailCROS:function(){return a()&&window.location.host.match(/exmail\.qq\.com$/)&&!("https:"==location.protocol)&&10!=l.browserVer&&!(getTop().goExpers&&getTop().goExpers.dropFlash)},Html5DragCROS:function(){return a()&&window.location.host.match(/exmail\.qq\.com$/)&&!("https:"==location.protocol)&&10!=l.browserVer},H5CDragFMailCROS:function(){return s()&&10!=l.browserVer},ActivexPaste:function(){return l.detectActiveX(2)}},_getService:function(e,t){var n=this.orders[e];if(n)for(var i in n){var o=this.detects[n[i]];if(o&&o(e,t))return n[i]}return null}};var d=new u;e.qmCreater=u,e.oCreater=d;var f=function(){};f.prototype={create:function(e,t){var n=this._getService(e),i=r[n];if(debug("FTN logic, uploader implement:"+n),t.sType=e,i)return/Flash/.test(n)&&new r.RawinputPopup(t),new i(t)},orders:{base:["base"],popup:["H5CPopupMail","Html5Popup","ActivexPopup","RawinputPopupMail","RawinputPopup"],popupflash:["FlashPopup","RawinputPopup"],drag:["H5CDragFMail","Html5Drag","ActivexDrag"],paste:["ActivexPaste"]},detects:{base:function(){return!0},RawinputPopupMail:function(){return!0},RawinputPopup:function(){return"entdisk"==getTop().ftnApp?!(getTop().goExpers&&getTop().goExpers.entDiskNewLogic):!getTop().ftnApp||!(getTop().goExpers&&getTop().goExpers.ftnNewLogic)},ActivexPopup:function(){return l.isBrowser("ie")&&l.detectActiveX(2)},WasmH5CPopupMail:c,H5CPopupMail:function(){return l.h5cDetectForNormal()},FlashPopupFMail:function(){return l.qmFlash&&l.qmFlash.isSupported()&&!(getTop().goExpers&&getTop().goExpers.dropFlash)},FlashPopup:function(){return l.qmFlash&&l.qmFlash.isSupported()&&!(getTop().goExpers&&getTop().goExpers.dropFlash)},H5CDragFMail:function(){return s()},Html5Popup:a,Ftn:function(){return l.detectActiveX(3,1)},ActivexDrag:function(){return l.detectActiveX(4,1)},Html5Drag:a,ActivexPaste:function(){return l.detectActiveX(2)}},_getService:function(e){var t=this.orders[e];if(t)for(var n in t){var i=this.detects[t[n]];if(i&&i(e))return t[n]}return null}};var p=new f;e.multiCreater=f,e.create=function(e,t){return d.create(e,t)},e.createForFTN=function(e,t){return l.useNewNormalUploadCom&&"function"==typeof l.useNewNormalUploadCom&&l.useNewNormalUploadCom()?(debug("default domain, flash support"),p.create(e,t)):(debug("custom domain or flash unsupport"),d.create(e,t))},e.createCom=function(e,t,n){var i=r[n],o=i&&new i||{},a=function(){0<arguments.length&&(this.name=e,(this.init_||this.init).apply(this,arguments))};a.prototype=o,l.extend(a.prototype,"function"==typeof t?t(i.prototype):t),r[e]=a};var m=function(e){this._moInfo={},this.set(e)};m.prototype={set:function(e,t){if(e)return"object"==typeof e?l.extend(this._moInfo,e):this._moInfo[e]=t,this},get:function(e){return e?this._moInfo[e]:this._moInfo},errInfo:function(){this.oUploader.errInfo(this._moInfo.sError)},upload:function(){this.oUploader.upload(this)},destroy:function(){this.oUploader.rmFile(this)},cancel:function(){this.oUploader.cancel(this)},uploader:function(){return this.oUploader}};var h=function(e){m.call(this,e)};(h.prototype=new m({})).uploadToFtn=function(){return this.oUploader.uploadToFtn(this)},e.qmFile=m,e.oUtil={isFileDragOver:function(e){var t=e.dataTransfer.types,n=!1;return null===t||(l.E(t,function(e){if("Files"==e)return n=!0}),n)},cfg2Url:function(e){var t=e.sUrl,n=[],i=e.oQueryData;return l.E(i,function(e,t){n.push([t,encodeURIComponent(e||"")].join("="))}),[t,n.join("&")].join(0<t.indexOf("?")?"&":"?")}},e.createCom("base",{init:function(e){var t=this;"function"==typeof e&&(e=e.call(t,t.name)),t._moFiles={},e.sUrl=e.sUrl||i,e.sFile=e.sFile||"UploadFile",e.oQueryData=e.oQueryData||{},e.oBodyData=e.oBodyData||{},t.oCfg=e,t.initCallBack(e)},initCallBack:function(e){this._moCallBacks=l.extend(this._moCallBacks||{},e.oMgr&&e.oMgr.oCfg||e||{})},qmFile:m,qmFtnFile:h,nConcurrent:1,callBack:function(e,t){var n=this.oCfg;(this._moCallBacks[e]||o).apply(n.oMgr||this,t)},setKeepAlive:function(e){var r=this;if(e){if(r._mnKeepAlive)return;r._mnKeepAlive=setInterval(function(){l.QMAjax.send("/cgi-bin/readtemplate?t=keep_alive&ef=js&sid="+l.getSid(),{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t,n){if(-1!=t.indexOf("\x3c!--cgi exception--\x3e")&&-1!=t.indexOf('errcode : "-2"')){var i=r.getFile();for(var o in i){var a=i[o];"uploading"==a.get("sStatus")&&(a.fCancel&&a.fCancel(),r.onerror(a))}}}})},9e5)}else clearInterval(r._mnKeepAlive),r._mnKeepAlive=null},getUploadingCnt:function(){var e=0,t=this.getFile();for(var n in t)"uploading"==t[n].get("sStatus")&&(e+=1);return e},checkClearAlive:function(){var e=this;setTimeout(function(){e.getUploadingCnt()&&e.setKeepAlive(!1)},2e3)},isBusy:function(){return this.getUploadingCnt()>=this.nConcurrent},cancel:function(e){"uploading"==e.get("sStatus")?(e.set("sStatus","cancel"),this.calcUsedTime(e),this.ossLog(e),e.fCancel&&e.fCancel()):"ready"==e.get("sStatus")&&e.set("sStatus","cancel"),clearInterval(e._nWaitProcess),clearTimeout(e._nTimer),this.rmFile(e)},onselect:function(e){this.callBack("onselect",[e])},calcSpeed:function(e){var t=(new Date).valueOf();if(e.get("nSize")){if(!e._nLastProcssTime)return e._nLastProcessPercent=e.get("nUploadPercent"),void(e._nLastProcssTime=t);if(1e3<t-e._nLastProcssTime){var n=e.get("nSize")*(e.get("nUploadPercent")-e._nLastProcessPercent)/100/(t-e._nLastProcssTime),i=e.get("nSize")*(100-e.get("nUploadPercent"))/100/n;0<n&&e.set({nSpeed:(n/1024*1e3).toFixed(2),nRemainTime:(i/1e3).toFixed(2)}),e._nLastProcessPercent=e.get("nUploadPercent"),e._nLastProcssTime=t}}},onprocess:function(e){var t=this;100<=e.get("nUploadPercent")&&80<=e.get("nPercent")||(t.calcSpeed(e),e.set({sStatus:"uploading",sUploadStep:"posting",nPercent:.8*e.get("nUploadPercent")}),t.callBack("onprocess",[e]),100==e.get("nUploadPercent")&&(e._nWaitProcess=setInterval(function(){99<=e.get("nPercent")?clearInterval(e._nWaitProcess):t.callBack("onprocess",[e.set({nPercent:e.get("nPercent")+1,sUploadStep:"waiting"})])},100)))},oncomplete:function(e){var t=this;if("uploading"==e.get("sStatus")){var n=e.get("sStatus");e.set("sStatus","complete"),t.calcUsedTime(e),t.ossLog(e),e.set("sStatus",n),t.rmFile(e),clearTimeout(e._nTimer),e._nTimer=setTimeout(function(){clearInterval(e._nWaitProcess),e.set("sStatus","complete"),e&&e.get()&&t.callBack("oncomplete",[e]),t.checkClearAlive()},Math.max(1600-(new Date).valueOf()+e.get("nUpTime"),0))}},onerror:function(e){var t=this;if(/(uploading)|(ready)|(stopped)/.test(e.get("sStatus"))){var n=e.get("sStatus");e.set("sStatus","error"),t.calcUsedTime(e),t.ossLog(e),e.set("sStatus",n),clearTimeout(e._nTimer),e._nTimer=setTimeout(function(){clearInterval(e._nWaitProcess),e.set("sStatus","error"),e&&e.get()&&t.callBack("onerror",[e]),t.checkClearAlive()},Math.max(1600-(new Date).valueOf()+e.get("nUpTime"),0))}},calcUsedTime:function(e){e.get("nUpTime")&&e.set("nUsedTime",(new Date).valueOf()-e.get("nUpTime"))},cfg:function(e){return l.extend({},this.oCfg,e&&e.oCfg)},upload:function(e){},prepareUpload_:function(e){return this.getFile(e.get("sId"))||this.addFile(e),!this.isBusy()},getFile:function(e){return arguments.length?this._moFiles[e]:this._moFiles},rmFile:function(e){delete this._moFiles[e.get("sId")]},addFile:function(e){var t,n=this;return e instanceof n.qmFile?t=e:(e.sId=e.sId||l.unikey(),e.nTry=0,e.sType=n.name,(t="Html5Popup"==n.name||"H5CPopupMail"==n.name||"H5CDragFMailCROS"==n.name?new n.qmFtnFile(e):new n.qmFile(e)).oUploader=n),t.set("sStatus","ready"),n._moFiles[t.get("sId")]=t}}),e.createCom("baseToFtn",function(s){return{qmFile:h,oncomplete:function(a){var r=this;a.get("bFtnFile")?l.QMAjax.send(l.T("/cgi-bin/ftnGetURL?sid=$sid$&t=ftn.json&s=part&fid=$fid$&ef=js").replace({sid:l.getSid(),fid:a.get("sFileId")}),{onload:function(e,t,n){if(e){var i,o=l.evalValue(t);if("0"==o.errcode){if(o.oFile&&o.oFile.sKey&&o.oFile.sFetchCode)return a.set(o.oFile).set({sDownloadPage:["http://mail.qq.com/cgi-bin/ftnExs_download?t=exs_ftn_download&k=",o.oFile.sKey,"&code=",o.oFile.sFetchCode].join("")}),l.LogKvEx({businame:"fileupload",item:"flash|"+(r.name||"null")+"|uploadSucc",sid:l.getSid()}),void s.oncomplete.call(r,a.set("sStatus","uploading"));i=r.err("cgi",o.errcode)}else i=r.err("http",o.errcode);l.LogKvEx({businame:"fileupload",item:"flash|"+(r.name||"null")+"|uploadError",sid:l.getSid()}),s.onerror.call(r,a.set({sError:i}))}else l.LogKvEx({businame:"fileupload",item:"flash|"+(r.name||"null")+"|uploadError",sid:l.getSid()}),s.onerror.call(r,a.set({sError:r.err("http",t)}))}}):s.oncomplete.call(r,a)},uploadToFtn:function(o){var a=this;if(!a.prepareUpload_(o))return!1;var e=o.get("nAppId")||2;return o.oCfg={sFlashMode:"RawPost"},l.QMAjax.send(l.T("/cgi-bin/ftnCreatefile?sid=$sid$&path=$path$&type=direct&s=comCreate&appid=$appid$&dirid=$dirid$&ef=js&resp_charset=UTF8&loc=$loc$").replace({sid:l.getSid(),loc:["ftnCreatefile","ftnCreatefile","comCreate",(o.get("sFrom")||"")+e].join(","),appid:e,dirid:o.get("sPathId")||"",path:encodeURIComponent(o.get("sName"))}),{timeout:6e4,headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t,n){var i;if(e&&"0"==(i=l.evalValue(t)).errcode&&i.url)return o.set(i.data),o.oCfg={sUrl:i.url,sFlashMode:"RawPost",sFile:"file",oQueryData:{},oBodyData:{mode:/Flash/.test(o.oUploader.name)?"flashupload":"formupload"}},l.LogKvEx({businame:"fileupload",item:"ftnCreatefile|"+(a.name||"null")+"|createFileSucc",sid:l.getSid()}),a.upload(o.set("sStatus","ready")),a.setKeepAlive(!0),!0;l.LogKvEx({businame:"fileupload",item:"ftnCreatefile|"+(a.name||"null")+"|createFileFail",sid:l.getSid()}),a.onerror(o.set({nPercent:0,sError:i&&i.errcode?a.err("cgi",i.errcode,i.appname,i.errmsg):a.err("http",4==n.readyState?n.status:"abort")}))}}),a.onprocess(o.set({nUploadPercent:0,bFtnFile:!0,nUpTime:(new Date).valueOf()})),!0}}},"base"),window.QMFileUpload=e}(QMFileAdaptor),QMFileUpload.getH5SafeLib=function AR(e){return{safeStartUpdate_:function(e){e.bCancelH5_=!1,e.set("nSize",parseInt(e.oH5File.size,10)),e._lastModified=e.oH5File.lastModified||+e.oH5File.lastModifiedDate,e.fCancel=function(){e.bCancelH5_=!0}},isFileModif_:function(e){return!e._lastModified||e._lastModified==(e.oH5File.lastModified||+e.oH5File.lastModifiedDate)||(e.fCancel&&e.fCancel(),this.onerror(e.set("sError",this.err("internal","77701"))),e._lastModified=null,!1)}}},function(c,e){var t=QMFileUpload,n=t.components.base.prototype,u={unknow:1e8,http:2e8,cgi:3e8,internal:4e8},d={RawPost:3,CheckPost:7,MultiPost:9};t.errInfo=n.errInfo=function(e){},n.ossLog=function(e){var t=this.cfg(e),n=this.name,i=0,o=0;if("error"==e.get("sStatus")){var a=(e.get("sError")||"").split(",");(s=u[a[0]])&&(e.get("nUploadPercent")<100&&"internal"==a[0]&&(s=5e8),s+=Math.abs(a[1]))}else if("cancel"==e.get("sStatus"))s=900000001;else if("stopped"==e.get("sStatus")&&"paused"==e.get("sUploadStep"))s=9e5;else if("complete"==e.get("sStatus")){var r=e.get("nSize")/1024/1024,s=0;1<=r&&r<6?s=Math.floor(r):6<=r&&r<=50?s=6:50<r&&r<=1024?s=7:1024<r&&(s=8),s*=1e5,1<e.get("nTry")&&(s+=1e6),/Flash/.test(n)&&(o=e.get("nPostMode"))&&(s+=1e7*o)}if(void 0!==s){/Flash/.test(n)?(i=e.get("nUpType")||d[t.sFlashMode]||3,e.get("bFtnFile")&&(i=3)):/Activex/.test(n)?i=2:/Rawinput/.test(n)?i=5:/Html5/.test(n)?i=1:/Ftn/.test(n)&&(i=6);var l=/http:\/\/(.*?)\//.exec(this.cfg(e).sUrl);c.ossLog("delay","all",c.T("stat=$stat$&ftype=$ftype$&utype=$utype$&errno=$errno$&retry=$retry$&fsize=$fsize$&utime=$utime$&percent=$percent$&errdetail=$errdetail$&uphost=$uphost$").replace({stat:!1===t.bOssLog?"custom":"attach",retry:0,ftype:e.get("bFtnFile")?"1":"0",errno:s,utype:i,fsize:e.get("nRealPostSize")||e.get("nSize"),utime:e.get("nRealPostTime")||e.get("nUsedTime")||-1,percent:e.get("nUploadPercent"),uphost:l&&l[1],errdetail:e.get("sError")}))}},n.err=function(e,t){return[].slice.call(arguments).join(",")},n.parser=function(e,t){var n=this,i=n.cfg(t),o={},a="error";if(/.*\/cgi-bin\/uploadfile/.test(i.sUrl))-1!=e.indexOf("/data/")?(r=e.split("|"),o.sFileId=r[0].split("/").pop(),r[1]&&(o.sFileUrl=r[1]),a="complete"):(r=/"errorcode" : "(.*)"/gi.exec(e))&&(a="error",o.sError=n.err("cgi",r[1]));else if(/.*\/cgi-bin\/upload/.test(i.sUrl)||/.*\/cgi-bin\/addr_upload/.test(i.sUrl)||/.*\/cgi-bin\/bizmail_upload/.test(i.sUrl)){if(/var\s*result\s*=\s*"qmfileuploadsuccess";/.test(e)){var r=/viewfileurl="(.*?)";/.exec(e);o.sFileUrl=r&&r[1]+"&sid="+c.getSid(),r=/filepath="(.*?)";/.exec(e),o.sFilePath=r&&r[1],o.sFileId=r&&r[1].split("/").pop(),a="complete",r=/filesize="(.*?)";/.exec(e);var s=parseInt(r&&r[1],10);s&&(o.nSize=s)}else if(/title\s*:\s*"cgi exception",/.test(e)){r=/errcode\s*:\s*"(.*?)",/gi.exec(e);o.sError=n.err("cgi",r?r[1]:"0")}}else if(/\/ftn_handler/.test(i.sUrl)){0==(r=/parent\.ftn_post_end\((.*?)\)/.exec(e))[1]?a="complete":o.sError=n.err("cgi",r?r[1]:"0")}return"complete"==a||o.sError||(o.sError=n.err("unknow","0")),[a,o]}}(QMFileAdaptor),function(c,e){QMFileUpload.components;var o=window,i=QMFileUpload.oUtil;function a(){var e=c.createActiveX(0),t="";try{t=e.GetDLLFileName()}catch(n){}return-1!=t.indexOf("_2.dll")?['<object classid="CLSID:B0F77C07-8507-4AB9-B130-CC882FDDC046"'," width=100% height=100%></object>"].join(""):['<object classid="CLSID:F4BA5508-8AB7-45C1-8D0A-A1237AD82399"'," width=100% height=100%></object>"].join("")}QMFileUpload.createCom("ActivexPopup",function(t){return{init:function(e){t.init.call(this,e),this._initCfg(),this._initContainer()},_initCfg:function(){var e=this.oCfg;e.oQueryData=c.extend({resp_charset:c.isSystem("mac")?"UTF8":"",t:"qmfileupload",ef:"qdata",ssl_edition:c.getCookie("ssl_edition"),uin:c.getCookie("biz_username"),sid:c.getSid(),mode:"file"},e.oQueryData)},upload:function(e){var t=this.cfg(e);if(!this.prepareUpload_(e))return!1;var n=c.createActiveX(2,c.getDomWin(t.oContainer));return this._setRequest(e,t,n),n.AddFormItem(t.sFile,4,0,e.get("sFid")),e.set({sStatus:"uploading",nTry:e.get("nTry")+1,nUpTime:(new Date).valueOf()}),e.fCancel=function(){n.StopUpload()},n.StartUpload(),!0},_setEvent:function(l,c){var u=this;c.get("sFid");l.OnEvent=function(e,t,n,i,o){switch(t){case 1:u.onerror(c.set({sError:u.err("internal",n,i)}));break;case 2:u.onprocess(c.set({nUploadPercent:n/i*100}));break;case 3:if(debug(["OnEvent",l.ResponseCode,l.Response]),"200"!=l.ResponseCode){var a="";if(0==l.ResponseCode)for(var r in l)a+=r+"="+l[r]+",";u.onerror(c.set({sError:u.err("http",l.ResponseCode,"detail=",a)}))}else{var s=u.parser(l.Response,c);(u["on"+s[0]]||function(){}).call(u,c.set(s[1]))}}}},_setRequest:function(e,t,n){this._setEvent(n,e),n.URL=i.cfg2Url(t),n.AddHeader("Cookie",document.cookie),c.E(t.oBodyData,function(e,t){n.AddFormItem(t,0,0,e)})},_parseFileList:function(e,t){var r=this,s=t||c.createActiveX(2);if(e&&"string"==typeof e){var l=[];c.E(e.split("\r\n"),function(e){var t=c.trim(e).split(" ");if(2<=t.length){var n,i=t.shift(),o=t.join(" "),a=parseInt(s.GetFileSize(o));n=r.addFile({sFid:i,sStatus:"ready",sName:o.split(/[\\\/]/).pop(),nSize:a}),l.push(n)}}),r.onselect(l)}},_initContainer:function(){var i=this,e=i.oCfg.oContainer;c.addEvent(e,"click",function(e){var t=c.createActiveX(2);if(t){var n=t.SelectFiles(o);i._parseFileList(n,t),c.stopPropagation(e)}})}}},"baseToFtn"),QMFileUpload.createCom("ActivexPaste",function(e){return{_initContainer:function(){var t=this,e=t.oCfg,n=e.oContainer;n&&e.bBindKeyDown&&c.addEvent(n,"keydown",function(e){!e.ctrlKey&&!e.metaKey||86!=e.keyCode&&118!=e.keyCode||e.cancelBubble||t.getClipBoardFiles(e)})},getClipBoardFiles:function(e){var t=c.createActiveX(2);if(t){var n=t.GetClipboardFiles();this._parseFileList(n),n&&c.preventDefault(e)}}}},"ActivexPopup");var r="\u5c06\u6587\u4ef6\u62d6\u62fd\u81f3\u6b64\u533a\u57df\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5feb\u6377\u952ectrl+c\u3001ctrl+v\u6765\u6dfb\u52a0\u9644\u4ef6\u3002";c.extend(i,{getDragCode4Ax:a,sDragEnter:r,sDragOver:"\u91ca\u653e\u9f20\u6807"}),QMFileUpload.createCom("ActivexDrag",function(e){return{_initContainer:function(){var e,t=this,n=t.oCfg.oContainer;n.innerHTML=a(),setTimeout(function(){e=t._moActivexDom=n.firstChild,c.extend(e,{text:r,backColor:16777215,textColor:0,textFacName:"\u5b8b\u4f53",textFontSize:10,textFontWeight:500,OnFilesDroped:function(e){t._onFilesDroped(e)}})},200)},_onFilesDroped:function(e){var t=this._moActivexDom;switch(e){case"ENTER":t.text="\u91ca\u653e\u9f20\u6807";break;case"LEAVE":t.text=r;break;case"OVER":break;default:t.text=r,this._parseFileList(e)}}}},"ActivexPopup")}(QMFileAdaptor),function(m){var e=QMFileUpload,t=(e.components,e.oUtil),n=[location.protocol,"//",location.hostname,"/cgi-bin/upload"].join(""),f={unknow:1e8,http:2e8,cgi:3e8,internal:4e8},p={RawPost:3,CheckPost:7,MultiPost:9},i=new e.multiCreater;t.nMinDownloadFTNwidgetFileSize=209715200,t.isNeedDownloadFTNwidget=function(e){return e&&/Popup/i.test(e)&&!/(Ftn|FlashH5|H5C)/i.test(e)&&!m.detectActiveX(3,1)},e.create=function(e,t){return i.create(e,t)},e.create.oCreaterInstance=i,e.getMailLib=function(l){return{defaultQueryData:function(){return{}},initConfg:function(e){var t=this;l.initConfg.apply(t,arguments);var n=t.oCfg;n.sUrl=n.sUrl||t.getMailUploadUrl(),n.oQueryData=m.extend(t.defaultQueryData(e),n.oQueryData),"notebook"==n.business&&(n.oQueryData=m.extend(n.oQueryData,{type:n.type,filetype:n.filetype,business:n.business,t:n.t})),t.addToUrl(n.oQueryData);var i=n.sUrl.match(/^(https?:)?\/\//i);i?i[1]||(n.sUrl=location.protocol+n.sUrl):n.sUrl=[location.protocol,"//",location.hostname,0===n.sUrl.indexOf("/")?"":"/",n.sUrl].join("")},addToUrl:function(e){var t=this.oCfg.sUrl,n=[];m.E(e,function(e,t){null!==e&&n.push([t,encodeURIComponent(""+e)].join("="))}),this.oCfg.sUrl=[(t.split("?")||"")[0],n.join("&")].join("?")},ossLog:function(e){var t=this;if("string"!=typeof e){var n=t.cfg(e),i=t.name,o=0,a=0,r=e.get("nSize")/1024/1024,s=0;if(1<=r&&r<6?s=Math.floor(r):6<=r&&r<=50?s=6:50<r&&r<=1024?s=7:1024<r&&(s=9),"error"==e.get("sStatus")){var l=(e.get("sError")||"").split(",");c=f[l[0]],/^size,-1,\d+$/i.test(e.get("sError"))?c=900000003:c&&(e.get("nUploadPercent")<100&&"internal"==l[0]&&(c=5e8),c+=Math.abs(l[1]),c+=1e5*parseInt(s),/Flash/.test(i)&&(a=e.get("nPostMode"))&&(c+=1e7*parseInt(e.get("nPostMode"))))}else if("cancel"==e.get("sStatus"))c="undefined"!=typeof e.nLastPercentOssLog?900000002:900000001;else if("stopped"==e.get("sStatus")&&"paused"==e.get("sUploadStep"))c=9e5;else if("uploading"==e.get("sStatus"))c=-1;else if("complete"==e.get("sStatus")){var c=0;c=1e5*s,1<e.get("nTry")&&(c+=1e6),/Flash/.test(i)&&(a=e.get("nPostMode"))&&(c+=1e7*a)}if(void 0!==c){/Flash/.test(i)?(o=n.utype||e.get("nUpType")||p[n.sFlashMode]||3,!1===e.get("bIsUptoFtnForNormal")&&15!=o&&16!=o&&17!=o&&e.get("bFtnFile")&&(o=3)):/Activex/.test(i)?o=2:/Rawinput/.test(i)?o=5:/Html5/.test(i)?o=1:/^Ftn/.test(i)?o=6:/ppFtn/i.test(i)&&(o=19);var u,d=e.get("nRetryTimes")||0;(!e.get("bFtnFile")&&!e.get("bIsUptoFtnForNormal")||e.get("nUploadPercent"))&&(u=/http:\/\/(.*?)\//.exec(n.sUrl)),m.ossLog("delay","all",m.T("stat=$stat$&ftype=$ftype$&utype=$utype$&errno=$errno$&retry=$retry$&fsize=$fsize$&utime=$utime$&percent=$percent$&fid=$fid$&errdetail=$errdetail$&uphost=$uphost$&filename=$filename$&bt=$bt$&block=$block$").replace({stat:!1===n.bOssLog?"custom":"attach",retry:d,ftype:e.get("bFtnFile")?"1":"0",errno:c,utype:o,fsize:e.get("nRealPostSize")||e.get("nSize"),fid:e.get("bFtnFile")&&e.get("sFileId")||"",utime:900000003==c?0:e.get("nRealPostTime")||e.get("nUsedTime")||-1,percent:e.get("nUploadPercent"),uphost:u&&u[1]||e.get("sIP"),errdetail:e.get("sError"),filename:e.get("sName"),bt:(m.gbIsIE?1:m.gbIsFF&&2)||m.gbIsWebKit&&3,block:!t.nBlockSize||15!=o&&16!=o&&17!=o&&18!=o?"":t.nBlockSize}))}}else"flashInitError"==e?m.LogKV({sValue:"getinvestigate|fileupload|flashinit|error|"+t.name}):"flashDLoadError"==e?m.LogKV({sValue:"getinvestigate|fileupload|flashdload|error"}):"flashInit"==e?m.LogKV({sValue:"getinvestigate|fileupload|flashinit|"+t.name}):"1sNoPercent"==e?m.LogKV({sValue:"getinvestigate|fileupload|1snopercent|"+t.name}):"crash"==e?m.LogKV({sValue:"getinvestigate|fileupload|crash|"+t.name}):"ppftnerror"==e&&m.LogKV({sValue:"getinvestigate|fileupload|ppftnerror|"+t.name})},parser:function(e,t){var n=this,i=n.cfg(t),o={},a="error";if("notebook"==i.business){var r=/pickey\s*=\s*"(.*)"/gi.exec(e)[1];if(r){o.sFileId=r;var s=/viewfileurl\s*=\s*"(.*)"/gi.exec(e)[1];-1<location.protocol.indexOf("https")&&(s=s.replace(/http/i,"https")),o.sFileUrl=s,a="complete",o.sFilePath=m.trim(e)}else(u=/errorcode\s*=\s*"(.*)"/gi.exec(e))?(a="error",o.sError=n.err("cgi",u[1])):(a="error",o.sError=n.err("unknow",709390))}else if("resume.import"==i.sBusiness)try{var l=e.match(/##LOGIC_DATA_START##\s*([\s\S]+?)\s*##LOGIC_DATA_END##/),c=m.evalValue(m.htmlDecode(l[1]).replace(/\n/g,"\\n").replace(/\r/g,"\\r"));c.result&&c.result.errCode?(a="error",o.sError=n.err("cgi",c.result.errCode)):a="complete",o.resume=c.data}catch(p){a="error",o.sError=n.err("unknow",709390)}else if(/.*\/cgi-bin\/uploadfile/.test(i.sUrl)){-1!=e.indexOf("/data/")?(u=e.split("|"),o.sFileId=u[0].split("/").pop(),o.sFileId?(u[1]&&(o.sFileUrl=u[1]),a="complete"):(a="error",o.sError=n.err("unknow",709394)),o.sFilePath=m.trim(e)):(u=/"errorcode" : "(.*)"/gi.exec(e))?(a="error",o.sError=n.err("cgi",u[1])):(a="error",o.sError=n.err("unknow",709390))}else if(/.*\/cgi-bin\/upload/.test(i.sUrl)||/.*\/cgi-bin\/addr_upload/.test(i.sUrl)||/.*\/cgi-bin\/bizmail_upload/.test(i.sUrl))if(/var\s*result\s*=\s*"qmfileuploadsuccess";/.test(e)){var u=/viewfileurl="(.*?)";/.exec(e);o.sFileUrl=u&&u[1]+"&sid="+m.getSid(),u=/filepath="(.*?)";/.exec(e),o.sFileId=u&&u[1].split("/").pop(),o.sFilePath=m.trim(u[1]),u=/filesize="(.*?)";/.exec(e);var d=parseInt(u&&u[1],10);d&&(o.nSize=d);var f=(u=/nf="(.*?)";/.exec(e))&&u[1];f&&(o.sNf=f),o.sFileId?a="complete":(a="error",o.sError=n.err("unknow",709395))}else if(/title\s*:\s*"cgi exception",/.test(e)){u=/errcode\s*:\s*"(.*?)",/gi.exec(e);o.sError=n.err("cgi",u?u[1]:"0")}else a="error",o.sError=n.err("unknow",709397);else if(/\/ftn_handler/.test(i.sUrl)){(u=/parent\.ftn_post_end\((.*?)\)/.exec(e))&&0==u[1]?a="complete":o.sError=n.err("cgi",u?u[1]:"709398")}else o.sError=n.err("unknow","709399");return[a,o]},getMailUploadUrl:function(){return n},callBack:function(e,t){"onprocess"==e?(this.setKeepAlive(!0),this._checkProcessStop(t)):"oncomplete"!=e&&"onerror"!=e||this.checkClearAlive(),l.callBack.apply(this,arguments)},_checkProcessStop:function(e){var t=this;if((e=e[0])&&0<=e.get("nPercent")&&!e._nCheckProcessId){var n=setInterval(function(){"uploading"==e.get("sStatus")?(e.get("nPercent")==e._nLastPercent&&e.nLastPercentOssLog!=e._nLastPercent&&(t.calcUsedTime(e),t.ossLog(e),e.nLastPercentOssLog=e._nLastPercent),e._nLastPercent=e.get("nPercent")):clearInterval(e._nCheckProcessId)},6e4);e._nCheckProcessId=n}},setKeepAlive:function(e){var r=this;if(e){if(r._mnKeepAlive)return;r._mnKeepAlive=setInterval(function(){m.QMAjax.send("/cgi-bin/readtemplate?t=keep_alive&ef=js&sid="+m.getSid()+"&r="+Math.random(),{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t,n){if(-1!=t.indexOf("\x3c!--cgi exception--\x3e")&&-1!=t.indexOf('errcode : "-2"')){var i=r.getFile();for(var o in i){var a=i[o];"uploading"==a.get("sStatus")&&(a.fCancel&&a.fCancel(),r.onerror(a))}}}})},9e5)}else clearInterval(r._mnKeepAlive),r._mnKeepAlive=null},checkClearAlive:function(){var e=this;setTimeout(function(){e.getUploadingCnt()&&e.setKeepAlive(!1)},2e3)},uploadToFtnForNormalAttachment_:function(a){var r=this,e=a.get("nAppId")||72;return!!r.prepareUpload_(a)&&(m.QMAjax.send(["/cgi-bin/uploadunite?func=CreateFile&&inputf=json&outputf=json&&sid=",m.getSid()].join(""),{method:"post",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},content:m.T('{"path":"$path$","appid":"$appid$","size":$size$}').replace({appid:e,path:encodeURIComponent(a.get("sName")),size:a.get("nSize")}),onload:function(e,t,n){var i,o=window.gnTestSvr?window.gnTestSvr:"";if(e&&"0"==(i=m.evalValue(t)).result.errCode&&i.url)return a.set(i.data),a.oCfg=m.extend(a.oCfg||{},{sUrl:o?i.url.replace(/(:?\d+\.){3}(:?\d+)\:\d{4}/gi,o):i.url,sFile:"file",bToFtn:!0,oQueryData:{},oBodyData:{mode:/Flash/.test(a.oUploader.name)?"flashupload":"formupload"}}),r.upload(a.set("sStatus","ready")),!0;r.onerror(a.set({nPercent:0,sError:i&&i.result&&i.result.errCode?r.err("cgi",i.result.errCode,i.appname):r.err("http","abort"==t?-1:n.status)}))}}),r.onprocess(a.set({nUploadPercent:0,bFtnFile:!0,nUpTime:(new Date).valueOf()})),!0)},oncomplete:function(e){e.get("bIsUptoFtnForNormal")?this._fChenkIsPoison(e):this.oncompleteToFtn(e)},_fChenkIsPoison:function(e){var t=e.oUploader.name;if(/Flash/.test(t)){var n=this.getFlash().getFileHeadContent();this._fCheckFileCallback(e,n||"")}else/Html5/.test(t)?this._fCheckFileByH5(e,_fCheckFileCallback):this._fCheckFileCallback(e,"")},_fCheckFileCallback:function(r,e){var s=this,t=/\.(\w+)$/.test(r.get("sName"))&&RegExp.$1;m.QMAjax.send(["/cgi-bin/upload?saction=checkattach&inputf=json&outputf=json&sid=",m.getSid()].join(""),{method:"post",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},content:m.T("fileid=$fileid$&data=$data$&suffix=$suffix$&md5=$md5$&mailid=$mailid$").replace({fileid:r.get("sFileId"),data:e||"empty",suffix:t,md5:r.get("sMD5"),mailid:r.get("sMailId")}),onload:function(e,t,n){if(e){function i(e,t,n,i){var o,a;if(o=e.indexOf(t),a=e.indexOf(n),-1!=o&&-1!=a&&o<a)return e.substring(o+i,a)}if(0==i(t,"<ret>","</ret>",5)&&r.get("sFileId")){getTop().getMainWin().QMAttach._moUploadFtnFileId.push(r.get("sFileId"));var o=i(t,"<sFileType>","</sFileType>",11),a=i(t,"<sUrl>","</sUrl>",6);1==o&&(r.set("sFileUrl",a),getTop().getMainWin().QMAttach._moCurUploadAttachInfo.sFileUrl=a),l.oncomplete.call(s,r.set("sStatus","uploading"))}}else l.onerror.call(s,r.set({sError:s.err("http",t)}))}})},_fCheckFileByH5:function(n,t){var i=this,e=new FileReader;e.onload=function(e){t.call(i,n,e.currentTarget.result||"")},e.onError=function(e){var t=e.target.error;i.onerror(n.set({nUpType:i.getFlash().getCurUptype(),sError:i.err("html5fd",t.code,t.name)}))},e.readAsDataURL(i.getFileSliceFunc_().call(n.oH5File,0,128))}}};var o=e.qmFile,a=function(e){o.call(this,e)};(a.prototype=new o({})).uploadToFtn=function(){return this.oUploader.uploadToFtn(this)},e.getFtnLib=function(s){return{qmFile:a,oncompleteToFtn:function(a){var r=this;a.get("bFtnFile")?m.QMAjax.send(m.T("/cgi-bin/ftnGetURL?sid=$sid$&t=ftn.json&s=part&fid=$fid$&ef=js").replace({sid:m.getSid(),fid:a.get("sFileId")}),{onload:function(e,t,n){if(e){var i,o=m.evalValue(t)||{};if("0"==o.errcode){if(o.oFile&&o.oFile.sKey&&o.oFile.sFetchCode)return a.set(o.oFile).set({sDownloadPage:["http://mail.qq.com/cgi-bin/ftnExs_download?t=exs_ftn_download&k=",o.oFile.sKey,"&code=",o.oFile.sFetchCode].join(""),nExpireTime:-1!=o.oFile.expiretime?o.oFile.expiretime:2592e3}),void s.oncomplete.call(r,a.set("sStatus","uploading"));i=r.err("cgi",o.errcode)}else i=r.err("http",o.errcode);s.onerror.call(r,a.set({sError:i}))}else s.onerror.call(r,a.set({sError:r.err("http",t)}))}}):s.oncomplete.call(r,a)},uploadToFtn:function(a){var r=this,e=a.get("nAppId")||72;return!!r.prepareUpload_(a)&&(r.onprocess(a.set({nUploadPercent:0,nTry:a.get("nTry")+1,bFtnFile:!0,nUpTime:(new Date).valueOf()})),m.QMAjax.send(m.T("/cgi-bin/ftnCreatefile?sid=$sid$&path=$path$&type=direct&s=comCreate&appid=$appid$&dirid=$dirid$&ef=js&resp_charset=UTF8&loc=$loc$").replace({sid:m.getSid(),loc:["ftnCreatefile","ftnCreatefile","comCreate",(a.get("sFrom")||"")+e].join(","),appid:e,dirid:a.get("sPathId")||"",path:encodeURIComponent(a.get("sName"))}),{headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t,n){var i,o=window.gnTestSvr?window.gnTestSvr:"";if(e&&"0"==(i=m.evalValue(t)).errcode&&i.url)return a.set(i.data),a.oCfg=m.extend(a.oCfg||{},{sUrl:o?i.url.replace(/(:?\d+\.){3}(:?\d+)\:\d{4}/gi,o):i.url,sFile:"file",bToFtn:!0,oQueryData:{},oBodyData:{mode:/Flash/.test(a.oUploader.name)?"flashupload":"formupload"}}),r.upload(a.set("sStatus","ready")),!0;r.onerror(a.set({nPercent:0,sError:i&&i.errcode?r.err("cgi",i.errcode,i.appname):r.err("http","abort"==t?-1:n.status)}))}}),!0)}}}}(QMFileAdaptor),function(u,e){var t=QMFileUpload,d=(t.components,QMFileUpload.oUtil),a=u.T(["top:0;left:0;","position:absolute;","cursor:pointer;","width:100%;","height:100%;","overflow:hidden;","background-color:#fff;","filter: alpha(opacity=0);","zoom:1;","opacity:0.0;","z-index:999999999;"]),o=u.T(["cursor: pointer;","font-family: Times;","position: absolute;","cursor: pointer;","width:2000px;","height:",u.isBrowser("edge")||u.isBrowser("ie")?30:600,"px;",u.isBrowser("ie")?"font-size:500px;":"",u.isBrowser("ff")&&parseInt(u.gsFFVer)<22?"right:426px;":"right:0px;"]),n=function(e){return{createInput_:function(e){var t=this.oCfg,n=e.createElement("input");return n.type="file",n.tabIndex=-1,t.sInputTitle?n.title=t.sInputTitle:u.isBrowser("ie")||(n.title=u.isBrowser("safari")?"\u4e0a\u4f20\u6587\u4ef6":" "),n.name=t.sFile||"fileData",n.style.cssText=o,n},createWarpHtml_:function(e,t,n){var i=n||this.oCfg.oContainer,o=t.createElement(e);return o.style.cssText=a.replace({width:i.offsetWidth,height:i.offsetHeight+1}),i.style.position="relative",i.insertBefore(o,i.firstChild),o}}};function i(e){return u.extend(QMFileUpload.getMailLib(e),QMFileUpload.getFtnLib(e),{doHtml5Upload_:function(e,t){var n=this.cfg(e),i=encodeURIComponent(e.get("sName"));if(u.isBrowser("safari")&&!u.isBrowser("edge")&&(i=i.replace(/%(\w{2})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})),t.setRequestHeader("X-QQMAIL-FILENAME",i),n.bToFtn){var o=new FormData;o.append("timeout",6e4),o.append("mode","html5upload"),o.append("Upload","Submit Query"),o.append("Filename",e.oH5File.name),o.append("file",e.oH5File),t.send(o)}else t.send(e.oH5File)},defaultQueryData:function(){return{t:"qmfileupload",ef:"qdata",sid:u.getSid(),resp_charset:"UTF8",mode:"file"}}})}QMFileUpload.getInputLib=n,QMFileUpload.createCom("RawinputPopup",function(t){return u.extend(n(),{init:function(e){t.init.call(this,e),this._initCfg(),this._initContainer()},_initCfg:function(){var e=this.oCfg;e.oQueryData=u.extend({t:"qmfileupload",ef:"qdata",sid:u.getSid(),mode:"file"},e.oQueryData)},upload:function(e){var t=this,n=t.cfg(e);return!!t.prepareUpload_(e)&&(t._setRequest(e,n,function(){t._submit(e)}),!0)},_submit:function(e){var t=this,n=(new Date).valueOf(),i=function(){t.onprocess(e.set({nTry:e.get("nTry")+1,nUpTime:n,nUploadPercent:-1}))};e.oForm.submit(),i(),setTimeout(function(){"uploading"==e.get("sStatus")&&(i(),setTimeout(arguments.callee,1e3))},1e3)},_setRequest:function(r,t,n){var s=this,i="if"+t.sId,e=u.getDomWin(t.oContainer),l=e.document,c={id:i,obj:l.body,where:"beforeEnd",style:"display:none;",onload:function(e){var o=this,a=r.oForm;u.extend(a,{method:"post",target:i,action:d.cfg2Url(t)}),a.encoding="multipart/form-data",a.style.display="none",a.firstChild.name=t.sFile,u.E(t.oBodyData,function(e,t){var n=l.createElement("input");n.type="hidden",n.name=t,n.value=e,a.appendChild(n)}),l.body.appendChild(a),c.onload=function(){var e,t;try{var n=(e=(e=u.htmlDecode(o.contentWindow.document.documentElement.innerHTML)).replace(/BODY/g,"body")).match(/<body>(.*?)<\/body>/);n[1]&&(e=n[1]),t=s.parser(e,r)}catch(i){t=["complete",{}]}u.removeSelf(o),u.removeSelf(a),(s["on"+t[0]]||function(){}).call(s,r.set(t[1])),r.oForm=r.oFile=null},r.fCancel=function(){u.removeSelf(o),u.removeSelf(a)},n()}};u.createBlankIframe(e,c)},_initInput:function(){var e=this,t=(e.oCfg,e._moDom),n=e.createInput_(u.getDomWin(t).document);n.onchange=function(){e._onchange(this)},u.addEvent(n,"click",function(e){u.stopPropagation(e)}),t.appendChild(n)},_onchange:function(e){var t=u.getDomWin(e).document.createElement("form");t.appendChild(e),this._initInput();var n=this.addFile({sName:e.value.split("\\").pop()});n.oForm=t,"RawinputPopupMail"==n.oUploader.name&&n.set("sUploadMode","rawinput"),this.onselect([n])},_initContainer:function(){var e=this.oCfg.oContainer;this._moDom=this.createWarpHtml_("span",u.getDomWin(e).document),this._initInput()}})},"baseToFtn"),QMFileUpload.createCom("RawinputPopupMail",function(e){return u.extend(QMFileUpload.getMailLib(e),QMFileUpload.getFtnLib(e),{defaultQueryData:function(){return{t:"qmfileupload",ef:"qdata",sid:u.getSid(),uin:u.getUin(),mode:"file"}}})},"RawinputPopup"),t.createCom("Html5Popup",function(t){return{init_:function(e){t.init.call(this,e),this._initCfg(),this._initContainer()},_initCfg:function(){var e=this.oCfg;e.oQueryData=u.extend({t:"qmfileupload",ef:"qdata",sid:u.getSid(),resp_charset:"UTF8",mode:"file"},e.oQueryData)},doHtml5Upload_:function(e,t){t.send(e.oH5File)},detect:function(e){var t=window,n=t.document.createElement("input");return n.type="file","multiple"in n&&t.File!==undefined&&t.XMLHttpRequest!==undefined&&(new XMLHttpRequest).upload!==undefined},upload:function(e){var t=this.cfg(e);if(!this.prepareUpload_(e))return!1;var n=new XMLHttpRequest;return this._setRequest(e,t,n),e.set({sStatus:"uploading",nTry:e.get("nTry")+1,nUpTime:(new Date).valueOf()}),e.fCancel=function(){n.abort()},this.doHtml5Upload_(e,n),!0},_initContainer:function(){this.oCfg;var e=this.oCfg.oContainer,t=u.getDomWin(e).document.createElement("span");(this._moDom=t).style.cssText=a.replace({width:e.offsetWidth,height:e.offsetHeight+1}),this._initInput(),e.style.position="relative",e.insertBefore(t,e.firstChild)},_initInput:function(){var e=this,t=e.oCfg,n=e._moDom,i=u.getDomWin(n).document.createElement("input");i.tabIndex=-1,i.type="file",i.name=t.sFile,i.style.cssText=o,i.multiple="true",i.onchange=function(){e._onchange(this)},u.addEvent(i,"click",function(e){u.stopPropagation(e)}),n.appendChild(i)},_onchange:function(e){u.removeSelf(e),this._initInput(),this.addH5Files_(e.files)},addH5Files_:function(e,t){var o=this,n=[],i=e.length,a=function(e){n.push(e),--i<1&&(t?t(n):o.onselect(n))};u.E(e,function(i){var e=new FileReader;e.onload=function(e){a(o.parseH5File_(i))},e.onerror=function(e){var t=e.target.error,n=o.parseH5File_(i);n.set({sStatus:"error",sError:o.err("fromSelect_html5fd",t.code,t.name)}),a(n)},e.readAsDataURL(i.slice(0,1))})},parseH5File_:function(e){var t=this.addFile({sName:e.name,nSize:parseInt(e.size,10)});return t.oH5File=e,t},_setRequest:function(t,e,n){var i=this,o=e||{},a=t.get("sName");u.isBrowser("safari")&&!u.isBrowser("edge")&&(a=encodeURIComponent(a).replace(/%(\w{2})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})),n.upload.onprogress=function(e){e.lengthComputable&&i.onprocess(t.set({nUploadPercent:e.loaded/e.total*100}))},n.onreadystatechange=function(){if(4==n.readyState)if(n.onreadystatechange=n.upload.onprogress=null,200==n.status){var e=i.parser(n.responseText,t);i["on"+e[0]].call(i,t.set(e[1]))}else i.onerror(t.set({sError:i.err("http",n.status)}))};var r=QMFileUpload.oUtil;n.open("POST",r.cfg2Url(e),!0),o.bToFtn||(n.setRequestHeader("X-QQMAIL-FILENAME",encodeURIComponent(a)),n.setRequestHeader("content-type","application/octet-stream"))}}},"baseToFtn"),QMFileUpload.createCom("Html5Drag",function(e){return{_initContainer:function(){var e=this.oCfg,t=this.oCfg.oContainer,n=(u.getDomWin(t).document,u.$("div",t)[0]||u.getDomWin(t).document.createElement("div"));n.setAttribute("ui-type","html5drag_msg"),e.bNoStyle||(n.style.cssText="width:100%; font-size:14px; text-align:center;",t.clientHeight?n.style.lineHeight=t.clientHeight+"px":(n.style.position="absolute",n.style.paddingTop="20%",n.style.marginTop="-20px")),e.oMsgDom||(e.oMsgDom=n),e.sDragEnterMsg=e.sDragEnterMsg||"\u91ca\u653e\u9f20\u6807",e.sDragLeaveMsg=e.sDragLeaveMsg||"\u5c06\u6587\u4ef6\u62d6\u62fd\u81f3\u6b64\u533a\u57df",e.oMsgDom.innerHTML=e.sDragLeaveMsg,u.addEvents(n,this._getEventFunc()),t.insertBefore(n,t.firstChild)},_getEventFunc:function(){var t=this,n=t.oCfg;return{dragover:function(e){d.isFileDragOver(e)&&(n.oMsgDom.innerHTML=n.sDragEnterMsg,n.ondragover&&n.ondragover.call(t,e)),u.preventDefault(e)},dragleave:function(e){d.isFileDragOver(e)&&(n.oMsgDom.innerHTML=n.sDragLeaveMsg,n.ondragleave&&n.ondragleave.call(t,e)),u.preventDefault(e)},drop:function(e){n.oMsgDom.innerHTML=n.sDragLeaveMsg,e.dataTransfer.files.length&&t._onDrop(e),u.stopPropagation(e),u.preventDefault(e)},click:function(e){n.onproxyclose&&n.onproxyclose.apply(t)}}},_onDrop:function(e){this.addH5Files_(e.dataTransfer.files)}}},"Html5Popup"),QMFileUpload.createCom("Html5PopupMail",i,"Html5Popup"),QMFileUpload.createCom("Html5DragMail",i,"Html5Drag"),QMFileUpload.createCom("Html5DragCROS",function(e){return u.extend(i(e),{defaultQueryData:function(){return{}}})},"Html5Drag")}(QMFileAdaptor),function(r,e){QMFileUpload.components;var a=window,s=r.T(['<span style="top:0;left:0;position:absolute;width:$width$;height:$height$;margin:$margin$;z-index:0;overflow:hidden;">',"$code$","</span>"]),t=QMFileUpload.oUtil,l=function(){};QMFileUpload.createCom("FlashPopup",function(i){return{init:function(e){i.init.call(this,e),this._initContainer()},detect:function(){return QMFileUpload.oUtil.detectFlash()},upload:function(e){var t=this._moFlash,n=this.cfg(e);if(!this.prepareUpload_(e))return!1;try{"editor_word_compose_tip"==n.oContainer.id&&(n.sUrl=getTop().QMDistributeDomain.getHost()+"/cgi-bin/upload")}catch(i){}return this._setRequest(n),e.set({sStatus:"uploading",nTry:e.get("nTry")+1,nUpTime:(new Date).valueOf()}),e.fCancel=function(){t.cancel()},t.upload(e.get("sFid"),n.sFile,"RawPost"==n.sFlashMode?0:1),!0},cancel:function(e){e.set("nUpType",this._moFlash.getCurUptype()),i.cancel.call(this,e)},getFile:function(e){var t=i.getFile.call(this);for(var n in t)if(t[n].get("sFid")==e)return t[n];return t},_setRequest:function(e){var n=this._moFlash;r.E(e.oBodyData,function(e,t){n.addUploadVar(t,e)}),n.setUploadUrl(t.cfg2Url(e))},_getWrapHtml:function(e){var t=this.oCfg;try{return s.replace({height:t.nHeight||e.offsetHeight,width:t.nWidth||e.offsetWidth,margin:t.nMargin||0,code:r.generateFlashCode("flashUploader_"+t.sId,r.getPath("swf_cdn")+"uploaderftn.swf?r="+Math.random(),{width:"100%",height:"100%"},{wmode:"transparent"})})}catch(n){return s.replace({height:t.nHeight||e.offsetHeight,width:t.nWidth||e.offsetWidth,margin:t.nMargin||0,code:r.generateFlashCode("flashUploader_"+t.sId,getTopHost()+r.getPath("swf")+"uploaderftn.swf?r="+Math.random(),{width:"100%",height:"100%"},{wmode:"transparent"})})}},_initContainer:function(){var a=this,t=a.oCfg,n=t.oContainer,i=r.getDomWin(n);if(n){t.sId=Math.random();var e=a._getWrapHtml(n);n.style.position="relative",6==r.browserVer()&&(n.style.zoom=1,n.style.overflow="hidden"),r.insertHTML(n,"afterBegin",e),r.qmFlash&&r.qmFlash.isSupported()?setTimeout(function(){var e=a.getFlashObjCallBack_();e.id="flashUploader_"+t.sId,e.win=i,new r.qmFlash(e).setup(function(e,t){e?("AttachFrame"===n.id&&(getTop().getMainWin().QMAttach._bFlashUploaderStatus=!0,n.firstChild.style.width="65px"),n.firstChild.style.zIndex=2,n.firstChild.style.height="110%",n.children[1].style.zIndex=1,a._initFlash(this.getFlash())):(n.removeChild(n.firstChild),"AttachFrame"===n.id&&(getTop().getMainWin().QMAttach._bFlashUploaderStatus=!1),debug("the flash uploader is not ok..."))})},300):setTimeout(function(){new r.qmFlash({id:"flashUploader_"+t.sId,win:i,onSelect:function(e,t){a._doSelect(e,t)},onProcess:function(e,t){a.onprocess(a.getFile(e).set({nUploadPercent:t}))},onError:function(e,t,n,i){var o=a.getFile(e);a.onerror(o.set({nUpType:a._moFlash.getCurUptype(),nUploadPercent:i,sError:a.err("internal",parseInt(n.replace(/Error #/g,""),10))}))},onComplete:function(e,t,n){var i=a.getFile(e),o=a.parser(t,i);i.set({nPostMode:n,nUpType:a._moFlash.getCurUptype()}),(a["on"+o[0]]||l).call(a,i.set(o[1]))}}).setup(function(e,t){e?(n.firstChild.style.zIndex=2,n.firstChild.style.height="110%",n.children[1].style.zIndex=1,a._initFlash(this.getFlash())):(n.removeChild(n.firstChild),debug("the flash uploader is not ok..."))})},300)}},insertFlashElem_:function(n){var i=this,t="flashUploader_"+Math.random(),e=n.oFlashDOMCfg,o=n.sFlashUrl||r.getPath("swf_cdn")+"uploaderftn.swf?r="+Math.random();n.insertHTML(s.replace({height:e.nHeight||"100%",width:e.nWidth||"100%",top:e.nTop||0,left:e.nLeft||0,margin:e.nMargin||0,code:r.generateFlashCode(t,o,{width:e.nWidth||"100%",height:e.nHeight||"100%"},{wmode:"transparent"})})),setTimeout(function(){var e=i.getFlashObjCallBack_();e.id=t,e.win=n.oWin||a,new r.qmFlash(e).setup(function(e,t){e?(n.onsuccess&&n.onsuccess(),i.initFlash_(this.getFlash())):(n.removeHTML&&n.removeHTML(),-1!==o.indexOf("?")?(n.onerror&&n.onerror(t),i.ossLog("flashInitError"),debug("the flash uploader is not ok...")):(i.ossLog("flashDLoadError"),n.sFlashUrl=o+"?"+Math.random(),i.insertFlashElem_(n)))})},300)},getFlashObjCallBack_:function(){var o=this,a=getTop();o.oCfg.oContainer;return o.moFlashFileMap_={},{onSelect:function(e,t){o.onFlashSelect_.apply(o,arguments)},onProcess:function(e,t){o.onFlashProcess_.apply(o,arguments)},onError:function(e,t,n,i){a.debug.apply(a,arguments),o.onFlashError_.apply(o,arguments)},onComplete:function(e,t,n){o.onFlashComplete_.apply(o,arguments)},debug:function(){a.debug.apply(a,arguments)}}},getFlashFileId:function(e){return this.moFlashFileMap_[e]},getFlash:function(){return this._moFlash},doFlashUpload_:function(e,t){var n=this.cfg(e);t.upload(e.get("sFid"),n.sFile)},_initFlash:function(e){var t,n=this.oCfg;n.sFlashMode=n.sFlashMode||"RawPost",this._moFlash=e,!1!==n.bMulti?e.initlize("multi"):e.initlize("single"),e.setMultiAndResumeMode&&r.isBrowser("chrome")&&"CheckPost"==n.sFlashMode&&e.setMultiAndResumeMode(0),t={sid:r.getSid(),lang:"utf8",ssl_edition:r.getCookie("ssl_edition"),skey:r.getCookie("skey"),uin:r.getCookie("biz_username"),qm_sk:r.getCookie("qm_sk"),mode:"file"},"RawPost"==n.sFlashMode&&(t.ef="qdata",t.t="qmfileupload"),n.oQueryData=r.extend(t,n.oQueryData),e.clearUploadVars(),e.addUploadVar("timeout",6e4)},_doSelect:function(e,t){for(var n=this.oCfg,i=this._moFlash,o=[],a=e;a<=t;a++){var r=this.addFile({sFid:a,bVirtual:"RawPost"!=n.sFlashMode,sName:i.getFileInfo(a,"name"),nSize:parseInt(i.getFileInfo(a,"size"),10)});o.push(r)}this.onselect(o)},onFlashSelect_:function(e,t){for(var n=this,i=(n.oCfg,n._moFlash),o=[],a=e;a<=t;a++){var r=n.addFile({sFid:a,sName:i.getFileInfo(a,"name"),nSize:parseInt(i.getFileInfo(a,"size"),10)});n.moFlashFileMap_[a]=r.get("sFid"),o.push(r)}n.onselect(o)},onFlashProcess_:function(e,t){var n=this.getFile(this.getFlashFileId(e));n.set({nUploadedSize:Math.floor(n.get("nSize")*t/100),nUploadPercent:t}),this.onprocess(n)},onFlashComplete_:function(e,t,n){var i=this,o=i.getFile(i.getFlashFileId(e)),a=i.parser(t,o);o.set({nPostMode:n,nUpType:i._moFlash.getCurUptype()}),(i["on"+a[0]]||l).call(i,o.set(a[1]))},onFlashError_:function(e,t,n,i){var o=this,a=o.getFile(o.getFlashFileId(e));o.onerror(a.set({nUpType:o.getFlash().getCurUptype(),nUploadPercent:i,sError:o.err("internal",parseInt(n.replace(/Error #/g,""),10),"flashver="+r.qmFlash.getFlashVer().desc)}))}}},"baseToFtn")}(QMFileAdaptor),function(u,e){var a=QMFileUpload,r=a.components;debug(window.location.host,"init_FlashPopupMail"),a.createCom("FlashPopupMail",function(r){var t=a.getFtnLib(r);return u.extend(a.getMailLib(r),t,{init_:function(){return r.init.apply(this,arguments)},initFlash_:function(e){r.initFlash_.call(this,e),e.addUploadVar("timeout",6e4)},uploadToFtn:function(e){return e.oCfg={sFlashMode:"RawPost"},t.uploadToFtn.apply(this,arguments)},doFlashUpload_:function(e,t){var n=this.cfg(e);e.set({bVirtual:"RawPost"!=n.sFlashMode}),t.upload(e.get("sFid"),n.sFile,"RawPost"==n.sFlashMode?0:1)},onFlashComplete_:function(e,t,n){var i=this.getFile(this.getFlashFileId(e)),o=this.getFlash();i&&i.set({nUpType:o.getCurUptype(),nPostMode:n,nRetryTimes:o.getRetryTimes()}),r.onFlashComplete_.apply(this,arguments)},onFlashError_:function(e,t,n,i){var o=this.getFile(this.getFlashFileId(e)),a=this.getFlash();o&&o.set({nUpType:a.getCurUptype(),nPostMode:a.getCompleteMode(),nRetryTimes:a.getRetryTimes()}),r.onFlashError_.apply(this,arguments)},defaultQueryData:function(){var e=this.oCfg;e.sFlashMode=e.sFlashMode||"RawPost";var t={sid:u.getSid(),lang:"utf8",uin:u.getUin(),mode:"file"};return"RawPost"==e.sFlashMode&&(t.ef="qdata",t.t="qmfileupload"),"CheckPost"==e.sFlashMode&&(t.sid=t.sid.split(",")[0]),t},cancel:function(e){e.set("nUpType",this.getFlash().getCurUptype()),r.cancel.call(this,e)}})},"FlashPopup");var l,n=function(){},t=function(t){return{uploadInChip:function(e){return!!this.prepareUpload_(e)&&(this.callBack("onprocess",[e.set({nTry:e.get("nTry")+1,nUpTime:(new Date).valueOf(),bChipFile:!0,sStatus:"uploading",sUploadStep:"signing",nUploadPercent:0,nUploadedSize:0,nSignPercent:0})]),this.doChipFileSign_(e),!0)},_updateFlashFileSize:function(e){try{if(-1!=e.get("sType").indexOf("Flash")&&e.get("sFid")){var t=parseInt(e.uploader().getFlash().getLoadTotal(),10);t&&t!=e.get("nSize")&&(u.LogKV("uploadfile|flash|size_err"),e.set("nSize",t))}}catch(n){}},onChipFileForNormalAttachSignEnd_:function(l,e){var c=this;e.sUploadStep="creating",c.callBack("onprocess",[l.set(e)]),c._updateFlashFileSize(l),u.QMAjax.send(["/cgi-bin/upload?saction=ftnattach&&inputf=json&outputf=json&&sid=",u.getSid()].join(""),{method:"post",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},content:u.T("path=$path$&size=$size$&md5=$md5$&sha=$sha$").replace({path:encodeURIComponent(l.get("sName")),size:l.get("nSize"),md5:l.get("sMD5"),sha:l.get("sSHA")}),onload:function(e,t,n){function i(e,t,n,i){var o,a;if(o=e.indexOf(t),a=e.indexOf(n),-1!=o&&-1!=a&&o<a)return e.substring(o+i,a)}if(0==i(t,"<ret>","</ret>",5)){var o=i(t,"<sIP>","</sIP>",5),a=i(t,"<sKey>","</sKey>",6),r=i(t,"<sMailId>","</sMailId>",9),s=i(t,"<sFileld>","</sFileld>",9);l.set({sIP:o,sKey:a,sMailId:r,sFileId:s}),u.LogKvEx({businame:"fileupload",item:"upload|"+(c.name||"null")+"|createFileSucc",sid:u.getSid()}),c.onChipUpload_(l)}else u.LogKvEx({businame:"fileupload",item:"upload|"+(c.name||"null")+"|createFileFail",sid:u.getSid()})}})},doChipFileSign_:n,onChipUpload_:function(e){var t=(new Date).valueOf();e.set({sStatus:"uploading",sUploadStep:"posting",bChipFile:!0,nStartTime:t,nRealPostTime:0,nRealPostSize:0,nUpTime:t}),this.doChipUpload_(e),this.onprocess(e)},doChipUpload_:n,onChipUploadEnd_:function(e){this.onprocess(e.set("nUploadPercent",100)),this.fCancel=null},isUptoFtnForNormal:function(){var e;try{e=getTop().getMainWin().getPageId}catch(t){e=function(){}}return e&&("compose"==e()||"qq"==e())},onChipFileSignEnd_:function(e,t){e.get("bIsUptoFtnForNormal")?this.onChipFileForNormalAttachSignEnd_.apply(this,arguments):this.onChipFileSignEndFtn_.apply(this,arguments)},onChipFileSignEndFtn_:function(o,e){var a=this;e.sUploadStep="creating",a.callBack("onprocess",[o.set(e)]),a._updateFlashFileSize(o);var t=u.T("/cgi-bin/ftnCreatefile?uin=$uin$&ef=js&resp_charset=UTF8&s=ftnCreate&sid=$sid$&dirid=$dirid$&path=$path$&size=$size$&md5=$md5$&sha=$sha$&sha3=$sha3$&appid=$appid$&loc=$loc$").replace({sid:u.getSid(),loc:["ftnCreatefile","ftnCreatefile","ftnCreate",(o.get("sFrom")||"")+o.get("nAppId")].join(","),path:encodeURIComponent(o.get("sLocalPath")||o.get("sName")),dirid:o.get("sPathId"),size:o.get("nSize"),md5:o.get("sMD5"),sha:o.get("sSHA"),sha3:o.get("sSHA3"),appid:o.get("nAppId")});function n(){o.set({bCreateFile:!1,sCreateFileUrl:t}),u.QMAjax.send(t,{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t,n){var i=u.evalValue(t||"{}");e&&i&&"0"==i.errcode?(o.set(i.data),o.set("bCreateFile",!0),u.LogKvEx({businame:"fileupload",item:"ftnCreatefile|"+(a.name||"null")+"|createFileSucc",sid:u.getSid()}),a.onChipUpload_(o)):(u.LogKvEx({businame:"fileupload",item:"ftnCreatefile|"+(a.name||"null")+"|createFileFail",sid:u.getSid()}),a.onerror(o.set({nPercent:0,sError:i&&i.errcode?a.err("cgi",i.errcode,i.appname,i.errmsg):a.err("http",4==n.readyState?n.status:"abort")})))}})}o.get("bCreateFile")?o.get("sCreateFileUrl")==t?a.onChipUpload_(o):(u.QMAjax.send("/cgi-bin/ftnDelFile?t=ftn.json&s=oper&ef=js&sid="+u.getSid(),{headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},content:"fid="+o.get("sFileId")}),n()):n()},onChipFileSigning_:function(e,t){e.set("nSignPercent",Math.max(Math.min(100,Math.floor(t)),0)),this.callBack("onprocess",[e])},chipUpdateFileSize_:function(e,t){var s=this,n=(new Date).valueOf();e._nUpFileSizeTime?n-e._nUpFileSizeTime>=(t||5e3)&&(u.QMAjax.send(u.T("/cgi-bin/ftnUpFileSize?sid=$sid$&filekey=$fileid$&uploadsize=$uploadsize$&ef=js").replace({sid:u.getSid(),fileid:e.get("sFileId"),uploadsize:e.get("nUploadedSize")}),{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t,n){if(-1!=t.indexOf("\x3c!--cgi exception--\x3e")){var i=u.evalValue(t||"{}"),o=s.getFile();for(var a in o){var r=o[a];"uploading"==r.get("sStatus")&&(r.pause&&r.pause(),s.onerror(r.set("sError",["cgi",i.errcode,"ftnUpFileSize"].join(","))))}}}}),e._nUpFileSizeTime=n):e._nUpFileSizeTime=n},setRealPostSize_:function(e,t,n){0<n&&"paused"!=e.get("sUploadStep")&&e.set({nRealPostTime:(e.get("nRealPostTime")||0)+(new Date-t),nRealPostSize:(e.get("nRealPostSize")||0)+n})},onprocess:function(e){e.get("bChipFile")&&e.get("nUploadedSize")&&!e.get("bIsUptoFtnForNormal")&&this.chipUpdateFileSize_(e),t.onprocess.call(this,e)}}};function i(t){var n=r.FlashPopup.prototype,i=r.FlashPopupMail.prototype;return u.extend(function o(e){return u.extend(a.getChipLib(e),{initFlashBeforeUpload_:function(e){var t=this.getFlash(),n="http://"+(e.get("sDns")||e.get("sIP"))+":"+e.get("nPort");t.setFTNUkey(e.get("sKey")),t.setFTNFilekey(e.get("sSHA")),t.setFTNFileIndexID(e.get("sFid")),t.setFTNUploadFileSize(e.get("nSize")),t.setFTNUploadDomain(n),t.setSendEmptyPackage&&t.setSendEmptyPackage(u.isBrowser("chrome")&&104857600<e.get("nSize")),e.oCfg=u.extend(e.oCfg||{},{sUrl:n+"/ftn_handler/"})}})}(t),a.getH5SafeLib(t),{init_:function(e){t.init_.call(this,e)},onprocess:function(e){!1!==this.isFileModif_(e)&&(this.chipUpdateFileSize_(e),t.onprocess.apply(this,arguments))},doChipFileSign_:function(e){var t=this.getFlash();this.safeStartUpdate_(e),e.set({nSignChunkSum:Math.ceil(e.get("nSize")/this.nSignFileBlockSize),nCurrentSignChunk:0}),e.fCancel=function(){t.cancelFTNUpload(),e.bCancelH5_=!0},debug("begin cal md5:"+(new Date).getTime()),t.ftnUploadInit(),t.setFTNFileIndexID(e.get("sFid")),this._doLoadFileData(e,0)},doChipUpload_:function(e){var t=this.getFlash();this.initFlashBeforeUpload_(e),e.fCancel=function(){t.cancelFTNUpload(),e.bCancelH5_=!0},this._doLoadFileData(e,0)},getFileSliceFunc_:function(){if(!this._mfFileSlice)try{this._mfFileSlice=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice}catch(e){return!1}return this._mfFileSlice},detect:function(){return t.detect.apply(this,arguments)&&n.detect.apply(this,arguments)&&"FileReader"in window&&"File"in window&&this.getFileSliceFunc_()},initFlash_:function(e){n._initFlash.apply(this,arguments),e.clearUploadVars(),e.addUploadVar("timeout",6e4),this.nSignFileBlockSize=2097152,e.ftnUploadInit(),this.nFlashFileIndex=0,this.nFTNUploadBlockSize=e.getFTNUploadBlockSize()||131072},getFlash:n.getFlash,insertFlashElem_:n.insertFlashElem_,initFlashDOM_:function(e){var t=this.oCfg.oContainer,n=u.getDomWin(t),i=n.document,o=i.createElement("div");this.insertFlashElem_(u.extend({oWin:n,oFlashDOMCfg:{nHeight:"1px",nWidth:"1px",nTop:"-9999px",nLeft:"-9999px"},insertHTML:function(e){o.innerHTML=e},onerror:function(){i.body.removeChild(o)}},e||{})),i.body.appendChild(o)},onFlashProcess_:i.onFlashProcess_,onFlashComplete_:function(e){var t=this.getFile(this.getFlashFileId(e));t&&this.onChipUploadEnd_(t),i.onFlashComplete_.apply(this,arguments)},onFlashError_:i.onFlashError_,uploadFileOnComplete_:i.uploadFileOnComplete_,onFlashLoadH5FileData_:function(e,t){this._onFlashGetFileData.apply(this,arguments)},onFlashFileSigning_:function(e,t){var n=this.getFile(this.getFlashFileId(e));n&&this.getFlash().onChipFileSigning_(n,t)},getFlashObjCallBack_:function(){var e=this,t=i.getFlashObjCallBack_.apply(e,arguments);return delete t.onSelect,t.onLoadFileData=function(){e.onFlashLoadH5FileData_.apply(e,arguments)},t.onFileSigning=function(){e.onFlashFileSigning_.apply(e,arguments)},t},getFlashFileId:n.getFlashFileId,parseH5File_:function(){var e=this;return _oFile=t.parseH5File_.apply(e,arguments),_oFile.set("sFid",++e.nFlashFileIndex+""),e.moFlashFileMap_=e.moFlashFileMap_||{},e.moFlashFileMap_[e.nFlashFileIndex]=_oFile.get("sId"),_oFile},_onFlashGetFileData:function(e,t){var n=this.getFile(this.getFlashFileId(e));n&&n.get("nSize")&&this._doLoadFileData(n,t)},_doLoadFileData:function(e,t){if(!e.bCancelH5_){var n,i,o=this;"signing"==e.get("sUploadStep")?(n=e.get("nCurrentSignChunk")*o.nSignFileBlockSize,i=Math.min(n+o.nSignFileBlockSize,e.get("nSize")),o.getH5FileReader_(e,n,i,o._onLoadSignFileData)):(n=parseInt(t,10),i=Math.min(n+o.nFTNUploadBlockSize,e.get("nSize")),o.getH5FileReader_(e,n,i,o._onLoadUploadFileData))}},_onLoadSignFileData:function(e,t,n,i){if(!t.bCancelH5_){var o=this.getFlash(),a=t.get("nCurrentSignChunk"),r=t.get("nSignChunkSum");e.target.result&&e.target.result.length&&o.ftnSignUpdateDataURL(e.target.result),t.set("nCurrentSignChunk",++a),a<=t.get("nSignChunkSum")?(this._doLoadFileData(t),this.onChipFileSigning_(t,a/r*100)):(debug("end cal md5:"+(new Date).getTime()),this.onChipFileSignEnd_(t,{sMD5:o.ftnSignMD5Result(),sSHA:o.ftnSignSHA1Result()}))}},_onLoadUploadFileData:function(e,t,n,i){if(!t.bCancelH5_){var o=this.getFlash();e.target.result&&e.target.result.length&&o.uploadDataToFTNWithOffset(e.target.result,n)}},getH5FileReader_:function(n,t,i,o){var e,a=this,r=n.oH5File;function s(){e.onload=e.onerror=null,l?(e.readAsDataURL(a.getFileSliceFunc_().call(r,0,1)),e=null):l=e,r=null}l?(e=l,l=null):e=new FileReader,e.onload=function(e){s(),o.call(a,e,n,t,i)},e.onerror=function(e){s();var t=e.target.error;a.onerror(n.set({nUpType:a.getFlash().getCurUptype(),sError:a.err("internal","77702",t.code,t.name)}))},e.readAsDataURL(a.getFileSliceFunc_().call(r,t,i))},cancel:i.cancel})}a.getChipLib=t;var o=function(){return 209715200};a.oUtil.getFlashMaxFileSizeForBurst=o,a.createCom("FlashPopupFMail",function(r){return u.extend(t(r),{detect:function(){return r.detect.apply(this,arguments)},nMaxFileSizeForBurst:209715200,onselect:function(e){for(var t,n=this,i=function(){return this.oCfg=u.extend(this.oCfg||{},{utype:16}),n.uploadInChip(this.set("bFtnFile",!0))},o=e.length;o--;)(t=e[o]).get("nSize")<n.nMaxFileSizeForBurst&&(t.uploadToFtn=i,n.isUptoFtnForNormal()&&(t.upload=function(){return this.oCfg=u.extend(this.oCfg||{},{utype:18}),n.uploadInChip(this.set("bIsUptoFtnForNormal",!0))}));r.onselect.apply(n,arguments)},getFlashObjCallBack_:function(){var o=this,e=r.getFlashObjCallBack_.apply(o,arguments);e.onFTNSignFileFinish=function(e,t,n){var i=o.getFile(o.getFlashFileId(e));i&&o.onChipFileSignEnd_(i,{sMD5:t,sSHA:n})};var a=e.onError;e.onError=function(e,t,n,i){a.apply(o,arguments)};var n=e.onComplete;return e.onComplete=function(e){var t=o.getFile(o.getFlashFileId(e));t&&o.onChipUploadEnd_(t),n.apply(o,arguments)},e.onFileSigning=function(e,t){var n=o.getFile(o.getFlashFileId(e));n&&o.onChipFileSigning_(n,t)},e},doChipFileSign_:function(e){var t=this,n=t.getFlash();e.fCancel=function(){t.getFlash().cancelFTNUpload()},n.ftnUploadInit(),n.ftnSignFile(e.get("sFid"))},doChipUpload_:function(e){var t=this.getFlash(),n="http://"+e.get("sIP");t.setFTNUkey(e.get("sKey")),t.setFTNFilekey(e.get("sSHA")),t.setFTNFileIndexID(e.get("sFid")),t.setFTNUploadFileSize(e.get("nSize")),t.setFTNUploadDomain(n),e.fCancel=function(){t.cancelFTNUpload()},e.oCfg=u.extend(e.oCfg||{},{sUrl:n+"/ftn_handler/"}),t.uploadFileToFTN()}})},"FlashPopupMail"),a.createCom("FlashH5PopupMail",function(t){var e=i(t);return u.extend(a.getMailLib(t),a.getFtnLib(t),e,{init_:function(){var t=this;e.init_.apply(this,arguments),t.isUptoFtnForNormal()&&(t.upload=function(e){return e.oCfg=u.extend(e.oCfg||{},{utype:18}),t.uploadInChip(e.set("bIsUptoFtnForNormal",!0))})},uploadToFtn:function(e){return e.oCfg=u.extend(e.oCfg||{},{utype:15}),this.uploadInChip(e.set("bFtnFile",!0))},_initContainer:function(){var e=this;t._initContainer.apply(e,arguments),e.initFlashDOM_({onsuccess:function(){e.oCfg.oContainer.firstChild.style.zIndex=2}})},initFlash_:function(){return e.initFlash_.apply(this,arguments)}})},"Html5Popup");a.createCom("FlashH5DragMailCROS",function(e){var n=i(e);return u.extend({},n,{initFlash_:function(){var t=this;return t._onDrop=function(e){e.dataTransfer.files.length&&t.addH5Files_(e.dataTransfer.files,function(e){u.E(e,function(e){e.uploadToFtn=function(){return this.oCfg=u.extend(this.oCfg||{},{utype:17}),t.uploadInChip(this.set("bFtnFile",!0))},t.isUptoFtnForNormal()&&(e.upload=function(){return this.oCfg=u.extend(this.oCfg||{},{utype:18}),t.uploadInChip(this.set("bIsUptoFtnForNormal",!0))})}),t.onselect(e)})},n.initFlash_.apply(t,arguments)},_initContainer:function(){e._initContainer.apply(this,arguments)}})},"Html5DragCROS")}(QMFileAdaptor),function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}o.m=n,o.c=i,o.p="",o(0)}([function(e,t,o){!function(g){var a,v,e=QMFileUpload,t=e.components,r=o(2),s=o(6),l=o(8),c=o(9),m=o(10);function u(){!function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}o.m=n,o.c=i,o.p="",o(0)}({0:function(e,t,n){var i=n(12),o=new(n(13)),a=new i.YaMD5,r={reset:function(){o.reset(),a.start()},chunkMD5:function(e){return a.start().appendByteArray(new Uint8Array(e)).end()},appendMD5:function(e){return e.state?a.setState(e.state):a.start(),a.appendByteArray(new Uint8Array(e.chunk)).getState()},getMD5:function(e){return a.setState(e).end()},chunkSHA1:function(e){return o.digest(e)},appendSHA1:function(e){return e.state?o.setState(e.state):o.reset(),o.append(e.chunk),o.getState()},getSHA1:function(e){return o.setState(e),o.end()}},l=new FileReader;self.addEventListener("message",function(n){var i=n.data;function t(){var e=r[i.type](i.data);delete n;var t=e&&(e.state||e.heap);self.postMessage({type:"done",data:e},t&&[t])}"appendSHA1"==i.type||"appendMD5"==i.type?function s(e,t,n){function i(e){r(),t(e.target.result)}function o(e){r(),n(e.target.error)}function a(e){r(),n(e.target.error)}function r(){delete e,l.removeEventListener("load",i),l.removeEventListener("abort",o),l.removeEventListener("error",a)}l.addEventListener("load",i),l.addEventListener("abort",o),l.addEventListener("error",a),l.readAsArrayBuffer(e)}(i.data.chunk||i.data,function(e){i.data.chunk?i.data.chunk=e:i.data=e,t()},function(e){self.postMessage({type:"retry",data:e.message})}):t()}),self.postMessage({type:"ready"})},12:function(e,t){!function(e){"use strict";var c=function(e,t){var n=e[0],i=e[1],o=e[2],a=e[3];i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&o|~i&a)+t[0]-680876936|0)<<7|n>>>25)+i|0)&i|~n&o)+t[1]-389564586|0)<<12|a>>>20)+n|0)&n|~a&i)+t[2]+606105819|0)<<17|o>>>15)+a|0)&a|~o&n)+t[3]-1044525330|0)<<22|i>>>10)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&o|~i&a)+t[4]-176418897|0)<<7|n>>>25)+i|0)&i|~n&o)+t[5]+1200080426|0)<<12|a>>>20)+n|0)&n|~a&i)+t[6]-1473231341|0)<<17|o>>>15)+a|0)&a|~o&n)+t[7]-45705983|0)<<22|i>>>10)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&o|~i&a)+t[8]+1770035416|0)<<7|n>>>25)+i|0)&i|~n&o)+t[9]-1958414417|0)<<12|a>>>20)+n|0)&n|~a&i)+t[10]-42063|0)<<17|o>>>15)+a|0)&a|~o&n)+t[11]-1990404162|0)<<22|i>>>10)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&o|~i&a)+t[12]+1804603682|0)<<7|n>>>25)+i|0)&i|~n&o)+t[13]-40341101|0)<<12|a>>>20)+n|0)&n|~a&i)+t[14]-1502002290|0)<<17|o>>>15)+a|0)&a|~o&n)+t[15]+1236535329|0)<<22|i>>>10)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&a|o&~a)+t[1]-165796510|0)<<5|n>>>27)+i|0)&o|i&~o)+t[6]-1069501632|0)<<9|a>>>23)+n|0)&i|n&~i)+t[11]+643717713|0)<<14|o>>>18)+a|0)&n|a&~n)+t[0]-373897302|0)<<20|i>>>12)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&a|o&~a)+t[5]-701558691|0)<<5|n>>>27)+i|0)&o|i&~o)+t[10]+38016083|0)<<9|a>>>23)+n|0)&i|n&~i)+t[15]-660478335|0)<<14|o>>>18)+a|0)&n|a&~n)+t[4]-405537848|0)<<20|i>>>12)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&a|o&~a)+t[9]+568446438|0)<<5|n>>>27)+i|0)&o|i&~o)+t[14]-1019803690|0)<<9|a>>>23)+n|0)&i|n&~i)+t[3]-187363961|0)<<14|o>>>18)+a|0)&n|a&~n)+t[8]+1163531501|0)<<20|i>>>12)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i&a|o&~a)+t[13]-1444681467|0)<<5|n>>>27)+i|0)&o|i&~o)+t[2]-51403784|0)<<9|a>>>23)+n|0)&i|n&~i)+t[7]+1735328473|0)<<14|o>>>18)+a|0)&n|a&~n)+t[12]-1926607734|0)<<20|i>>>12)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i^o^a)+t[5]-378558|0)<<4|n>>>28)+i|0)^i^o)+t[8]-2022574463|0)<<11|a>>>21)+n|0)^n^i)+t[11]+1839030562|0)<<16|o>>>16)+a|0)^a^n)+t[14]-35309556|0)<<23|i>>>9)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i^o^a)+t[1]-1530992060|0)<<4|n>>>28)+i|0)^i^o)+t[4]+1272893353|0)<<11|a>>>21)+n|0)^n^i)+t[7]-155497632|0)<<16|o>>>16)+a|0)^a^n)+t[10]-1094730640|0)<<23|i>>>9)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i^o^a)+t[13]+681279174|0)<<4|n>>>28)+i|0)^i^o)+t[0]-358537222|0)<<11|a>>>21)+n|0)^n^i)+t[3]-722521979|0)<<16|o>>>16)+a|0)^a^n)+t[6]+76029189|0)<<23|i>>>9)+o|0,i=((i+=((o=((o+=((a=((a+=((n=((n+=(i^o^a)+t[9]-640364487|0)<<4|n>>>28)+i|0)^i^o)+t[12]-421815835|0)<<11|a>>>21)+n|0)^n^i)+t[15]+530742520|0)<<16|o>>>16)+a|0)^a^n)+t[2]-995338651|0)<<23|i>>>9)+o|0,i=((i+=((a=((a+=(i^((n=((n+=(o^(i|~a))+t[0]-198630844|0)<<6|n>>>26)+i|0)|~o))+t[7]+1126891415|0)<<10|a>>>22)+n|0)^((o=((o+=(n^(a|~i))+t[14]-1416354905|0)<<15|o>>>17)+a|0)|~n))+t[5]-57434055|0)<<21|i>>>11)+o|0,i=((i+=((a=((a+=(i^((n=((n+=(o^(i|~a))+t[12]+1700485571|0)<<6|n>>>26)+i|0)|~o))+t[3]-1894986606|0)<<10|a>>>22)+n|0)^((o=((o+=(n^(a|~i))+t[10]-1051523|0)<<15|o>>>17)+a|0)|~n))+t[1]-2054922799|0)<<21|i>>>11)+o|0,i=((i+=((a=((a+=(i^((n=((n+=(o^(i|~a))+t[8]+1873313359|0)<<6|n>>>26)+i|0)|~o))+t[15]-30611744|0)<<10|a>>>22)+n|0)^((o=((o+=(n^(a|~i))+t[6]-1560198380|0)<<15|o>>>17)+a|0)|~n))+t[13]+1309151649|0)<<21|i>>>11)+o|0,i=((i+=((a=((a+=(i^((n=((n+=(o^(i|~a))+t[4]-145523070|0)<<6|n>>>26)+i|0)|~o))+t[11]-1120210379|0)<<10|a>>>22)+n|0)^((o=((o+=(n^(a|~i))+t[2]+718787259|0)<<15|o>>>17)+a|0)|~n))+t[9]-343485551|0)<<21|i>>>11)+o|0,e[0]=n+e[0]|0,e[1]=i+e[1]|0,e[2]=o+e[2]|0,e[3]=a+e[3]|0},u=[],t=function(){this._dataLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._bufferLength=0,this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()},n=new Int32Array([1732584193,-271733879,-1732584194,271733878]),d=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t.prototype.appendStr=function(e){for(var t,n=this._buffer8,i=this._buffer32,o=this._bufferLength,a=0;a<e.length;a++){if((t=e.charCodeAt(a))<128)n[o++]=t;else if(t<2048)n[o++]=192+(t>>>6),n[o++]=63&t|128;else if(t<55296||56319<t)n[o++]=224+(t>>>12),n[o++]=t>>>6&63|128,n[o++]=63&t|128;else{if(1114111<(t=1024*(t-55296)+(e.charCodeAt(++a)-56320)+65536))throw"Unicode standard supports code points up to U+10FFFF";n[o++]=240+(t>>>18),n[o++]=t>>>12&63|128,n[o++]=t>>>6&63|128,n[o++]=63&t|128}64<=o&&(this._dataLength+=64,c(this._state,i),o-=64,i[0]=i[16])}return this._bufferLength=o,this},t.prototype.appendAsciiStr=function(e){for(var t,n=this._buffer8,i=this._buffer32,o=this._bufferLength,a=0;;){for(t=Math.min(e.length-a,64-o);t--;)n[o++]=e.charCodeAt(a++);if(o<64)break;this._dataLength+=64,c(this._state,i),o=0}return this._bufferLength=o,this},t.prototype.appendByteArray=function(e){for(var t,n=this._buffer8,i=this._buffer32,o=this._bufferLength,a=0;;){for(t=Math.min(e.length-a,64-o);t--;)n[o++]=e[a++];if(o<64)break;this._dataLength+=64,c(this._state,i),o=0}return this._bufferLength=o,this},t.prototype.getState=function(){return{state:this._state.buffer.slice(0),dataLength:this._dataLength,buffer:this._buffer.slice(0),bufferLength:this._bufferLength}},t.prototype.setState=function(e){return this._state.set(new Int32Array(e.state)),this._dataLength=e.dataLength,this._buffer32.set(new Uint32Array(e.buffer)),this._bufferLength=e.bufferLength,this},t.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(n),this},t.prototype.end=function(e){var t=this._bufferLength;this._dataLength+=t;var n=this._buffer8;n[t]=128,n[t+1]=n[t+2]=n[t+3]=0;var i=this._buffer32,o=1+(t>>2);i.set(d.subarray(o),o),55<t&&(c(this._state,i),i.set(d));var a=8*this._dataLength;if(a<=4294967295)i[14]=a;else{var r=a.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(r[2],16),l=parseInt(r[1],16)||0;i[14]=s,i[15]=l}return c(this._state,i),e?this._state:function(e){for(var t,n,i,o="0123456789abcdef",a=u,r=0;r<4;r++)for(n=8*r,t=e[r],i=0;i<8;i+=2)a[1+n+i]=o.charAt(15&t),t>>>=4,a[0+n+i]=o.charAt(15&t),t>>>=4;return a.join("")}(this._state)};var i=new t;t.hashStr=function(e,t){return i.start().appendStr(e).end(t)},t.hashAsciiStr=function(e,t){return i.start().appendAsciiStr(e).end(t)},"5d41402abc4b2a76b9719d911017c592"!==t.hashStr("hello")&&console.error("YaMD5> this javascript engine does not support YaMD5. Sorry."),"object"==typeof e&&(e.YaMD5=t)}(this)},13:function(e,t,n){!function(){e.exports=a;var c=function(e){for(e+=9;0<e%64;e+=1);return e},u=function(e,t){var n=new Uint8Array(e.buffer),i=t%4,o=t-i;switch(i){case 0:n[3+o]=0;case 1:n[2+o]=0;case 2:n[1+o]=0;case 3:n[0+o]=0}for(var a=1+(t>>2);a<e.length;a++)e[a]=0},d=function(e,t,n){e[t>>2]|=128<<24-(t%4<<3),e[14+(2+(t>>2)&-16)]=n/(1<<29)|0,e[15+(2+(t>>2)&-16)]=n<<3},i=function(e){var t,n,i="0123456789abcdef",o="",a=new Uint8Array(e);for(t=0;t<a.length;t++)n=a[t],o+=i.charAt(n>>4&15)+i.charAt(n>>0&15);return o},o=function(e){var t;if(e<=65536)return 65536;if(e<16777216)for(t=65536;t<e;t<<=1);else for(t=16777216;t<e;t+=16777216);return t},f=function(e,t){var n=new Int32Array(e,t+320,5),i=new Int32Array(5),o=new DataView(i.buffer);return o.setInt32(0,n[0],!1),o.setInt32(4,n[1],!1),o.setInt32(8,n[2],!1),o.setInt32(12,n[3],!1),o.setInt32(16,n[4],!1),i};function a(e){"use strict";var l={};if(0<(e=e||65536)%64)throw new Error("Chunk size must be a multiple of 128 bit");function r(){l.offset=0;var e=new Int32Array(l.heap,l.padMaxChunkLen+320,5);e[0]=1732584193,e[1]=-271733879,e[2]=-1732584194,e[3]=271733878,e[4]=-1009589776}function s(e,t,n,i){var o=i%4,a=(n+o)%4,r=n-a;switch(o){case 0:l.h8[i]=e[t+3];case 1:l.h8[i+1-(o<<1)|0]=e[t+2];case 2:l.h8[i+2-(o<<1)|0]=e[t+1];case 3:l.h8[i+3-(o<<1)|0]=e[t]}if(!(n<a+o)){for(var s=4-o;s<r;s=s+4|0)l.h32[i+s>>2|0]=e[t+s]<<24|e[t+s+1]<<16|e[t+s+2]<<8|e[t+s+3];switch(a){case 3:l.h8[i+r+1|0]=e[t+r+2];case 2:l.h8[i+r+2|0]=e[t+r+1];case 1:l.h8[i+r+3|0]=e[t+r]}}}l.offset=0,l.maxChunkLen=e,l.padMaxChunkLen=c(e),l.heap=new ArrayBuffer(o(l.padMaxChunkLen+320+20)),l.h32=new Int32Array(l.heap),l.h8=new Int8Array(l.heap),l.core=new a._core({Int32Array:Int32Array},{},l.heap),r();var t=this.rawDigest=function(e){var t=e.byteLength;r(),e=new Uint8Array(e);for(var n=l.maxChunkLen,i=0;i+n<t;i+=n)s(e,i,n,0),l.core.hash(n,l.padMaxChunkLen);var o=c(n=t-i),a=new Int32Array(l.heap,0,o>>2);return s(e,i,n,0),u(a,n),d(a,n,t),l.core.hash(o,l.padMaxChunkLen),f(l.heap,l.padMaxChunkLen)};this.digest=function(e){return i(t(e).buffer)};this.reset=function(){r()};this.append=function(e){var t=0,n=e.byteLength,i=l.offset%l.maxChunkLen;for(e=new Uint8Array(e),l.offset+=n;t<n;){var o=Math.min(n-t,l.maxChunkLen-i);s(e,t,o,i),t+=o,(i+=o)===l.maxChunkLen&&(l.core.hash(l.maxChunkLen,l.padMaxChunkLen),i=0)}};var n=this.rawEnd=function(){var e=l.offset,t=e%l.maxChunkLen,n=c(t),i=new Int32Array(l.heap,0,n>>2);u(i,t),d(i,t,e),l.core.hash(n,l.padMaxChunkLen);var o=f(l.heap,l.padMaxChunkLen);return r(),o};this.end=function(){return i(n().buffer)},this.getState=function(){return{offset:l.offset,maxChunkLen:l.maxChunkLen,padMaxChunkLen:l.padMaxChunkLen,heap:l.heap.slice(0)}},this.setState=function(e){l.offset=e.offset,l.maxChunkLen=e.maxChunkLen,l.padMaxChunkLen=e.padMaxChunkLen,l.h32.set(new Int32Array(e.heap))}}a._core=function(e,t,n){var _=new e.Int32Array(n);return{hash:function g(e,t){e|=0;var n=0,i=0,o=0,a=0,r=0,s=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0,h=0;for(o=0|_[320+(t|=0)>>2],r=0|_[t+324>>2],l=0|_[t+328>>2],u=0|_[t+332>>2],f=0|_[t+336>>2],n=0;(0|n)<(0|e);n=n+64|0){for(a=o,s=r,c=l,d=u,p=f,i=0;(0|i)<64;i=i+4|0)m=((o<<5|o>>>27)+(r&l|~r&u)|0)+(1518500249+((h=0|_[n+i>>2])+f|0)|0)|0,f=u,u=l,l=r<<30|r>>>2,r=o,o=m,_[e+i>>2]=h;for(i=e+64|0;(0|i)<(e+80|0);i=i+4|0)m=((o<<5|o>>>27)+(r&l|~r&u)|0)+(1518500249+((h=(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])<<1|(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])>>>31)+f|0)|0)|0,f=u,u=l,l=r<<30|r>>>2,r=o,o=m,_[i>>2]=h;for(i=e+80|0;(0|i)<(e+160|0);i=i+4|0)m=((o<<5|o>>>27)+(r^l^u)|0)+(1859775393+((h=(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])<<1|(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])>>>31)+f|0)|0)|0,f=u,u=l,l=r<<30|r>>>2,r=o,o=m,_[i>>2]=h;for(i=e+160|0;(0|i)<(e+240|0);i=i+4|0)m=((o<<5|o>>>27)+(r&l|r&u|l&u)|0)+(((h=(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])<<1|(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])>>>31)+f|0)-1894007588|0)|0,f=u,u=l,l=r<<30|r>>>2,r=o,o=m,_[i>>2]=h;for(i=e+240|0;(0|i)<(e+320|0);i=i+4|0)m=((o<<5|o>>>27)+(r^l^u)|0)+(((h=(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])<<1|(_[i-12>>2]^_[i-32>>2]^_[i-56>>2]^_[i-64>>2])>>>31)+f|0)-899497514|0)|0,f=u,u=l,l=r<<30|r>>>2,r=o,o=m,_[i>>2]=h;o=o+a|0,r=r+s|0,l=l+c|0,u=u+d|0,f=f+p|0}_[t+320>>2]=o,_[t+324>>2]=r,_[t+328>>2]=l,_[t+332>>2]=u,_[t+336>>2]=f}}}}()}})}var d=location.protocol+"//"+location.hostname+"/zh_CN/htmledition/js_biz/com/kits/qmfileupload/js/h5_chip/dist/hash_worker.js";function n(n){var o=t.Html5PopupMail.prototype;return g.extend(e.getChipLib(n),e.getH5SafeLib(n),{nConcurrent:1,nReaderNum:2,nHashWorkNum:2,nMaxRetryNum:100,nMaxSingleRetryNum:3,nSignFileBlockSize:524288,nUploadFileBlockSize:524288,nCacheThreshold:3,init_:function(){if(n.init_.apply(this,arguments),!a){a=new r,v=new s,a.PRIORITY=v.PRIORITY={send:0,send_read:0,block_hash:0,file_sha1:1,file_md5:2,pre_read_file_hash:3,pre_block_hash:3};for(var e=this.nReaderNum;e--;)a.fork();var t="";window.goJsConlog&&(t=["var noof=function(){},","$_home_qspace_dev_tools_codeSyncFiles_webmail_QQMail_tmp_js_ascii__qmtool_Log= noof,","goJsConlog;goJsConlog={addJslevel:noof,subJslevel:noof};\n"].join("")),g.isBrowser("edge")||g.isBrowser("ie")||g.isBrowser("trident")?_sWorkerUrl=d:_sWorkerUrl=window.URL.createObjectURL(new Blob([u.toString()+"\n"+t+u.name+"();"]));for(e=this.nHashWorkNum;e--;)v.fork(_sWorkerUrl);g.isBrowser("edge")||g.isBrowser("ie")||window.URL.revokeObjectURL(_sWorkerUrl)}},detect:function(){var e;if(e="function"==typeof getTop?getTop():{goExpers:{h5cJsUpload:!0}},"function"==typeof Array.prototype.every&&e.goExpers&&e.goExpers.h5cJsUpload&&o.detect.apply(this,arguments)&&"Promise|FileReader|DataView|ArrayBuffer|Uint8Array|URL|Blob".split("|").every(function(e){return e in window}))try{var t;if(g.isBrowser("edge")||g.isBrowser("ie"))t=new Worker(d);else{var n=window.URL.createObjectURL(new Blob([""]));t=new Worker(n),window.URL.revokeObjectURL(n)}return t&&t.terminate(),!0}catch(i){console.log(i)}return!1},uploadToFtn:function(e){return this.uploadInChip(e.set("bFtnFile",!0))},upload:function(e){return this.isUptoFtnForNormal()?this.uploadInChip(e.set("bIsUptoFtnForNormal",!0)):n.upload.apply(this,arguments)},doChipFileSign_:function(e){this.safeStartUpdate_(e);var t=e.fCancel;e.fCancel=function(){e._oCurFileBlock&&e._oCurFileBlock.cancel(),t&&t.call(e)},this._realChipFileSign2(e)},_genFileBlock:function(e,t){var n=new c(a,v,e.oH5File.slice(t,t+this.nSignFileBlockSize));return n.__nOffset=t,n},_realChipFileSign2:function(s){var t,n,o,a,l=this,c=s.get("nSize"),u=0,d=0,f=Math.ceil(c/l.nSignFileBlockSize),p=2<f?2:f,m=1,r=0,h=g.speedNow();!function _(e){for(t=Promise.resolve(e),i=0;i<p;i++)if(n=o||l._genFileBlock(s,r),r+=l.nSignFileBlockSize,o=c<r?{}:l._genFileBlock(s,r),function(a,r,e){t=t.then(function(t){if(!s.bCancelH5_){t||(t=[]),s._oCurFileBlock=r;var e=Promise.all([r._hashHandle("","file_sha1",function i(e){return{data:{state:t[0],chunk:r.block},type:"appendSHA1"}},"file_sha1",!0),r._hashHandle("","file_md5",function o(e){return{data:{state:t[1],chunk:r.block},type:"appendMD5"}},"file_md5",!0)]),n=g.speedNow();return e.then(function(){var e=g.speedNow()-n;d++,100<e&&u++,r.free(),l.onChipFileSigning_(s,r.__nOffset/c*100-2)}),p==a+1&&m*p<f?e.then(function(e){m++,_(e)}):e}})["catch"](function(e){l._customInternalError(s,"fileHashError")})}(i,n),(m-1)*p+i+1==f){t.then(function(e){if(s._oCurFileBlock=null,u&&debug(["hash timeout:",(u/d*100).toFixed(6),"% ",u,"/",d].join("")),!s.bCancelH5_)return Promise.all([v.run(v.task({data:e[0],type:"getSHA1"})),v.run(v.task({data:e[1],type:"getMD5"}))])}).then(function(e){a=g.speedNow();var t=c/1024/1024/(a-h)*1e3;debug(["[",s.get("sName"),"]\u626b\u63cf:",t,"M/S"].join("")),(new Image).src=536870912<c?"/qy_mng_logic/reportKV?type=BizUpload&itemName=h5_scan_speed_b&value="+parseInt(t,10):"/qy_mng_logic/reportKV?type=BizUpload&itemName=h5_scan_speed_s&value="+parseInt(t,10),window.console&&console.log("sSHA:",e[0]),window.console&&console.log("sMD5:",e[1]),s.bCancelH5_||l.onChipFileSignEnd_(s,{sSHA:e[0],sMD5:e[1]})},function(e){l._customInternalError(s,"fileHashError")});break}}()},_realChipFileSign:function(s){for(var l=this,n=Promise.resolve(),c=s.get("nSize"),e=[],u=0,d=0,t=0;t<c;t+=l.nSignFileBlockSize)e.push(l._genFileBlock(s,t));var i,o=g.speedNow();e.forEach(function(a,e,t){var r=t[e+1]||{};n=n.then(function(t){if(!s.bCancelH5_){t||(t=[]),s._oCurFileBlock=a,r.read&&r.read("pre_read_file_hash");var e=Promise.all([a.fileSha1(function i(e){return{data:{state:t[0],chunk:e},type:"appendSHA1"}}),a.fileMd5(function o(e){return{data:{state:t[1],chunk:e},type:"appendMD5"}})]),n=g.speedNow();return e.then(function(){var e=g.speedNow()-n;if(d++,100<e){u++;try{window.console&&console.log("[md5 timeout, offset:%s readcache:%s time:%d(%dms)]\n\tread:%s\n\tsha1:%s\n\tmd5%s",a.__nOffset,a.tasks.read.timing.start>n,n,e,a.tasks.read.speedReport(),a.tasks.file_sha1.speedReport(),a.tasks.file_md5.speedReport())}catch(t){}}a.free(),l.onChipFileSigning_(s,a.__nOffset/c*100-2)}),e}})}),e=null,n.then(function(e){if(s._oCurFileBlock=null,u&&debug(["hash timeout:",(u/d*100).toFixed(6),"% ",u,"/",d].join("")),!s.bCancelH5_)return Promise.all([v.run(v.task({data:e[0],type:"getSHA1"})),v.run(v.task({data:e[1],type:"getMD5"}))])}).then(function(e){i=g.speedNow(),debug(["[",s.get("sName"),"]\u626b\u63cf:",c/1024/1024/(i-o)*1e3,"M/S"].join("")),window.console&&console.log("sSHA:",e[0]),window.console&&console.log("sMD5:",e[1]),s.bCancelH5_||l.onChipFileSignEnd_(s,{sSHA:e[0],sMD5:e[1]})},function(e){l._customInternalError(s,"fileHashError")})},doChipUpload_:function(e){var t=new l(a,v,e.oH5File,this.nUploadFileBlockSize,this.nCacheThreshold);t.addCache(0,65536),e._mnStartUploadTime=+new Date,this._uploadFromOffset(e,t,0)},_uploadFromOffset:function(r,s,l,n){var c,u,d,f=this,p=+new Date;return s.fetch(l).then(function(e){if(c=g.speedNow(),u=e[0],!r.bCancelH5_){var t=e[0],n=e[1];return r._oCurFileBlock=e[2],d=e[2]._nResumeReadTime,f._requestFTN(r,l,t,n)}}).then(function(e){return f.setRealPostSize_(r,p,r._oCurFileBlock.block.size),e},function(e){throw f.setRealPostSize_(r,p,r._oCurFileBlock.block.size),e}).then(function(e){var t=g.speedNow(),n=0<d-p?d-p:0;if(window.console&&console.log("[%s] offset:%f, start:%f, request:%f, total:%f, read:%fms(%d%), md5:%fms(%d%), ajax:%fms(%d%)",u,l,p,c,t-p,n,n/(t-p)*100,c-p-n,(c-p-n)/(t-p)*100,t-c,(t-c)/(t-p)*100),!r.bCancelH5_){var i=l+r._oCurFileBlock.block.size;if(f.onprocess(r.set({nUploadPercent:i/r.get("nSize")*100,nUploadedSize:i})),!e.end){if(e.nextOffset>=r.get("nSize"))throw new Error("next offset overflow");if(e.nextOffset<=l){window.console&&console.log("[ftn\u56de\u4f20] next:",e.nextOffset,", ","cur:",l,", ","\u76f8\u5dee\uff1a",(l-e.nextOffset)/f.nUploadFileBlockSize,"\u7247");var o=(l-e.nextOffset)/f.nUploadFileBlockSize;(o>f.nCacheThreshold||o!=parseInt(o))&&s.resetCache(),r._mnCallBackTotalTime==undefined&&(r._mnCallBackTotalChip=0,r._mnCallBackTotalNum=0),r._mnCallBackTotalChip+=Number((l-e.nextOffset)/f.nUploadFileBlockSize),r._mnCallBackTotalNum++}return f._uploadFromOffset(r,s,e.nextOffset)}f.reportSuccDomain(r);var a=+new Date;debug(["\u603b\u8017\u65f6\uff1a",(a-r._mnStartUploadTime)/1e3,"s"].join("")),debug(["\u771f\u5b9e\u8bf7\u6c42\u8017\u65f6\uff1a",r._mnRealRequestTotalTime/1e3,"s"].join("")),debug(["\u771f\u5b9e\u8bf7\u6c42\u8017\u65f6\u5360\u6bd4\uff1a",r._mnRealRequestTotalTime/(a-r._mnStartUploadTime)*100,"%"].join("")),debug(["\u771f\u5b9e\u8bf7\u6c42\u6b21\u6570\uff1a",r._mnRealRequestTotalNum,"\u6b21"].join("")),debug(["\u771f\u5b9e\u4e0a\u4f20\u5927\u5c0f\uff1a",r.get("nRealPostSize")/1024/1024,"M"].join("")),debug(["[",r.get("sName"),"]\u4e0a\u4f20:",r.get("nRealPostSize")/1024/1024/(a-r._mnStartUploadTime)*1e3,"M/S"].join("")),debug(["\u5e73\u5747\u56de\u4f20\u7247\u6570\uff1a",r._mnCallBackTotalChip?r._mnCallBackTotalChip/r._mnCallBackTotalNum:0,"\u7247"].join("")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|uploadSucc",sid:g.getSid()}),f.oncomplete(r)}})["catch"](function(e){var t=r.get("nAutoUploadRetry")||0;n||(n=0),t<f.nMaxRetryNum&&n<f.nMaxSingleRetryNum?(r.set("nAutoUploadRetry",++t),debug("auto upload retry"),f._uploadFromOffset(r,s,l,n?n+1:1)):(/http,600/i.test(e.message)&&f.reportCustomError(r,{fileUploadProgress:l/r.get("nSize")*10}),f.nMaxRetryNum,f._parseError(r,e))})},_parseError:function(e,t){var n=this;"next offset overflow"==t.message?n._customInternalError(e,"nextOffsetOverFlow"):"http,"==t.message.substr(0,5)?n.onerror(e.set("sError",n.err("http",t.message.substr(5)))):/^[a-z]+,/i.test(t.message)?n.onerror(e.set("sError",t.message)):(debug(t),n.onerror(e.set("sError",n.err("unknow",709390))))},_requestFTN:function(e,t,n,i){var o;return o="function"==typeof getTop?getTop():{goExpers:{h5cJsUploadProxy:!0}},!/\.qq\.com$/.test(location.hostname)&&o.goExpers&&o.goExpers.h5cJsUploadProxy?this._requestFTNByAjaxProxy.apply(this,arguments):this._requestFTNByAjax.apply(this,arguments)},_requestFTNByAjaxProxy:function(s,l,c,u){var d=this;return new Promise(function(i,o){var e=new XMLHttpRequest,t=s.get("nPort"),n="http";"https:"==window.location.protocol&&(t="443",n="https");var a=n+"://"+(s.get("sDns")||s.get("sIP"))+":"+t+"/ftn_handler/";window.ftnurltolog=a,e.open("POST",a,!0),e.timeout=2e4,e.setRequestHeader("DATA-MD5",c),e.setRequestHeader("content-type","application/octet-stream"),e.setRequestHeader("Cache-Control","no-cache"),e.responseType="arraybuffer",window.addEventListener("message",function(e){!function n(e){try{i(m.parseFTNRespone(e))}catch(t){g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|parseFTNResponeError",sid:g.getSid()}),o(t)}}(e.data)},{once:!0}),e.onerror=function(){o(new Error("http,600")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror",sid:g.getSid()}),window.ftnurltolog&&g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror|"+window.ftnurltolog,sid:g.getSid()})},e.onabort=function(){o(new Error("http,700")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onabort",sid:g.getSid()})},e.ontimeout=function(){o(new Error("http,800")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|timeout",sid:g.getSid()})},e.upload.onprogress=function(e){e.lengthComputable&&d.onprocess(s.set("nUploadPercent",(e.loaded+l)/s.get("nSize")*100))};var r=m.genFTNRequestBody(s.get("sKey"),s.get("sSHA"),s.oH5File,u,l);document.getElementById("ajaxProxyIframe").contentWindow.postMessage({_sUrl:a,_asHash:c,_oSendAB:r},"*"),new Date})},_requestFTNByAjax:function(c,u,d,f){var p=this;return new Promise(function(n,i){var o,a,r=new XMLHttpRequest,e=c.get("nPort"),t="http";"https:"==window.location.protocol&&(e="443",t="https");var s=t+"://"+(c.get("sDns")||c.get("sIP"))+":"+e+"/ftn_handler/";window.ftnurltolog=s,r.open("POST",s,!0),r.timeout=2e4,r.setRequestHeader("DATA-MD5",d),r.setRequestHeader("content-type","application/octet-stream"),r.setRequestHeader("Cache-Control","no-cache"),r.responseType="arraybuffer",r.onload=function(){if(4==r.readyState)if(r.upload.onprogress=null,200==r.status){a=+new Date,c._mnRealRequestTotalTime==undefined&&(c._mnRealRequestTotalTime=0,c._mnRealRequestTotalNum=0),c._mnRealRequestTotalTime+=Number(a-o),c._mnRealRequestTotalNum++;try{n(m.parseFTNRespone(r.response))}catch(t){g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|parseFTNResponeError",sid:g.getSid()}),i(t)}}else{var e=r.getResponseHeader("User-ReturnCode");i(new Error(e?"internal,"+e:"http,"+r.status))}},r.onerror=function(){i(new Error("http,600")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror",sid:g.getSid()}),window.ftnurltolog&&g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror|"+window.ftnurltolog,sid:g.getSid()})},r.onabort=function(){i(new Error("http,700")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onabort",sid:g.getSid()})},r.ontimeout=function(){i(new Error("http,800")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|timeout",sid:g.getSid()})},r.upload.onprogress=function(e){e.lengthComputable&&p.onprocess(c.set("nUploadPercent",(e.loaded+u)/c.get("nSize")*100))};var l=m.genFTNRequestBody(c.get("sKey"),c.get("sSHA"),c.oH5File,f,u);r.send(l),o=+new Date})},_customInternalError:function(e,t){this.onerror(e.set("sError",this.err("internal",{nextOffsetOverFlow:200001,fileHashError:200002}[t]||709390)))},reportCustomError:function(e,t){e.get("nPort");"https:"==window.location.protocol||window.location.hostname.indexOf("webdev")},reportSuccDomain:function(e){["succdomain=",e.get("sIP")].join("")}})}e.createCom("H5CPopupMail",n,"Html5PopupMail"),e.createCom("H5CDragFMailCROS",n,"Html5DragCROS"),e.createCom("H5CDragFMail",n,"Html5DragMail")}(QMFileAdaptor)},,function(e,t,n){var i=n(3),o=n(4);function a(){this.queue=new i}a.prototype.PRIORITY={},a.prototype.fork=function(){this.queue.addWorker(new FileReader)},a.prototype.task=function(e,t){var n=this,i=new o(e,t);return i.result().then(function(){n.queue.removeTask(i)}),i},a.prototype.run=function(e,t){return this.queue.runTask(e,this.PRIORITY[t])},e.exports=a},function(e,t){function n(){this._tasksList=[],this._workers=[]}n.prototype.addWorker=function(e){if(e.__status__&&"ready"!=e.__status__)return console.warn("worker add twice");for(var t,n,i=0,o=this._tasksList.length;i<o;i++)if((n=this._tasksList[i])&&n.length)for(;t=n.shift();)if(this._runTask(e,t))return;e.__status__="ready",this._workers.push(e)},n.prototype._runTask=function(t,e){var n=this;return!!e.start(t)&&(e.result().then(function(){t.__status__="ready",n.addWorker(t)},function(e){return t.__status__="ready",n.addWorker(t),Promise.reject(e)}),t.__status__="running",n.removeWorker(t),!0)},n.prototype.findWorker=function(t){return this._workers.findIndex(function(e){return e===t})},n.prototype.removeWorker=function(t){this._workers=this._workers.filter(function(e){return e!==t})},n.prototype.runTask=function(e,t){return 0<this._workers.length?this._runTask(this._workers[0],e):this.insertTask(e,t),e.result()},n.prototype.insertTask=function(e,t){t&&(t=Number(t)),t||(t=0),(this._tasksList[t]||(this._tasksList[t]=[])).push(e),(e.__priority||(e.__priority=[])).push(t)},n.prototype.removeTask=function(t){for(var e=this._tasksList,n=e.length;n--;)e[n]&&(e[n]=e[n].filter(function(e){return t!==e}))},e.exports=n},function(e,t,n){var i=n(5);function o(e,t){this._type=t,this._rdBlock=e,i.call(this)}(o.prototype=i.proto()).handle_=function(r){var s=this;return new Promise(function(t,n){function e(e){a(),t(e.target.result)}function i(){a(),n(new Error("aborted"))}function o(e){a(),n(e)}function a(){delete s._rdBlock,r.removeEventListener("load",e),r.removeEventListener("abort",i),r.removeEventListener("error",o)}r.addEventListener("load",e),r.addEventListener("abort",i),r.addEventListener("error",o),r.readAsArrayBuffer(s._rdBlock)})},e.exports=o},function(e,t){function n(){var n=this;n.timing={},n._resolve=n._reject=null,n._step("init"),n._promise=new Promise(function(e,t){n._resolve=e,n._reject=t}).then(function(e){return n._step("start"),n.handle_(e)}),n._promise.then(function(){n._step("success")},function(e){return n._step("error"),Promise.reject(e)})}n.prototype.SPEED_TEST=!0,n.prototype.timeEnd=function(e){this.SPEED_TEST&&(this.timing[e]=+new Date)},n.prototype.speedReport=function(){var e=this.timing,t=e.success||e.error||e.aborted,n=t-e.init||1,i=e.start-e.init,o=t-e.start;return["[",this.__status__,"]"," init:",e.init," total:",n,"ms"," wait:",i,"ms(",(i/n*100).toFixed(2),"%)"," run:",o,"ms(",(o/n*100).toFixed(2),"%)"].join("")},n.prototype._step=function(e){this.__status__=e,this.timeEnd(e)},n.prototype.start=function(e){if(this._resolve){var t=this._resolve;return this._reject=this._resolve=null,t(e),!0}return!1},n.prototype.abort=function(e){if(this._reject){var t=this._reject;this._reject=this._resolve=null,!0!==e&&t(new Error("abort"))}this._step("aborted")},n.prototype.handle_=function(){},n.prototype.result=function(){return this._promise},n.proto=function(){function e(){}return e.prototype=this.prototype,new e},e.exports=n},function(e,t,n){var i=n(3),o=n(7);function a(){this.queue=new i}a.prototype.PRIORITY={},a.prototype.fork=function(t){var n=this;try{var i=new Worker(t)}catch(e){return console.log("init worker",e),e}i.addEventListener("message",function o(e){i.removeEventListener("message",o),"ready"==e.data.type&&n.queue.addWorker(i)}),i.addEventListener("error",function(e){console.log("worker err, %s err:%o",t,e),i.postMessage({type:"reset"})})},a.prototype.task=function(e){return new o(e)},a.prototype.run=function(e,t){return this.queue.runTask(e,this.PRIORITY[t])},e.exports=a},function(e,t,n){var i=n(5);function o(e){this._wkmsg=e,i.call(this)}(o.prototype=i.proto()).handle_=function(a){var r=this;return new Promise(function(t,n){function e(e){if("done"===e.data.type)o(),t(e.data.data);else if("retry"===e.data.type){if(r.nRetryCount=r.nRetryCount||0,4<r.nRetryCount)return debug(e.data.data),i(e.data.data);r.nRetryCount++,a.postMessage(r._wkmsg)}}function i(e){o(),n(e)}function o(){delete r._wkmsg,a.removeEventListener("message",e),a.removeEventListener("error",i)}a.addEventListener("message",e),a.addEventListener("error",i),a.postMessage(r._wkmsg)})},e.exports=o},function(e,t,n){var o=n(9);function i(e,t,n,i,o){this._workers=t,this._readers=e,this._chunkSize=i,this._file=n,this._cacheThreshold=o,this._caches={length:0}}i.prototype.fetch=function(e){var t=this._caches[e];return t||(console&&console.warn("no cache:%d",e),t=this.addCache(e,this._chunkSize)),this._cleanup(e),delete this._caches[e],this._runPrefetch(t._fetch_end),Promise.all([t.hash("block_hash"),t.read("send_read"),t])},i.prototype.addCache=function(e,t){var n=e+t,i=this._caches[e]=new o(this._readers,this._workers,this._file.slice(e,n));return this._caches.length++,i._fetch_start=e,i._fetch_end=n,i},i.prototype.rmCache=function(e){var t=this._caches[e];t&&t.cancel&&(t.cancel(),delete this._caches[e])},i.prototype._runPrefetch=function(e){var t=this;if(!(t._caches.length>t._cacheThreshold)){for(;e<t._file.size&&t._caches[e];)e+=t._chunkSize;e>=t._file.size||t._prefetch(e).then(function(){t._runPrefetch(e+t._chunkSize)})}},i.prototype._prefetch=function(e){return this.addCache(e,this._chunkSize).hash("pre_block_hash")},i.prototype._cleanup=function(e){var t=this._caches,n=0;for(var i in t)"length"!=i&&(i<e?this.rmCache(i):n++);t.length=n},i.prototype.resetCache=function(){this._caches={length:0}},e.exports=i},function(e,t){function n(e,t,n){this.__status__="init",this._readers=e,this._workers=t,this.block=n,this.tasks={}}function i(e){return{data:e,type:"chunkMD5"}}n.prototype.readAsBuffer=function(e,t){var n=this._readers.task(this.block,"toBuffer");return this.__status__="readAsBuffer",this._readers.run(n,e),n.result()},n.prototype.read=function(e,t){var n=this.tasks.read;return n&&!t||(n&&t&&n.abort(!0),n=this.tasks.read=this._readers.task(this.block)),this.__status__="read",this._readers.run(n,e),n.result()},n.prototype.free=function(){for(var e in delete this.tasks.read,this.tasks)this._workers.queue.removeTask(this.tasks[e]),delete this.tasks[e]},n.prototype.hash=function(e,t){return this._readAndHash("hash",i,e,t)},n.prototype.fileMd5=function(e,t){return this._hashRoute("file_md5",e,t)},n.prototype.fileSha1=function(e,t){return this._hashRoute("file_sha1",e,t)},n.prototype._hashHandle=function(e,t,n,i,o){var a=this.tasks[t];return a&&!o||(a&&o&&(a.abort(!0),delete this.tasks[t]),a=this.tasks[t]=this._workers.task(n(e))),this.__status__=t,this._workers.run(a,i),a.result()},n.prototype._readAndHash=function(t,n,i,o){var a=this,e=a.tasks[t];return!e||o?(e&&o&&(e.abort(!0),delete a.tasks[t]),a.read(i,!1).then(function(e){return a._nResumeReadTime=+new Date,a._hashHandle(e,t,n,i,o)})):(a._workers.run(e,i),e.result())},n.prototype._hashRoute=function(t,n,e){var i=this;return e instanceof Promise?e.then(function(e){return i._hashRoute(t,n,e)}):e?i._hashHandle(e,t,n,t,!0):i._readAndHash(t,n,t,!0)},n.prototype.cancel=function(){var e=this.tasks;for(var t in e)e[t]&&e[t].abort&&e[t].abort(!0),delete e[t]},e.exports=n},function(e,t){var o=2882377846;function h(e){for(var t=new ArrayBuffer(e.length/2),n=new Uint8Array(t),i=t.byteLength;i--;){var o=parseInt(e.substr(2*i,2),16);if(isNaN(o))throw new Error("parse hex err");n[i]=o}return t}function _(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e,!1),t}function g(e){var t=g.headABView;return t||(t=new DataView(new ArrayBuffer(16)),s(g.headABView=t,[o,1007,0])),t.setUint32(12,e,!1),t.buffer}function v(e,t,n){var i=v.bodyABLenView;i||(i=new DataView(new ArrayBuffer(20)),v.bodyABLenView=i);var o=r(e.size),a=r(t);return s(i,[o.low,a.low,n.byteLength,o.high,a.high]),i.buffer}var n=4294967295,a=n+1;function r(e){return{low:e&n,high:e/a|0}}function s(n,e,i){i||(i=0),e.forEach(function(e,t){n.setUint32(i+4*t,e,!1)})}t.genFTNRequestBody=function b(e,t,n,i,o){var a=h(e),r=_(a.byteLength),s=h(t),l=_(s.byteLength),c=v(n,o,i),u=c.byteLength+a.byteLength+s.byteLength+r.byteLength+l.byteLength+i.byteLength,d=g(u),f=new ArrayBuffer(u+d.byteLength),p=new Uint8Array(f),m=0;return[d,r,a,l,s,c,i].forEach(function(e){p.set(new Uint8Array(e),m),m+=e.byteLength}),p},t.parseFTNRespone=function l(e){var t=new DataView(e);if(t.getUint32(0,!1)!=o)throw new Error("Unknow response");var n=t.getUint32(4,!1);if(n)throw new Error("cgi,"+n);if(0==t.getUint8(16))return{nextOffset:function i(e,t){return e+(t||0)*a}(t.getUint32(17,!1),t.getUint32(21,!1))};if(1==t.getUint8(16))return{end:!0};throw new Error("Unknow status")}}]),function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}o.m=n,o.c=i,o.p="",o(0)}([function(at,e,o){!function(g){var r,v,e=QMFileUpload,s=e.components,l={},c=o(2),u=o(6),n=o(8),d=o(9),m=o(10);function f(){var e,m=void 0!==m?m:{},t={};for(e in m)m.hasOwnProperty(e)&&(t[e]=m[e]);m.arguments=[],m.thisProgram="./this.program",m.quit=function(e,t){throw t},m.preRun=[];var n,i,h=!(m.postRun=[]),_=!1;if(h="object"==typeof window,_="function"==typeof importScripts,n="object"==typeof process&&"function"==typeof require&&!h&&!_,i=!h&&!n&&!_,m.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var o,a,r="";function s(e){return m.locateFile?m.locateFile(e,r):r+e}if(n)r=__dirname+"/",m.read=function(e,t){var n;return o||(o=require("fs")),a||(a=require("path")),e=a.normalize(e),n=o.readFileSync(e),t?n:n.toString()},m.readBinary=function(e){var t=m.read(e,!0);return t.buffer||(t=new Uint8Array(t)),T(t.buffer),t},1<process.argv.length&&(m.thisProgram=process.argv[1].replace(/\\/g,"/")),m.arguments=process.argv.slice(2),void 0!==at&&(at.exports=m),process.on("uncaughtException",function(e){if(!(e instanceof Oe))throw e}),process.on("unhandledRejection",Be),m.quit=function(e){process.exit(e)},m.inspect=function(){return"[Emscripten Module object]"};else if(i)"undefined"!=typeof read&&(m.read=function(e){return read(e)}),m.readBinary=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(T("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?m.arguments=scriptArgs:void 0!==arguments&&(m.arguments=arguments),"function"==typeof quit&&(m.quit=function(e){quit(e)});else{if(!h&&!_)throw new Error("environment detection error");_?r=self.location.href:document.currentScript&&(r=document.currentScript.src),r=0!==r.indexOf("blob:")?r.substr(0,r.lastIndexOf("/")+1):"",m.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},_&&(m.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),m.readAsync=function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status||0==i.status&&i.response?t(i.response):n()},i.onerror=n,i.send(null)},m.setWindowTitle=function(e){document.title=e}}var l=m.print||("undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null),g=m.printErr||("undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||l);for(e in t)t.hasOwnProperty(e)&&(m[e]=t[e]);t=undefined,T("undefined"==typeof m.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),T("undefined"==typeof m.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),T("undefined"==typeof m.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),T("undefined"==typeof m.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead");var c=16;function u(e){T(!N);var t=U;return T((U=U+e+15&-16)<K,"not enough memory for static allocation - increase TOTAL_MEMORY"),t}function d(e,t){return t||(t=c),e=Math.ceil(e/t)*t}function f(e){f.shown||(f.shown={}),f.shown[e]||(f.shown[e]=1,g(e))}Ne=Ue=Pe=function(){Be("cannot use the stack before compiled code is ready to run, and has provided stack access")};var v={"f64-rem":function(e,t){return e%t},"debugger":function(){}};new Array(0);var b=!1;function T(e,t){e||Be("Assertion failed: "+t)}var p={stackSave:function(){Ne()},stackRestore:function(){Ue()},arrayToC:function(e){var t=Pe(e.length);return function n(e,t){T(0<=e.length,"writeArrayToMemory array must have a length (should be an array or typed array)"),k.set(e,t)}(e,t),t},stringToC:function(e){var t=0;if(null!==e&&e!==undefined&&0!==e){var n=1+(e.length<<2);I(e,t=Pe(n),n)}return t}},y={string:p.stringToC,array:p.arrayToC};function M(e,t,n,i,o){var a=function d(e){var t=m["_"+e];return T(t,"Cannot call unknown function "+e+", make sure it is exported"),t}(e),r=[],s=0;if(T("array"!==t,'Return type should not be "array".'),i)for(var l=0;l<i.length;l++){var c=y[n[l]];c?(0===s&&(s=Ne()),r[l]=c(i[l])):r[l]=i[l]}var u=a.apply(null,r);return u=function f(e){return"string"===t?w(e):"boolean"===t?Boolean(e):e}(u),0!==s&&Ue(s),u}function w(e,t){if(0===t||!e)return"";for(var n,i=0,o=0;T(e+o<K),i|=n=$[e+o>>0],(0!=n||t)&&(o++,!t||o!=t););t||(t=o);var a="";if(i<128){for(var r;0<t;)r=String.fromCharCode.apply(String,$.subarray(e,e+Math.min(t,1024))),a=a?a+r:r,e+=1024,t-=1024;return a}return function s(e){return S($,e)}(e)}var E="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):undefined;function S(e,t){for(var n=t;e[n];)++n;if(16<n-t&&e.subarray&&E)return E.decode(e.subarray(t,n));for(var i,o,a,r,s,l="";;){if(!(i=e[t++]))return l;if(128&i)if(o=63&e[t++],192!=(224&i))if(a=63&e[t++],(i=224==(240&i)?(15&i)<<12|o<<6|a:(r=63&e[t++],240==(248&i)?(7&i)<<18|o<<12|a<<6|r:(s=63&e[t++],248==(252&i)?(3&i)<<24|o<<18|a<<12|r<<6|s:(1&i)<<30|o<<24|a<<18|r<<12|s<<6|63&e[t++])))<65536)l+=String.fromCharCode(i);else{var c=i-65536;l+=String.fromCharCode(55296|c>>10,56320|1023&c)}else l+=String.fromCharCode((31&i)<<6|o);else l+=String.fromCharCode(i)}}function C(e,t,n,i){if(!(0<i))return 0;for(var o=n,a=n+i-1,r=0;r<e.length;++r){var s=e.charCodeAt(r);if(55296<=s&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++r);if(s<=127){if(a<=n)break;t[n++]=s}else if(s<=2047){if(a<=n+1)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(a<=n+2)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else if(s<=2097151){if(a<=n+3)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}else if(s<=67108863){if(a<=n+4)break;t[n++]=248|s>>24,t[n++]=128|s>>18&63,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(a<=n+5)break;t[n++]=252|s>>30,t[n++]=128|s>>24&63,t[n++]=128|s>>18&63,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s}}return t[n]=0,n-o}function I(e,t,n){return T("number"==typeof n,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),C(e,$,t,n)}"undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):undefined;function F(e){return e.replace(/__Z[\w\d_]+/g,function(e){var t=function n(e){return f("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),e}(e);return e===t?e:t+" ["+e+"]"})}function A(){var e=function n(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}();return m.extraStackTrace&&(e+="\n"+m.extraStackTrace()),F(e)}var x,k,$,D,R,P,U,N,O,L,H,B,W,Q=65536,j=16777216;function X(){m.HEAP8=k=new Int8Array(x),m.HEAP16=D=new Int16Array(x),m.HEAP32=R=new Int32Array(x),m.HEAPU8=$=new Uint8Array(x),m.HEAPU16=new Uint16Array(x),m.HEAPU32=P=new Uint32Array(x),m.HEAPF32=new Float32Array(x),m.HEAPF64=new Float64Array(x)}function q(){if(34821223==P[(H>>2)-1]&&2310721022==P[(H>>2)-2]||Be("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x02135467, but received 0x"+P[(H>>2)-2].toString(16)+" "+P[(H>>2)-1].toString(16)),1668509029!==R[0])throw"Runtime error: The application has corrupted its heap memory area (address zero)!"}function V(){Be("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+K+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function z(){V()}U=L=H=W=0,N=!1;var G=m.TOTAL_STACK||5242880,K=m.TOTAL_MEMORY||16777216;if(K<G&&g("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+K+"! (TOTAL_STACK="+G+")"),T("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&Int32Array.prototype.subarray!==undefined&&Int32Array.prototype.set!==undefined,"JS engine does not provide full typed array support"),m.buffer?T((x=m.buffer).byteLength===K,"provided buffer should be "+K+" bytes, but it is "+x.byteLength):(T((x="object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(T(K%Q==0),m.wasmMemory=new WebAssembly.Memory({initial:K/Q,maximum:K/Q}),m.wasmMemory.buffer):new ArrayBuffer(K)).byteLength===K),m.buffer=x),X(),R[0]=1668509029,D[1]=25459,115!==$[2]||99!==$[3])throw"Runtime error: expected the system to be little-endian!";function Y(e){for(;0<e.length;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?t.arg===undefined?m.dynCall_v(n):m.dynCall_vi(n,t.arg):n(t.arg===undefined?null:t.arg)}else t()}}var J=[],Z=[],ee=[],te=[],ne=!1,ie=!1;T(Math.imul&&Math.fround&&Math.clz32&&Math.trunc,"this is a legacy browser, build with LEGACY_VM_SUPPORT");Math.abs,Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc;var oe=0,ae=null,re=null,se={};m.preloadedImages={},m.preloadedAudios={};var le={error:function(){Be("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){le.error()},createDataFile:function(){le.error()},createPreloadedFile:function(){le.error()},createLazyFile:function(){le.error()},open:function(){le.error()},mkdev:function(){le.error()},registerDevice:function(){le.error()},analyzePath:function(){le.error()},loadFilesFromDB:function(){le.error()},ErrnoError:function(){le.error()}};m.FS_createDataFile=le.createDataFile,m.FS_createPreloadedFile=le.createPreloadedFile;var ce="data:application/octet-stream;base64,";function ue(e){return String.prototype.startsWith?e.startsWith(ce):0===e.indexOf(ce)}!function We(){var e="md5-sha1.wast",c="https://exmail.qq.com/qy_mng_logic/wasmHelper?type=hashv2",t="md5-sha1.temp.asm.js";ue(e)||(e=s(e)),ue(c),ue(t)||(t=s(t));var u={global:null,env:null,asm2wasm:v,parent:m},d=null;function f(e){var t=m.buffer;e.byteLength<t.byteLength&&g("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");var n=new Int8Array(t);new Int8Array(e).set(n),function i(e){m.buffer=x=e}(e),X()}function p(){try{if(m.wasmBinary)return new Uint8Array(m.wasmBinary);if(m.readBinary)return m.readBinary(c);throw"both async and sync fetching of the wasm failed"}catch(g){Be(g)}}function r(e,t,n){if("object"!=typeof WebAssembly)return Be("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead."),g("no native wasm support detected"),!1;if(!(m.wasmMemory instanceof WebAssembly.Memory))return g("no native wasm Memory in use"),!1;function i(e,t){(d=e.exports).memory&&f(d.memory),m.asm=d,m.usingWasm=!0,function n(e){if(oe--,m.monitorRunDependencies&&m.monitorRunDependencies(oe),e?(T(se[e]),delete se[e]):g("warning: run dependency removed without ID"),0==oe&&(null!==ae&&(clearInterval(ae),ae=null),re)){var t=re;re=null,t()}}("wasm-instantiate")}if(t.memory=m.wasmMemory,u.global={NaN:NaN,Infinity:Infinity},u["global.Math"]=Math,u.env=t,function s(e){oe++,m.monitorRunDependencies&&m.monitorRunDependencies(oe),e?(T(!se[e]),se[e]=1,null===ae&&"undefined"!=typeof setInterval&&(ae=setInterval(function(){if(b)return clearInterval(ae),void(ae=null);var e=!1;for(var t in se)e||(e=!0,g("still waiting on run dependencies:")),g("dependency: "+t);e&&g("(end of list)")},1e4))):g("warning: run dependency added without ID")}("wasm-instantiate"),m.instantiateWasm)try{return m.instantiateWasm(u,i)}catch(l){return g("Module.instantiateWasm callback failed with error: "+l),!1}var o=m;function a(e){T(m===o,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),o=null,i(e.instance,e.module)}function r(e){(function t(){return m.wasmBinary||!h&&!_||"function"!=typeof fetch?new Promise(function(e,t){e(p())}):fetch(c,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+c+"'";return e.arrayBuffer()})["catch"](function(){return p()})})().then(function(e){return WebAssembly.instantiate(e,u)}).then(e,function(e){g("failed to asynchronously prepare wasm: "+e),Be(e)})}return m.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||ue(c)||"function"!=typeof fetch?r(a):WebAssembly.instantiateStreaming(fetch(c,{credentials:"same-origin"}),u).then(a,function(e){g("wasm streaming compile failed: "+e),g("falling back to ArrayBuffer instantiation"),r(a)}),{}}m.asmPreload=m.asm;var n=m.reallocBuffer;m.reallocBuffer=function(e){return"asmjs"===i?n(e):function(e){e=function n(e,t){return 0<e%t&&(e+=t-e%t),e}(e,m.usingWasm?Q:j);var t=m.buffer.byteLength;if(m.usingWasm)try{return-1!==m.wasmMemory.grow((e-t)/65536)?m.buffer=m.wasmMemory.buffer:null}catch(i){return console.error("Module.reallocBuffer: Attempted to grow from "+t+" bytes to "+e+" bytes, but got error: "+i),null}}(e)};var i="";m.asm=function(e,t,n){if(!t.table){var i=m.wasmTableSize;i===undefined&&(i=1024);var o=m.wasmMaxTableSize;"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?o!==undefined?t.table=new WebAssembly.Table({initial:i,maximum:o,element:"anyfunc"}):t.table=new WebAssembly.Table({initial:i,element:"anyfunc"}):t.table=new Array(i),m.wasmTable=t.table}var a;return t.memoryBase||(t.memoryBase=m.STATIC_BASE),t.tableBase||(t.tableBase=0),T(a=r(0,t),"no binaryen method succeeded. consider enabling more options, like interpreting, if you want that: http://kripken.github.io/emscripten-site/docs/compiling/WebAssembly.html#binaryen-methods"),a},m.asm}();U=6880,Z.push();m.STATIC_BASE=1024,m.STATIC_BUMP=5856;var de=U;U+=16,T(de%8==0);var fe={buffers:[null,[],[]],printChar:function(e,t){var n=fe.buffers[e];T(n),0===t||10===t?((1===e?l:g)(S(n,0)),n.length=0):n.push(t)},varargs:0,get:function(e){return fe.varargs+=4,R[fe.varargs-4>>2]},getStr:function(){return w(fe.get())},get64:function(){var e=fe.get(),t=fe.get();return T(0<=e?0===t:-1===t),e},getZero:function(){T(0===fe.get())}};function pe(){var e=m._fflush;e&&e(0);var t=fe.buffers;t[1].length&&fe.printChar(1,10),t[2].length&&fe.printChar(2,10)}W=u(4),O=L=d(U),B=d(H=O+G),R[W>>2]=B,N=!0,T(B<K,"TOTAL_MEMORY not big enough for stack");m.wasmTableSize=10,m.wasmMaxTableSize=10,m.asmGlobalArg={},m.asmLibraryArg={abort:Be,assert:T,enlargeMemory:z,getTotalMemory:function Qe(){return K},abortOnCannotGrowMemory:V,abortStackOverflow:function je(e){Be("Stack overflow! Attempted to allocate "+e+" bytes on the stack, but stack has only "+(H-Ne()+e)+" bytes available!")},nullFunc_ii:function Xe(e){g("Invalid function pointer called with signature 'ii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),g("Build with ASSERTIONS=2 for more info."),Be(e)},nullFunc_iiii:function qe(e){g("Invalid function pointer called with signature 'iiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),g("Build with ASSERTIONS=2 for more info."),Be(e)},invoke_ii:function Ve(e,t){var n=Ne();try{return m.dynCall_ii(e,t)}catch(i){if(Ue(n),"number"!=typeof i&&"longjmp"!==i)throw i;m.setThrew(1,0)}},invoke_iiii:function ze(e,t,n,i){var o=Ne();try{return m.dynCall_iiii(e,t,n,i)}catch(a){if(Ue(o),"number"!=typeof a&&"longjmp"!==a)throw a;m.setThrew(1,0)}},___lock:function Ge(){},___setErrNo:function Ke(e){return m.___errno_location?R[m.___errno_location()>>2]=e:g("failed to set errno from JS"),e},___syscall140:function Ye(e,t){fe.varargs=t;try{var n=fe.getStreamFromFD(),i=(fe.get(),fe.get()),o=fe.get(),a=fe.get(),r=i;return le.llseek(n,r,a),R[o>>2]=n.position,n.getdents&&0===r&&0===a&&(n.getdents=null),0}catch(s){return void 0!==le&&s instanceof le.ErrnoError||Be(s),-s.errno}},___syscall146:function Je(e,t){fe.varargs=t;try{for(var n=fe.get(),i=fe.get(),o=fe.get(),a=0,r=0;r<o;r++){for(var s=R[i+8*r>>2],l=R[i+(8*r+4)>>2],c=0;c<l;c++)fe.printChar(n,$[s+c]);a+=l}return a}catch(u){return void 0!==le&&u instanceof le.ErrnoError||Be(u),-u.errno}},___syscall54:function Ze(e,t){fe.varargs=t;try{return 0}catch(n){return void 0!==le&&n instanceof le.ErrnoError||Be(n),-n.errno}},___syscall6:function et(e,t){fe.varargs=t;try{var n=fe.getStreamFromFD();return le.close(n),0}catch(i){return void 0!==le&&i instanceof le.ErrnoError||Be(i),-i.errno}},___unlock:function tt(){},_emscripten_memcpy_big:function nt(e,t,n){return $.set($.subarray(t,t+n),e),e},flush_NO_FILESYSTEM:pe,DYNAMICTOP_PTR:W,tempDoublePtr:de,STACKTOP:L,STACK_MAX:H};var me=m.asm(m.asmGlobalArg,m.asmLibraryArg,x),he=me.___errno_location;me.___errno_location=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),he.apply(null,arguments)};var _e=me._fflush;me._fflush=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),_e.apply(null,arguments)};var ge=me._free;me._free=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ge.apply(null,arguments)};var ve=me._llvm_bswap_i32;me._llvm_bswap_i32=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ve.apply(null,arguments)};var be=me._malloc;me._malloc=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),be.apply(null,arguments)};var Te=me._md5_final;me._md5_final=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Te.apply(null,arguments)};var ye=me._md5_hex;me._md5_hex=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ye.apply(null,arguments)};var Me=me._md5_init;me._md5_init=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Me.apply(null,arguments)};var we=me._md5_update;me._md5_update=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),we.apply(null,arguments)};var Ee=me._sbrk;me._sbrk=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ee.apply(null,arguments)};var Se=me._sha1_final;me._sha1_final=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Se.apply(null,arguments)};var Ce=me._sha1_init;me._sha1_init=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ce.apply(null,arguments)};var Ie=me._sha1_update;me._sha1_update=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ie.apply(null,arguments)};var Fe=me.establishStackSpace;me.establishStackSpace=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Fe.apply(null,arguments)};var Ae=me.getTempRet0;me.getTempRet0=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ae.apply(null,arguments)};var xe=me.setTempRet0;me.setTempRet0=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),xe.apply(null,arguments)};var ke=me.setThrew;me.setThrew=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ke.apply(null,arguments)};var $e=me.stackAlloc;me.stackAlloc=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),$e.apply(null,arguments)};var De=me.stackRestore;me.stackRestore=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),De.apply(null,arguments)};var Re=me.stackSave;me.stackSave=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Re.apply(null,arguments)},m.asm=me;m.___errno_location=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.___errno_location.apply(null,arguments)},m._fflush=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._fflush.apply(null,arguments)},m._free=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._free.apply(null,arguments)},m._llvm_bswap_i32=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._llvm_bswap_i32.apply(null,arguments)},m._malloc=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._malloc.apply(null,arguments)},m._md5_final=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._md5_final.apply(null,arguments)},m._md5_hex=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._md5_hex.apply(null,arguments)},m._md5_init=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._md5_init.apply(null,arguments)},m._md5_update=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._md5_update.apply(null,arguments)},m._memcpy=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._memcpy.apply(null,arguments)},m._memset=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._memset.apply(null,arguments)},m._sbrk=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._sbrk.apply(null,arguments)},m._sha1_final=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._sha1_final.apply(null,arguments)},m._sha1_init=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._sha1_init.apply(null,arguments)},m._sha1_update=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm._sha1_update.apply(null,arguments)},m.establishStackSpace=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.establishStackSpace.apply(null,arguments)},m.getTempRet0=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.getTempRet0.apply(null,arguments)},m.runPostSets=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.runPostSets.apply(null,arguments)},m.setTempRet0=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.setTempRet0.apply(null,arguments)},m.setThrew=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.setThrew.apply(null,arguments)};var Pe=m.stackAlloc=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.stackAlloc.apply(null,arguments)},Ue=m.stackRestore=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.stackRestore.apply(null,arguments)},Ne=m.stackSave=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.stackSave.apply(null,arguments)};m.dynCall_ii=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.dynCall_ii.apply(null,arguments)},m.dynCall_iiii=function(){return T(ne,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),T(!ie,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),m.asm.dynCall_iiii.apply(null,arguments)};function Oe(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}m.asm=me,m.intArrayFromString||(m.intArrayFromString=function(){Be("'intArrayFromString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.intArrayToString||(m.intArrayToString=function(){Be("'intArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.ccall=M,m.cwrap=function it(e,t,n,i){return function(){return M(e,t,n,arguments)}},m.setValue||(m.setValue=function(){Be("'setValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.getValue||(m.getValue=function(){Be("'getValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.allocate||(m.allocate=function(){Be("'allocate' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.getMemory||(m.getMemory=function(){Be("'getMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.Pointer_stringify||(m.Pointer_stringify=function(){Be("'Pointer_stringify' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.AsciiToString||(m.AsciiToString=function(){Be("'AsciiToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stringToAscii||(m.stringToAscii=function(){Be("'stringToAscii' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.UTF8ArrayToString||(m.UTF8ArrayToString=function(){Be("'UTF8ArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.UTF8ToString||(m.UTF8ToString=function(){Be("'UTF8ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stringToUTF8Array||(m.stringToUTF8Array=function(){Be("'stringToUTF8Array' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stringToUTF8||(m.stringToUTF8=function(){Be("'stringToUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.lengthBytesUTF8||(m.lengthBytesUTF8=function(){Be("'lengthBytesUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.UTF16ToString||(m.UTF16ToString=function(){Be("'UTF16ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stringToUTF16||(m.stringToUTF16=function(){Be("'stringToUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.lengthBytesUTF16||(m.lengthBytesUTF16=function(){Be("'lengthBytesUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.UTF32ToString||(m.UTF32ToString=function(){Be("'UTF32ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stringToUTF32||(m.stringToUTF32=function(){Be("'stringToUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.lengthBytesUTF32||(m.lengthBytesUTF32=function(){Be("'lengthBytesUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.allocateUTF8||(m.allocateUTF8=function(){Be("'allocateUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stackTrace||(m.stackTrace=function(){Be("'stackTrace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.addOnPreRun||(m.addOnPreRun=function(){Be("'addOnPreRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.addOnInit||(m.addOnInit=function(){Be("'addOnInit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.addOnPreMain||(m.addOnPreMain=function(){Be("'addOnPreMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.addOnExit||(m.addOnExit=function(){Be("'addOnExit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.addOnPostRun||(m.addOnPostRun=function(){Be("'addOnPostRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.writeStringToMemory||(m.writeStringToMemory=function(){Be("'writeStringToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.writeArrayToMemory||(m.writeArrayToMemory=function(){Be("'writeArrayToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.writeAsciiToMemory||(m.writeAsciiToMemory=function(){Be("'writeAsciiToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.addRunDependency||(m.addRunDependency=function(){Be("'addRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.removeRunDependency||(m.removeRunDependency=function(){Be("'removeRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.ENV||(m.ENV=function(){Be("'ENV' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.FS||(m.FS=function(){Be("'FS' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.FS_createFolder||(m.FS_createFolder=function(){Be("'FS_createFolder' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.FS_createPath||(m.FS_createPath=function(){Be("'FS_createPath' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.FS_createDataFile||(m.FS_createDataFile=function(){Be("'FS_createDataFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.FS_createPreloadedFile||(m.FS_createPreloadedFile=function(){Be("'FS_createPreloadedFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.FS_createLazyFile||(m.FS_createLazyFile=function(){Be("'FS_createLazyFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.FS_createLink||(m.FS_createLink=function(){Be("'FS_createLink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.FS_createDevice||(m.FS_createDevice=function(){Be("'FS_createDevice' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.FS_unlink||(m.FS_unlink=function(){Be("'FS_unlink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),m.GL||(m.GL=function(){Be("'GL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.staticAlloc||(m.staticAlloc=function(){Be("'staticAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.dynamicAlloc||(m.dynamicAlloc=function(){Be("'dynamicAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.warnOnce||(m.warnOnce=function(){Be("'warnOnce' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.loadDynamicLibrary||(m.loadDynamicLibrary=function(){Be("'loadDynamicLibrary' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.loadWebAssemblyModule||(m.loadWebAssemblyModule=function(){Be("'loadWebAssemblyModule' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.getLEB||(m.getLEB=function(){Be("'getLEB' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.getFunctionTables||(m.getFunctionTables=function(){Be("'getFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.alignFunctionTables||(m.alignFunctionTables=function(){Be("'alignFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.registerFunctions||(m.registerFunctions=function(){Be("'registerFunctions' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.addFunction||(m.addFunction=function(){Be("'addFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.removeFunction||(m.removeFunction=function(){Be("'removeFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.getFuncWrapper||(m.getFuncWrapper=function(){Be("'getFuncWrapper' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.prettyPrint||(m.prettyPrint=function(){Be("'prettyPrint' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.makeBigInt||(m.makeBigInt=function(){Be("'makeBigInt' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.dynCall||(m.dynCall=function(){Be("'dynCall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.getCompilerSetting||(m.getCompilerSetting=function(){Be("'getCompilerSetting' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stackSave||(m.stackSave=function(){Be("'stackSave' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stackRestore||(m.stackRestore=function(){Be("'stackRestore' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.stackAlloc||(m.stackAlloc=function(){Be("'stackAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.establishStackSpace||(m.establishStackSpace=function(){Be("'establishStackSpace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.print||(m.print=function(){Be("'print' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.printErr||(m.printErr=function(){Be("'printErr' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),m.ALLOC_NORMAL||Object.defineProperty(m,"ALLOC_NORMAL",{get:function(){Be("'ALLOC_NORMAL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),m.ALLOC_STACK||Object.defineProperty(m,"ALLOC_STACK",{get:function(){Be("'ALLOC_STACK' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),m.ALLOC_STATIC||Object.defineProperty(m,"ALLOC_STATIC",{get:function(){Be("'ALLOC_STATIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),m.ALLOC_DYNAMIC||Object.defineProperty(m,"ALLOC_DYNAMIC",{get:function(){Be("'ALLOC_DYNAMIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),m.ALLOC_NONE||Object.defineProperty(m,"ALLOC_NONE",{get:function(){Be("'ALLOC_NONE' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),(Oe.prototype=new Error).constructor=Oe;function Le(e){function t(){m.calledRun||(m.calledRun=!0,b||(function e(){q(),ne||(ne=!0,Y(Z))}(),function t(){q(),Y(ee)}(),m.onRuntimeInitialized&&m.onRuntimeInitialized(),T(!m._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),function n(){if(q(),m.postRun)for("function"==typeof m.postRun&&(m.postRun=[m.postRun]);m.postRun.length;)e=m.postRun.shift(),te.unshift(e);var e;Y(te)}()))}e=e||m.arguments,0<oe||(function n(){T(0==(3&H)),P[(H>>2)-1]=34821223,P[(H>>2)-2]=2310721022}(),function i(){if(m.preRun)for("function"==typeof m.preRun&&(m.preRun=[m.preRun]);m.preRun.length;)e=m.preRun.shift(),J.unshift(e);var e;Y(J)}(),0<oe||m.calledRun||(m.setStatus?(m.setStatus("Running..."),setTimeout(function(){setTimeout(function(){m.setStatus("")},1),t()},1)):t(),q()))}re=function ot(){m.calledRun||Le(),m.calledRun||(re=ot)},m.run=Le;var He=[];function Be(t){m.onAbort&&m.onAbort(t),t=t!==undefined?(l(t),g(t),JSON.stringify(t)):"",b=!0,1;var n="abort("+t+") at "+A();throw He&&He.forEach(function(e){n=e(n,t)}),n}if(m.abort=Be,m.preInit)for("function"==typeof m.preInit&&(m.preInit=[m.preInit]);0<m.preInit.length;)m.preInit.pop()();m.noExitRuntime=!0,Le(),m.onRuntimeInitialized=function(){self.Module=m,self.md5_init=self.Module.cwrap("md5_init"),self.md5_update=self.Module.cwrap("md5_update",null,["array","number"]),self.md5_final=self.Module.cwrap("md5_final","string"),self.sha1_init=self.Module.cwrap("sha1_init"),self.sha1_update=self.Module.cwrap("sha1_update",null,["array","number"]),self.sha1_final=self.Module.cwrap("sha1_final","string");function e(){this.init()}function t(){this.init()}e.prototype.init=function(){self.md5_init(),this.md5Cache&&delete this.md5Cache,this.state=new Int8Array(16777216)},e.prototype.update=function(e){var t=new Int8Array(e);return self.md5_update(t,t.length),this},e.prototype.get=function(){return self.md5_final()},e.prototype.setState=function(e){this.state=e},e.prototype.getState=function(){return 1},e.prototype.setCache=function(e){this.md5Cache=e},e.prototype.getCache=function(){return this.md5Cache},t.prototype.init=function(){self.sha1_init(),this.sha1Cache&&delete this.sha1Cache,this.state=new Int8Array(16777216)},t.prototype.update=function(e){var t=new Int8Array(e);return self.sha1_update(t,t.length),this},t.prototype.get=function(){return self.sha1_final()},t.prototype.setState=function(e){this.state=e},t.prototype.getState=function(){return 1},t.prototype.setCache=function(e){this.sha1Cache=e},t.prototype.getCache=function(){return this.sha1Cache},self.MD5=self.MD5||new e,self.SHA1=self.SHA1||new t;var o={reset:function(){self.MD5.init(),self.SHA1.init()},chunkMD5:function(e){return self.MD5.init(),self.MD5.update(e),self.MD5.get()},appendMD5:function(e){return self.MD5.update(e.chunk).getState()},getMD5:function(e){var t=self.MD5.get();return self.MD5.setCache(t),t},chunkSHA1:function(e){return self.SHA1.init(),self.SHA1.update(e),self.SHA1.get()},appendSHA1:function(e){return self.SHA1.update(e.chunk).getState()},getSHA1:function(e){var t=self.SHA1.get();return self.SHA1.setCache(t),t}},l=new FileReader;self.addEventListener("message",function(n){var i=n.data;function t(){var e=o[i.type](i.data);delete n;var t=e&&(e.state||e.heap);self.postMessage({type:"done",data:e},t&&[t])}"appendSHA1"==i.type||"appendMD5"==i.type?function s(e,t,n){function i(e){r(),t(e.target.result)}function o(e){r(),n(e.target.error)}function a(e){r(),n(e.target.error)}function r(){delete e,l.removeEventListener("load",i),l.removeEventListener("abort",o),l.removeEventListener("error",a)}l.addEventListener("load",i),l.addEventListener("abort",o),l.addEventListener("error",a),l.readAsArrayBuffer(e)}(i.data.chunk||i.data,function(e){i.data.chunk&&(i.data.chunk=e),t()},function(e){self.postMessage({type:"retry",data:e.message})}):t()}),self.postMessage({type:"ready"})}}var p=location.protocol+"//"+location.hostname+"/zh_CN/htmledition/js_biz/com/kits/qmfileupload/js/wasm_chip/dist/wasm_hash_worker.js";function t(o){var a=s.Html5PopupMail.prototype;return g.extend(e.getChipLib(o),e.getH5SafeLib(o),{nConcurrent:1,nReaderNum:2,nHashWorkNum:2,nMaxRetryNum:100,nMaxSingleRetryNum:3,nSignFileBlockSize:4194304,nUploadFileBlockSize:524288,nCacheThreshold:3,nMd5HashWorkNum:1,nSha1HashWorkNum:1,init_:function(){var e=this;if(o.init_.apply(this,arguments),"function"==typeof arguments[0]&&(l=arguments[0]()),!r){r=new c,v=new u,r.PRIORITY=v.PRIORITY={send:0,send_read:0,block_hash:0,file_sha1:1,file_md5:2,pre_read_file_hash:3,pre_block_hash:3};for(var t=this.nReaderNum;t--;)r.fork();var n="";window.goJsConlog&&(n=["var noof=function(){},","$_home_qspace_dev_tools_codeSyncFiles_webmail_QQMail_tmp_js_ascii__qmtool_Log= noof,","goJsConlog;goJsConlog={addJslevel:noof,subJslevel:noof};\n"].join("")),g.isBrowser("edge")||g.isBrowser("ie")?_sWorkerUrl=p:_sWorkerUrl=window.URL.createObjectURL(new Blob([f.toString()+"\n"+n+f.name+"();"]));for(t=this.nMd5HashWorkNum;t--;)v.fork(_sWorkerUrl,{ident:"md5"},function(){e.onResourceError()});for(t=this.nSha1HashWorkNum;t--;)v.fork(_sWorkerUrl,{ident:"sha1"},function(){e.onResourceError()});g.isBrowser("edge")||g.isBrowser("ie")||window.URL.revokeObjectURL(_sWorkerUrl)}},detect:function(){var e;if((e="function"==typeof getTop?getTop():{goExpers:{h5cJsUpload:!0}}).goExpers&&e.goExpers.wasmJsUpload&&"entdisk"!==e.ftnApp&&_h5cdetect()&&"object"==typeof WebAssembly&&[WebAssembly.compile,WebAssembly.instantiate,WebAssembly.Memory].every(function(e){return"function"==typeof e})&&"function"==typeof Array.prototype.every&&e.goExpers&&e.goExpers.h5cJsUpload&&a.detect.apply(this,arguments)&&"Promise|FileReader|DataView|ArrayBuffer|Uint8Array|URL|Blob".split("|").every(function(e){return e in window}))try{var t;if(g.isBrowser("edge")||g.isBrowser("ie"))t=new Worker(p);else{var n=window.URL.createObjectURL(new Blob([""]));t=new Worker(n),window.URL.revokeObjectURL(n)}return t&&t.terminate(),!0}catch(i){console.log(i)}return!1},uploadToFtn:function(e){return this.uploadInChip(e.set("bFtnFile",!0))},upload:function(e){return this.isUptoFtnForNormal()?this.uploadInChip(e.set("bIsUptoFtnForNormal",!0)):o.upload.apply(this,arguments)},doChipFileSign_:function(e){var t=this;t.safeStartUpdate_(e);var n=e.fCancel;e.fCancel=function(){e._oCurFileBlock&&e._oCurFileBlock.cancel(),n&&n.call(e),t.fileCanceled=!0},t._realChipFileSign2(e)},_genFileBlock:function(e,t){var n=new d(r,v,e.oH5File.slice(t,t+this.nSignFileBlockSize));return n.__nOffset=t,n},_realChipFileSign2:function(s){var t,n,o,a,l=this,c=s.get("nSize"),u=(s.get("nTry"),s.get("sMD5"),s.get("sSHA"),0),d=0,f=Math.ceil(c/l.nSignFileBlockSize),p=2<f?2:f,m=1,r=0,h=g.speedNow();!function _(e){if(!e&&l.fileCanceled)return l.fileCanceled=!1,setTimeout(function(){_()},150),!1;for(t=Promise.resolve(e),i=0;i<p;i++)if(n=o||l._genFileBlock(s,r),r+=l.nSignFileBlockSize,o=c<r?{}:l._genFileBlock(s,r),function(a,r,e){t=t.then(function(t){if(!s.bCancelH5_){t||(t=[]),s._oCurFileBlock=r,window.t0=g.speedNow();var e=Promise.all([r._hashHandle("","file_sha1",function i(e){return{data:{state:t[0],chunk:r.block},type:"appendSHA1"}},"file_sha1",!0),r._hashHandle("","file_md5",function o(e){return{data:{state:t[1],chunk:r.block},type:"appendMD5"}},"file_md5",!0)]),n=g.speedNow();return e.then(function(){var e=g.speedNow()-n;d++,100<e&&u++,r.free(),l.onChipFileSigning_(s,r.__nOffset/c*100-2)}),p==a+1&&m*p<f?e.then(function(e){m++,_(e)}):e}})["catch"](function(e){l._customInternalError(s,"fileHashError")})}(i,n),(m-1)*p+i+1==f){window.t1||(window.t1=g.speedNow(),console.log(window.t1-window.t0)),t.then(function(e){if(s._oCurFileBlock=null,u&&debug(["hash timeout:",(u/d*100).toFixed(6),"% ",u,"/",d].join("")),!s.bCancelH5_)return Promise.all([v.run(v.task({data:e[0],type:"getSHA1"})),v.run(v.task({data:e[1],type:"getMD5"}))])}).then(function(e){a=g.speedNow(),debug(a-h);var t=c/1024/1024/(a-h)*1e3;debug(["[",s.get("sName"),"]\u626b\u63cf:",t,"M/S"].join("")),536870912<c?((new Image).src="/qy_mng_logic/reportKV?type=BizUpload&itemName=scan_speed&value="+parseInt(t,10),(new Image).src="/qy_mng_logic/reportKV?type=BizUpload&itemName=wasm_scan_speed_all_b&value="+parseInt(t,10),g.isBrowser("chrome")&&((new Image).src="/qy_mng_logic/reportKV?type=BizUpload&itemName=wasm_scan_speed_b&value="+parseInt(t,10))):(new Image).src="/qy_mng_logic/reportKV?type=BizUpload&itemName=wasm_scan_speed_s&value="+parseInt(t,10),window.console&&console.log("sSHA:",e[0]),window.console&&console.log("sMD5:",e[1]),s.bCancelH5_||l.onChipFileSignEnd_(s,{sSHA:e[0],sMD5:e[1]})},function(e){l._customInternalError(s,"fileHashError")});break}}()},doChipUpload_:function(e){var t=new n(r,v,e.oH5File,this.nUploadFileBlockSize,this.nCacheThreshold);t.addCache(0,65536),e._mnStartUploadTime=+new Date,this._uploadFromOffset(e,t,0)},_uploadFromOffset:function(r,s,l,n){var c,u,d,f=this,p=+new Date;return s.fetch(l).then(function(e){if(c=g.speedNow(),u=e[0],!r.bCancelH5_){var t=e[0],n=e[1];return r._oCurFileBlock=e[2],d=e[2]._nResumeReadTime,f._requestFTN(r,l,t,n)}}).then(function(e){return f.setRealPostSize_(r,p,r._oCurFileBlock.block.size),e},function(e){throw f.setRealPostSize_(r,p,r._oCurFileBlock.block.size),e}).then(function(e){var t=g.speedNow(),n=0<d-p?d-p:0;if(window.console&&console.log("[%s] offset:%f, start:%f, request:%f, total:%f, read:%fms(%d%), md5:%fms(%d%), ajax:%fms(%d%)",u,l,p,c,t-p,n,n/(t-p)*100,c-p-n,(c-p-n)/(t-p)*100,t-c,(t-c)/(t-p)*100),!r.bCancelH5_){var i=l+r._oCurFileBlock.block.size;if(f.onprocess(r.set({nUploadPercent:i/r.get("nSize")*100,nUploadedSize:i})),!e.end){if(e.nextOffset>=r.get("nSize"))throw new Error("next offset overflow");if(e.nextOffset<=l){window.console&&console.log("[ftn\u56de\u4f20] next:",e.nextOffset,", ","cur:",l,", ","\u76f8\u5dee\uff1a",(l-e.nextOffset)/f.nUploadFileBlockSize,"\u7247");var o=(l-e.nextOffset)/f.nUploadFileBlockSize;(o>f.nCacheThreshold||o!=parseInt(o))&&s.resetCache(),r._mnCallBackTotalTime==undefined&&(r._mnCallBackTotalChip=0,r._mnCallBackTotalNum=0),r._mnCallBackTotalChip+=Number((l-e.nextOffset)/f.nUploadFileBlockSize),r._mnCallBackTotalNum++}return f._uploadFromOffset(r,s,e.nextOffset)}f.reportSuccDomain(r);var a=+new Date;debug(["\u603b\u8017\u65f6\uff1a",(a-r._mnStartUploadTime)/1e3,"s"].join("")),debug(["\u771f\u5b9e\u8bf7\u6c42\u8017\u65f6\uff1a",r._mnRealRequestTotalTime/1e3,"s"].join("")),debug(["\u771f\u5b9e\u8bf7\u6c42\u8017\u65f6\u5360\u6bd4\uff1a",r._mnRealRequestTotalTime/(a-r._mnStartUploadTime)*100,"%"].join("")),debug(["\u771f\u5b9e\u8bf7\u6c42\u6b21\u6570\uff1a",r._mnRealRequestTotalNum,"\u6b21"].join("")),debug(["\u771f\u5b9e\u4e0a\u4f20\u5927\u5c0f\uff1a",r.get("nRealPostSize")/1024/1024,"M"].join("")),debug(["[",r.get("sName"),"]\u4e0a\u4f20:",r.get("nRealPostSize")/1024/1024/(a-r._mnStartUploadTime)*1e3,"M/S"].join("")),debug(["\u5e73\u5747\u56de\u4f20\u7247\u6570\uff1a",r._mnCallBackTotalChip?r._mnCallBackTotalChip/r._mnCallBackTotalNum:0,"\u7247"].join("")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|uploadSucc",sid:g.getSid()}),s._workers.queue.resetWorker(),f.oncomplete(r)}})["catch"](function(e){var t=r.get("nAutoUploadRetry")||0;n||(n=0),t<f.nMaxRetryNum&&n<f.nMaxSingleRetryNum?(r.set("nAutoUploadRetry",++t),debug("auto upload retry"),f._uploadFromOffset(r,s,l,n?n+1:1)):(s._workers.queue.resetWorker(),/http,600/i.test(e.message)&&f.reportCustomError(r,{fileUploadProgress:l/r.get("nSize")*10}),f._parseError(r,e))})},_parseError:function(e,t){"next offset overflow"==t.message?this._customInternalError(e,"nextOffsetOverFlow"):"http,"==t.message.substr(0,5)?this.onerror(e.set("sError",this.err("http",t.message.substr(5)))):/^[a-z]+,/i.test(t.message)?this.onerror(e.set("sError",t.message)):(debug(t),this.onerror(e.set("sError",this.err("unknow",709390))))},_requestFTN:function(e,t,n,i){var o;return o="function"==typeof getTop?getTop():{goExpers:{h5cJsUploadProxy:!0}},!/\.qq\.com$/.test(location.hostname)&&o.goExpers&&o.goExpers.h5cJsUploadProxy?this._requestFTNByAjaxProxy.apply(this,arguments):this._requestFTNByAjax.apply(this,arguments)},_requestFTNByAjaxProxy:function(s,l,c,u){var d=this;return new Promise(function(i,o){var e=new XMLHttpRequest,t=s.get("nPort"),n="http";"https:"==window.location.protocol&&(t="443",n="https");var a=n+"://"+(s.get("sDns")||s.get("sIP"))+":"+t+"/ftn_handler/";window.ftnurltolog=a,e.open("POST",a,!0),e.timeout=2e4,e.setRequestHeader("DATA-MD5",c),e.setRequestHeader("content-type","application/octet-stream"),e.setRequestHeader("Cache-Control","no-cache"),e.responseType="arraybuffer",window.addEventListener("message",function(e){!function n(e){try{i(m.parseFTNRespone(e))}catch(t){g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|parseFTNResponeError",sid:g.getSid()}),o(t)}}(e.data)},{once:!0}),e.onerror=function(){o(new Error("http,600")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror",sid:g.getSid()}),window.ftnurltolog&&g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror|"+window.ftnurltolog,sid:g.getSid()})},e.onabort=function(){o(new Error("http,700")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onabort",sid:g.getSid()})},e.ontimeout=function(){o(new Error("http,800")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|timeout",sid:g.getSid()})},e.upload.onprogress=function(e){e.lengthComputable&&d.onprocess(s.set("nUploadPercent",(e.loaded+l)/s.get("nSize")*100))};var r=m.genFTNRequestBody(s.get("sKey"),s.get("sSHA"),s.oH5File,u,l);document.getElementById("ajaxProxyIframe").contentWindow.postMessage({_sUrl:a,_asHash:c,_oSendAB:r},"*"),new Date})},_requestFTNByAjax:function(c,u,d,f){var p=this;return new Promise(function(n,i){var o,a,r=new XMLHttpRequest,e=c.get("nPort"),t="http";"https:"==window.location.protocol&&(e="443",t="https");var s=t+"://"+(c.get("sDns")||c.get("sIP"))+":"+e+"/ftn_handler/";window.ftnurltolog=s,r.open("POST",s,!0),r.timeout=2e4,r.setRequestHeader("DATA-MD5",d),r.setRequestHeader("content-type","application/octet-stream"),r.setRequestHeader("Cache-Control","no-cache"),r.responseType="arraybuffer",r.onload=function(){if(4==r.readyState)if(r.upload.onprogress=null,200==r.status){a=+new Date,c._mnRealRequestTotalTime==undefined&&(c._mnRealRequestTotalTime=0,c._mnRealRequestTotalNum=0),c._mnRealRequestTotalTime+=Number(a-o),c._mnRealRequestTotalNum++;try{n(m.parseFTNRespone(r.response))}catch(t){g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|parseFTNResponeError",sid:g.getSid()}),i(t)}}else{var e=r.getResponseHeader("User-ReturnCode");i(new Error(e?"internal,"+e:"http,"+r.status))}},r.onerror=function(){i(new Error("http,600")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror",sid:g.getSid()}),window.ftnurltolog&&g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onerror|"+window.ftnurltolog,sid:g.getSid()})},r.onabort=function(){i(new Error("http,700")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|onabort",sid:g.getSid()})},r.ontimeout=function(){i(new Error("http,800")),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|timeout",sid:g.getSid()})},r.upload.onprogress=function(e){e.lengthComputable&&p.onprocess(c.set("nUploadPercent",(e.loaded+u)/c.get("nSize")*100))};var l=m.genFTNRequestBody(c.get("sKey"),c.get("sSHA"),c.oH5File,f,u);r.send(l),o=+new Date})},_customInternalError:function(e,t){this.onerror(e.set("sError",this.err("internal",{nextOffsetOverFlow:200001,fileHashError:200002}[t]||709390)))},reportCustomError:function(e,t){e.get("nPort");"https:"==window.location.protocol||window.location.hostname.indexOf("webdev")},reportSuccDomain:function(e){["succdomain=",e.get("sIP")].join("")},onResourceError:function(){if(!this.resourceErrorTriggered){var e,t=l||{};if(this.resourceErrorTriggered=!0,"WasmH5CPopupMail"==this.name?e="H5CPopupMail":"WasmH5CDragFMailCROS"==this.name?e="H5CDragFMailCROS":"WasmH5CDragFMail"==this.name&&(e="H5CDragFMail"),e){var n=t.oContainer.querySelector('input[type="file"]');n&&t.oContainer.removeChild(n.parentNode),new s[e](t),debug("wasm error, swith uploader implement: "+e),g.LogKvEx({businame:"fileupload",item:"web|H5CPopupMail|initFail",sid:g.getSid()})}}}})}e.createCom("WasmH5CPopupMail",t,"Html5PopupMail"),e.createCom("WasmH5CDragFMailCROS",t,"Html5DragCROS"),e.createCom("WasmH5CDragFMail",t,"Html5DragMail")}(QMFileAdaptor)},function(e,t,n){e.exports={}},function(e,t,n){var i=n(3),o=n(4);function a(){this.queue=new i}a.prototype.PRIORITY={},a.prototype.fork=function(){this.queue.addWorker(new FileReader)},a.prototype.task=function(e,t){var n=this,i=new o(e,t);return i.result().then(function(){n.queue.removeTask(i)}),i},a.prototype.run=function(e,t){return this.queue.runTask(e,this.PRIORITY[t])},e.exports=a},function(e,t){function n(){this._tasksList=[],this._workers=[]}n.prototype.addWorker=function(e){if(e.__status__&&"ready"!=e.__status__)return console.warn("worker add twice");for(var t,n,i=0,o=this._tasksList.length;i<o;i++)if((n=this._tasksList[i])&&n.length)for(;t=n.shift();)if(this._runTask(e,t))return;e.__status__="ready",this._workers.push(e)},n.prototype._runTask=function(t,e){var n=this;return!!e.start(t)&&(e.result().then(function(){t.__status__="ready",n.addWorker(t)},function(e){return t.__status__="ready",n.addWorker(t),Promise.reject(e)}),t.__status__="running",n.removeWorker(t),!0)},n.prototype.findWorker=function(t){return this._workers.findIndex(function(e){return e===t})},n.prototype.findIdentWorker=function(t){return this._workers.find(function(e){return e.ident==t.ident})},n.prototype.resetWorker=function(){return this._workers.forEach(function(e){e.postMessage({type:"reset"})})},n.prototype.removeWorker=function(t){this._workers=this._workers.filter(function(e){return e!==t})},n.prototype.runTask=function(e,t){var n,i=(e._wkmsg||{}).type;if("appendSHA1"==i||"getSHA1"==i?n="sha1":"appendMD5"!=i&&"getMD5"!=i||(n="md5"),n){var o=this.findIdentWorker({ident:n});o?this._runTask(o,e):this.insertTask(e,t)}else 0<this._workers.length?this._runTask(this._workers[0],e):this.insertTask(e,t);return e.result()},n.prototype.insertTask=function(e,t){t&&(t=Number(t)),t||(t=0),(this._tasksList[t]||(this._tasksList[t]=[])).push(e),(e.__priority||(e.__priority=[])).push(t)},n.prototype.removeTask=function(t){for(var e=this._tasksList,n=e.length;n--;)e[n]&&(e[n]=e[n].filter(function(e){return t!==e}))},e.exports=n},function(e,t,n){var i=n(5);function o(e,t){this._type=t,this._rdBlock=e,i.call(this)}(o.prototype=i.proto()).handle_=function(r){var s=this;return new Promise(function(t,n){function e(e){a(),t(e.target.result)}function i(){a(),n(new Error("aborted"))}function o(e){a(),n(e)}function a(){delete s._rdBlock,r.removeEventListener("load",e),r.removeEventListener("abort",i),r.removeEventListener("error",o)}r.addEventListener("load",e),r.addEventListener("abort",i),r.addEventListener("error",o),r.readAsArrayBuffer(s._rdBlock)})},e.exports=o},function(e,t){function n(){var n=this;n.timing={},n._resolve=n._reject=null,n._step("init"),n._promise=new Promise(function(e,t){n._resolve=e,n._reject=t}).then(function(e){return n._step("start"),n.handle_(e)}),n._promise.then(function(){n._step("success")},function(e){return n._step("error"),Promise.reject(e)})}n.prototype.SPEED_TEST=!0,n.prototype.timeEnd=function(e){this.SPEED_TEST&&(this.timing[e]=+new Date)},n.prototype.speedReport=function(){var e=this.timing,t=e.success||e.error||e.aborted,n=t-e.init||1,i=e.start-e.init,o=t-e.start;return["[",this.__status__,"]"," init:",e.init," total:",n,"ms"," wait:",i,"ms(",(i/n*100).toFixed(2),"%)"," run:",o,"ms(",(o/n*100).toFixed(2),"%)"].join("")},n.prototype._step=function(e){this.__status__=e,this.timeEnd(e)},n.prototype.start=function(e){if(this._resolve){var t=this._resolve;return this._reject=this._resolve=null,t(e),!0}return!1},n.prototype.abort=function(e){if(this._reject){var t=this._reject;this._reject=this._resolve=null,!0!==e&&t(new Error("abort"))}this._step("aborted")},n.prototype.handle_=function(){},n.prototype.result=function(){return this._promise},n.proto=function(){function e(){}return e.prototype=this.prototype,new e},e.exports=n},function(e,t,n){var i=n(3),o=n(7);function a(){this.queue=new i}a.prototype.PRIORITY={},a.prototype.fork=function(t,e,n){var i=this;e=e||{};try{var o=new Worker(t);e.ident&&(o.ident=e.ident)}catch(a){return console.log("init worker",a),a}o.addEventListener("message",function r(e){o.removeEventListener("message",r),"ready"==e.data.type&&i.queue.addWorker(o)}),o.addEventListener("error",function(e){console.log("worker err, %s err:%o",t,e),"function"==typeof n&&n()})},a.prototype.task=function(e){return new o(e)},a.prototype.run=function(e,t){return this.queue.runTask(e,this.PRIORITY[t])},e.exports=a},function(e,t,n){var i=n(5);function o(e){this._wkmsg=e,i.call(this)}(o.prototype=i.proto()).handle_=function(a){var r=this;return new Promise(function(t,n){function e(e){if("done"===e.data.type)o(),t(e.data.data);else if("retry"===e.data.type){if(r.nRetryCount=r.nRetryCount||0,4<r.nRetryCount)return debug(e.data.data),i(e.data.data);r.nRetryCount++,a.postMessage(r._wkmsg)}}function i(e){o(),n(e)}function o(){delete r._wkmsg,a.removeEventListener("message",e),a.removeEventListener("error",i)}a.addEventListener("message",e),a.addEventListener("error",i),a.postMessage(r._wkmsg)})},e.exports=o},function(e,t,n){var o=n(9);function i(e,t,n,i,o){this._workers=t,this._readers=e,this._chunkSize=i,this._file=n,this._cacheThreshold=o,this._caches={length:0}}i.prototype.fetch=function(e){var t=this._caches[e];return t||(console&&console.warn("no cache:%d",e),t=this.addCache(e,this._chunkSize)),this._cleanup(e),delete this._caches[e],this._runPrefetch(t._fetch_end),Promise.all([t.hash("block_hash"),t.read("send_read"),t])},i.prototype.addCache=function(e,t){var n=e+t,i=this._caches[e]=new o(this._readers,this._workers,this._file.slice(e,n));return this._caches.length++,i._fetch_start=e,i._fetch_end=n,i},i.prototype.rmCache=function(e){var t=this._caches[e];t&&t.cancel&&(t.cancel(),delete this._caches[e])},i.prototype._runPrefetch=function(e){var t=this;if(!(t._caches.length>t._cacheThreshold)){for(;e<t._file.size&&t._caches[e];)e+=t._chunkSize;e>=t._file.size||t._prefetch(e).then(function(){t._runPrefetch(e+t._chunkSize)})}},i.prototype._prefetch=function(e){return this.addCache(e,this._chunkSize).hash("pre_block_hash")},i.prototype._cleanup=function(e){var t=this._caches,n=0;for(var i in t)"length"!=i&&(i<e?this.rmCache(i):n++);t.length=n},i.prototype.resetCache=function(){this._caches={length:0}},e.exports=i},function(e,t){function n(e,t,n){this.__status__="init",this._readers=e,this._workers=t,this.block=n,this.tasks={}}function i(e){return{data:e,type:"chunkMD5"}}n.prototype.readAsBuffer=function(e,t){var n=this._readers.task(this.block,"toBuffer");return this.__status__="readAsBuffer",this._readers.run(n,e),n.result()},n.prototype.read=function(e,t){var n=this.tasks.read;return n&&!t||(n&&t&&n.abort(!0),n=this.tasks.read=this._readers.task(this.block)),this.__status__="read",this._readers.run(n,e),n.result()},n.prototype.free=function(){for(var e in delete this.tasks.read,this.tasks)this._workers.queue.removeTask(this.tasks[e]),delete this.tasks[e]},n.prototype.hash=function(e,t){return this._readAndHash("hash",i,e,t)},n.prototype.fileMd5=function(e,t){return this._hashRoute("file_md5",e,t)},n.prototype.fileSha1=function(e,t){return this._hashRoute("file_sha1",e,t)},n.prototype._hashHandle=function(e,t,n,i,o){var a=this.tasks[t];return a&&!o||(a&&o&&(a.abort(!0),delete this.tasks[t]),a=this.tasks[t]=this._workers.task(n(e))),this.__status__=t,this._workers.run(a,i),a.result()},n.prototype._readAndHash=function(t,n,i,o){var a=this,e=a.tasks[t];return!e||o?(e&&o&&(e.abort(!0),delete a.tasks[t]),a.read(i,!1).then(function(e){return a._nResumeReadTime=+new Date,a._hashHandle(e,t,n,i,o)})):(a._workers.run(e,i),e.result())},n.prototype._hashRoute=function(t,n,e){var i=this;return e instanceof Promise?e.then(function(e){return i._hashRoute(t,n,e)}):e?i._hashHandle(e,t,n,t,!0):i._readAndHash(t,n,t,!0)},n.prototype.cancel=function(){var e=this,t=this.tasks;for(var n in t)t[n]&&t[n].abort&&t[n].abort(!0),delete t[n];setTimeout(function(){e._workers.queue.resetWorker()},100)},e.exports=n},function(e,t){var o=2882377846;function h(e){for(var t=new ArrayBuffer(e.length/2),n=new Uint8Array(t),i=t.byteLength;i--;){var o=parseInt(e.substr(2*i,2),16);if(isNaN(o))throw new Error("parse hex err");n[i]=o}return t}function _(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e,!1),t}function g(e){var t=g.headABView;return t||(t=new DataView(new ArrayBuffer(16)),s(g.headABView=t,[o,1007,0])),t.setUint32(12,e,!1),t.buffer}function v(e,t,n){var i=v.bodyABLenView;i||(i=new DataView(new ArrayBuffer(20)),v.bodyABLenView=i);var o=r(e.size),a=r(t);return s(i,[o.low,a.low,n.byteLength,o.high,a.high]),i.buffer}var n=4294967295,a=n+1;function r(e){return{low:e&n,high:e/a|0}}function s(n,e,i){i||(i=0),e.forEach(function(e,t){n.setUint32(i+4*t,e,!1)})}t.genFTNRequestBody=function b(e,t,n,i,o){var a=h(e),r=_(a.byteLength),s=h(t),l=_(s.byteLength),c=v(n,o,i),u=c.byteLength+a.byteLength+s.byteLength+r.byteLength+l.byteLength+i.byteLength,d=g(u),f=new ArrayBuffer(u+d.byteLength),p=new Uint8Array(f),m=0;return[d,r,a,l,s,c,i].forEach(function(e){p.set(new Uint8Array(e),m),m+=e.byteLength}),p},t.parseFTNRespone=function l(e){var t=new DataView(e);if(t.getUint32(0,!1)!=o)throw new Error("Unknow response");var n=t.getUint32(4,!1);if(n)throw new Error("cgi,"+n);if(0==t.getUint8(16))return{nextOffset:function i(e,t){return e+(t||0)*a}(t.getUint32(17,!1),t.getUint32(21,!1))};if(1==t.getUint8(16))return{end:!0};throw new Error("Unknow status")}}]),function(e,m){function t(e){e=e||{},this._init(e)}t.prototype={_init:function(e){this.cfg=e||{}},monitorKeyDown:function(e){if(this.lastKeyDown=e.keyCode,this.isDirectionKey(e)&&this.isHintPanelShow(e))if(this.readyItemIndex=this.readyItemIndex||0,this.isKeyUp(e))this.makeItemReady(Math.max(0,this.readyItemIndex-1));else if(this.isKeyDown(e)){var t=m.CN("menu_item_addrlist",this.selectPanel).length;this.makeItemReady(Math.min(t-1,this.readyItemIndex+1))}},monitorKeyUp:function(a,r){this.win=r;var s=this;if(this.lastLastKeyUp=this.lastKeyUp,this.lastKeyUp=a.keyCode,this.isStartHintKey(a))if(!this.cfg.func.map&&!this.cfg.func.translate||s.isUsingTranslate)this.closeHint();else{var e=r.getSelection();this.originRange=e.getRangeAt(0),this.lastEditRange=e.getRangeAt(0),s.renderData([],[],e,r,s.renderTools)}else if(this.isCloseHintKey(a))this.closeHint(),(new Image).src="/cgi-bin/sellonlinestatic?type=session_statistics&businame=common_stat&item=webmail|at|hint|cancel&sid="+m.getSid();else if(this.isOmitKey(a))this.closeHint();else if(this.isDirectionKey(a)&&this.isHintPanelShow(a));else if(this.isConfirmKey(a))this.selectItem({type:"press"});else{e=r.getSelection();this.lastEditRange=e.getRangeAt(0),setTimeout(function(){var e=r.getSelection(),t=e.focusNode.parentNode,n=m.hasClass(t,"js_hint_node");if(n&&s.isDelKey(a))s.delItem(t);else if(!n&&!s.isUsingTranslate){var i=s.getHintData(e);if(i){var o=s.searchAddrData(i)||[];0<o.length?(s.renderData(o,i,e,r),s.searchData=o,s.hintData=i):s.closeHint()}else s.closeHint()}},5)}},getHintData:function(e){var t=e.focusNode.data||"",n=e.getRangeAt(0).endOffset,i=t.substr(0,n),o=t.substr(n),a=i.lastIndexOf("@");if(-1<a){var r=i.substr(a+1),s=o.match(/\s+/);return r+=s?o.substr(0,s.index):o}return!1},searchAddrData:function(e){return QMAddress.search(e,10)},renderData:function(e,t,n,i,o){var a=this,r=n.getRangeAt(0),s=r.startContainer,l=r.startOffset,c=this.selectPanel;if(c){c.parentNode&&c.parentNode.removeChild(c),this.lastEditRange.insertNode(c),(d=c.childNodes[0]).innerHTML="function"==typeof o?o.call(this):this.renderContent(e,t)}else{var u=a.win.document.createElement("div");this.lastEditRange.insertNode(u);u.parentNode;u.style.position="relative",u.style.display="inline-block",u.style["user-select"]="none",u.setAttribute("contenteditable",!1),u.setAttribute("id","addHintPanel"),(d=a.win.document.createElement("div")).innerHTML="function"==typeof o?o.call(this):this.renderContent(e,t),d.setAttribute("id","addrHintContent"),u.appendChild(d),d.style.position="absolute",this.selectPanel=u}var d=this.selectPanel.childNodes[0];this.selectPanel.offsetTop+d.offsetHeight>this.win.document.body.offsetHeight&&d.offsetHeight+30<this.selectPanel.offsetTop?d.style.top=-1*(d.offsetHeight+10)+"px":d.style.top="10px",this.selectPanel.offsetLeft+d.offsetWidth>this.win.document.body.offsetWidth&&d.offsetWidth+30<this.selectPanel.offsetLeft?d.style.left=-1*(d.offsetWidth+10)+"px":d.style.left="10px";var f=m.CN("menu_item_addrlist",this.selectPanel),p=m.CN("ico_close_d",this.selectPanel);m.E(f,function(e){m.addEvent(e,"click",function(e){a.onItemClick(e)})}),m.E(p,function(e){m.addEvent(e,"click",function(e){a.closeHint(e),(new Image).src="/cgi-bin/sellonlinestatic?type=session_statistics&businame=common_stat&item=webmail|at|hint|cancel&sid="+m.getSid()})}),0<e.length&&this.makeItemReady(0),r.setStart(s,l),r.collapse(!0),n.removeAllRanges(),n.addRange(r)},renderTools:function(){return this.TEMPLE.TOOL_LIST.replace(this.cfg.func)},renderContent:function(i,o){var e=m.S("RealAllSignature",this.win);return e&&(e.childNodes[0].style.overflow="visible"),m.E(i,function(e,t){i[t].index=t;var n=new RegExp(o,"g");i[t].nameHtml=i[t].name.replace(n,'<span style="color:red;">'+o+"</span>"),i[t].emailHtml=i[t].email.replace(n,'<span style="color:red;">'+o+"</span>")}),this.TEMPLE.ADDR_LIST.replace({members:i})},makeItemReady:function(e){for(var t=this.selectPanel,n=m.CN("menu_item_addrlist_current",t),i=0;i<n.length;++i)m.rmClass(n[i],"menu_item_addrlist_current");var o=m.CN("menu_item_addrlist",t);0<o.length&&(m.addClass(o[e],"menu_item_addrlist_current"),this.readyItemIndex=e)},selectItem:function(e){e=e||{};var t=(m.CN("menu_item_addrlist_current",this.win.document)||[])[0]||e.tar,n=getMainWin(),i=e.index||this.readyItemIndex;this.searchData=this.searchData||[];var o=this.searchData[i];if(o){var a=n.QMAddrInput.get("to",n);a&&(a.add('"'+o.name+'"<'+o.email+">;",!1,o.nid),this.insertResultNode(o,e.type),this.closeHint(),(new Image).src="/cgi-bin/sellonlinestatic?type=session_statistics&businame=common_stat&item=webmail|at|hint|confirm&sid="+m.getSid())}else if(t&&"tool"==t.getAttribute("data-type")){var r=t.getAttribute("data-tool");"map"==r?this.onMapClick():"translate"==r&&this.onTranslateClick()}},delItem:function(e){var t=getMainWin(),n=e.getAttribute("data-email");if(n){var i=t.QMAddrInput.get("to",t);i&&i.del(n)}e.parentNode.removeChild(e)},onItemClick:function(e){var t=e.currentTarget,n=t.getAttribute("data-index");isNaN(n)||this.selectItem({index:n,type:"click",tar:t})},onMapClick:function(){m.QMEditor.getEditor("compose")._moMapFunc._doDefaultClick()},onTranslateClick:function(){var t=this;if(t.translateHelper&&t.translateHelper.tipDom.parentNode){var e=t.translateHelper.tipDom.parentNode;e?e.removeChild(t.translateHelper.tipDom):t.translateHelper.tipDom.innerHTML=""}t.translateHelper=new m.QmText({ownerDom:t.win.document,translateMap:{hello:"\u4f60\u597d"},inputDesc:"\u8f93\u5165\u4f60\u60f3\u7ffb\u8bd1\u7684\u5185\u5bb9",useResultDesc:"\u4f7f\u7528\u8fd9\u4e2a\u7ed3\u679c",selectCallback:function(e){t.insertTransResult(e),t.translateHelper.hide()}}),t.closeHint(),t.isUsingTranslate=!0},insertTransResult:function(e){var t=this.win.getSelection();(t=this.win.getSelection()).removeAllRanges(),t.addRange(this.originRange),this.win.document.execCommand("delete",!1,null),this.originRange.insertNode(this.win.document.createTextNode(e)),t.removeAllRanges(),this.lastEditRange&&t.addRange(this.lastEditRange),this.isUsingTranslate=!1},insertResultNode:function(e,t){var n=this,i=e.name,o=this.hintData;if(i&&o){var a=this.win.getSelection();if(this.lastEditRange){if(this.lastEditRange.startContainer){var r=this.lastEditRange.startContainer.data;this.lastEditRange.startContainer.data=r.substr(0,r.length-o.length-1)}else if(this.lastEditRange.endContainer.data){r=this.lastEditRange.endContainer.data;this.lastEditRange.endContainer.data=r.substr(0,r.length-o.length-1)}a.removeAllRanges(),a.addRange(this.lastEditRange)}else{r=a.focusNode.data;a.focusNode.data=r.substr(0,r.length-o.length-1)}var s=this.lastEditRange,l=n.win.document.createElement("span");l.style.display="inline-block",l.innerText="@"+i,l.style.color="#4096E5",l.style.fontSize="14px",l.style.fontFamily="Verdana",l.style.cursor="pointer",l.className="js_hint_node",l.setAttribute("data-email",e.email),l.setAttribute("t",2),l.setAttribute("e",e.email),l.setAttribute("n",e.name),l.setAttribute("u",m.g_encryptuin),l.setAttribute("w",50),l.onclick=function(){m.QMProfileTips.doMouseEvent("over",n.win,l),n.lastShowTipTime=+new Date,setTimeout(function(){1e3<+new Date-n.lastShowTipTime&&m.QMProfileTips.doMouseEvent("out",n.win,l)},2500)};var c=this.win.document.createTextNode("\xa0");this.selectPanel.parentNode.insertBefore(l,this.selectPanel),this.selectPanel.parentNode.insertBefore(c,this.selectPanel),s.selectNodeContents(c),s.setStart(c,c.length),s.collapse(!0),a.removeAllRanges(),a.addRange(s),this.lastEditRange=s}},isStartHintKey:function(e){return console.log(e.key,this.lastKeyUp,this.lastLastKeyUp),"@"==e.key&&50==this.lastKeyUp||"2"==e.key&&50==this.lastKeyUp&&16==this.lastLastKeyUp},isCloseHintKey:function(e){return 27==e.keyCode},isOmitKey:function(e){return(e.altKey||e.ctrlKey||e.shiftKey)&&65==e.keyCode||16==e.keyCode||17==e.keyCode||18==e.keyCode||91==e.keyCode||92==e.keyCode||65==e.keyCode&&17==this.lastLastKeyUp||86==e.keyCode&&17==this.lastLastKeyUp},isDirectionKey:function(e){return this.isKeyUp(e)||this.isKeyDown(e)},isConfirmKey:function(e){return 13==e.keyCode},isHintPanelShow:function(){return this.selectPanel&&"none"!==this.selectPanel.style.display},isKeyUp:function(e){return 38==e.keyCode},isKeyDown:function(e){return 40==e.keyCode},isDelKey:function(e){return 8==e.keyCode},closeHint:function(){var e=this.selectPanel;if(e)e.parentNode&&e.parentNode.removeChild(e),delete this.selectPanel,delete this.readyItemIndex,delete this.searchData;else{var t=m.S("addHintPanel",this.win);t&&0<t.length?m.E(t,function(e){e.parentNode&&e.parentNode.removeChild(e)}):t&&t.parentNode&&t.parentNode.removeChild(t)}this.isUsingTranslate=!1},TEMPLE:{TOOL_LIST:TE(['<div class="menu_item_tip tipInner">','<div class="menu_item_title" style="background-color:#FFF;">',"<span>\u6309ESC\u952e\u5173\u95ed\u83dc\u5355\uff0c\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u8f93\u5165\u6dfb\u52a0\u6536\u4ef6\u4eba</span>",'<span title="\u5173\u95ed" dlg="close" class="ico_close_d"></span>',"</div>","$@$if($map$)$@$",'<div class="menu_item_addrlist" style="height:28px;line-height:28px;" data-type="tool" data-tool="translate">','<span style="color:#333;margin-left:17px;">\u7ffb\u8bd1\u52a9\u624b</span>',"</div>","$@$endif$@$","$@$if($map$)$@$",'<div class="menu_item_addrlist" style="height:28px;line-height:28px;" data-type="tool" data-tool="map">','<span style="color:#333;margin-left:17px;">\u5730\u56fe\u52a9\u624b</span>',"</div>","$@$endif$@$","</div>"]),ADDR_LIST:TE(['<div class="menu_item_tip tipInner">','<div class="menu_item_title" style="background-color:#FFF;">',"<span>\u6309ESC\u952e\u5173\u95ed\u83dc\u5355</span>",'<span title="\u5173\u95ed" dlg="close" class="ico_close_d"></span>',"</div>","$@$if($map$)$@$",'<div class="menu_item_addrlist" style="height:28px;line-height:28px;" data-index="$index$">','<span style="color:#333;margin-left:17px;">\u5730\u56fe\u52a9\u624b</span>',"</div>","$@$endif$@$","$@$for($members$)$@$",'<div class="menu_item_addrlist" style="height:28px;line-height:28px;" data-index="$index$">','<span style="color:#333;margin-left:17px;">$nameHtml$</span>&nbsp;<span class="tcolor">&lt;$emailHtml$&gt;</span>',"</div>","$@$endfor$@$","</div>"])}},m.AddrHint=t}(getMainWin(),getTop());