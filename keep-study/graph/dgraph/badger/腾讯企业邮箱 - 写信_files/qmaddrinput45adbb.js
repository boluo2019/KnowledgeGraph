var QMAddrParser={parseAddr:function(e){for(var t,o,n,i,s=[],a=getTop().trim(e||""),r=0,d=a.length;r<d;r=n[0])t=[],o=[],n=this._getSegment(a,r,t,o),(i=this._parseSegment(n[1],t,o)).addr&&s.push(i);return s},isEmailAddress:function(e){var t='[^\\s\\(\\)><@,;:\\\\\\"\\.\\[\\]]+',o="("+t+")",n=new RegExp("^"+o+"\\.?("+o+"\\.?)*$"),i=e.match(/^(.+)@(.+)$/);if("g_"==e.substring(0,2)&&-1==e.indexOf("@")){_oAddr=getTop().QMAddress._moAddrBook.personal;for(var s=0;s<_oAddr.length;s++){if(_oAddr[s].email==e)return!0}return!1}if(null==i)return!1;var a=i[1],r=i[2];for(s=0;s<a.length;s++)if(126<a.charCodeAt(s)||r.charCodeAt(s)<32)return!1;if(null==a.match(n))return!1;for(s=0;s<r.length;s++)if(126<r.charCodeAt(s)||r.charCodeAt(s)<32)return!1;var d=r.match(/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/);if(null!=d)for(s=1;s<=4;s++)if(255<d[s])return!1;var _=new RegExp("^"+t+"$"),l=r.split(".");for(s=0;s<l.length;s++)if(-1==l[s].search(_))return!1;return!0},_getSegment:function(e,t,o,n){for(var i,s,a,r,d="N",_=0,l=t,c="",m=0,u=0,h=t;"D"!=d;)s=d,m=0,"\\"==(i=e.charAt(h))&&"<"!=d&&(i=e.charAt(++h),m=1),""==i?(d="D",_=h):("N"==d?!m&&-1<(r='<(",; \uff0c\uff1b\u3001'.indexOf(i))?(d='<("DDDDD'.charAt(r),a='>)"'.charAt(r),_=2<r?h:h-1):c+=i:m||i!=a?c+=i:(d="N",_=h),++h),(d!=s||u)&&('"'!=s&&""==getTop().trim(c)||(o.push([c,s,l,e.substr(l,_-l+1)]),n.push(s)),u=0,c="",l=_+1);return[h,e.substr(t,h-t)]},_parseSegment:function(e,t,o){var n="",i="";switch(o.join("")){case"N":case"<":i=t[0][0];break;case'"<':case"N<":case'"N':n=t[0][0],i=t[1][0]}return i=getTop().trim(i),n=getTop().trim(n),/[^0-9]/.test(i)||(i+="@qq.com"),this.isEmailAddress(i)?{nick:n,addr:i,valid:!0}:{nick:"",addr:/[;, \uFF1B\uFF0C\u3001]$/.test(e)?e.slice(0,-1):e,valid:!1}}},QMAddrDomainCheck={_NOCHECK:";qzone.qq.com;qq.com;vip.qq.com;sina.com;163.com;126.com;yeah.net;163.net;21cn.com;yahoo.com;yahoo.com.cn;gmail.com;hotmail.com;",_moDomainData:{},_moProhibitData:{},_mnDelayTimeout:null,_setData:function(e){var t=this._moDomainData;if(e.checkdomain)for(var o=e.checkdomain,n=o.length-1;0<=n;n--){if(o[n])t[s=o[n][0]]=t[s]||{},t[s].tips=o[n][1].split(";")}if(e.domainlimit){var i=e.domainlimit;for(n=i.length-1;0<=n;n--){var s;if(i[n])t[s=i[n][0]]=t[s]||{},t[s].attlmt=parseInt(i[n][1]),t[s].dmn="1"==i[n][2]}}e.prohibit&&(this._moProhibitData[e.prohibit[0]]=e.prohibit[1])},createChecker:function(e,t,o){return new this._ui(e,t,o||{})},permit:function(e){return!this._moProhibitData[e.sort().join(";")]},_getTip:function(e){for(var t=[],o=e.length-1;0<=o;o--){var n=this._moDomainData[e[o]];n&&n.tips&&t.push({sDom:e[o],oTips:n.tips})}return t},getAttachLimit:function(e){for(var t,o=52428800,n=[],i=[],s=e.length-1;0<=s;s--){var a=this._moDomainData[e[s]];a?a.attlmt?a.attlmt<o&&(t=e[s],o=a.attlmt):n.push(e[s]):this._NOCHECK.indexOf(";"+e[s]+";")<0&&i.push(e[s])}return{sDom:t,nLim:i.length==e.length?-1:o,oUnknown:n,oNoCheck:i}},getExDomain:function(e){for(var t=[],o=e.length-1;0<=o;o--){var n=this._moDomainData[e[o]];n&&!n.dmn&&t.push(e[o])}return t},_parseAddr:function(e){var t={},o={},n=[],i=[],s=this._NOCHECK;try{s+=getTop().S("useraddr").innerHTML.split("@")[1]+";"}catch(d){}for(var a in getTop().E(QMAddrParser.parseAddr(e),function(e){e.valid&&(t[e.addr.split("@").pop()]=1)&&(o[e.addr]=1)}),t)-1==s.indexOf(";"+a+";")&&i.push(a);for(var r in o)n.push(r);return[i,n]},check:function(_asAddrs,_anType,_afCallBack){for(var _oSelf=this,_oTop=getTop(),_oAddrData=_oSelf._parseAddr(_asAddrs),_oCheckDomains=[],_sCheckAddress="",_oDomain=_oAddrData[0],_len=_oDomain.length,_i=0;_i<_len;_i++)_oSelf._moDomainData[_oDomain[_i]]||_oCheckDomains.push(_oDomain[_i]);return 4&_anType&&5<_oAddrData[1].length?_sCheckAddress=_oAddrData[1].sort().join(";"):_anType&=59,0==_oCheckDomains.length&&(_anType&=60),_anType?(_oSelf._mnDelayTimeout&&clearTimeout(_oSelf._mnDelayTimeout),_oSelf._mnDelayTimeout=setTimeout(function(){0!=_oCheckDomains.length&&_oTop.QMAjax.send("/cgi-bin/addr_domain_check",{method:"POST",content:_oTop.T("sid=$sid$&addrs=$addrs$&addrlist=$list$&acttype=$type$&t=addr_domain_check").replace({sid:_oTop.getSid(),type:3&_anType,list:encodeURI(_sCheckAddress),addrs:encodeURI("a@"+_oCheckDomains.join(";a@"))}),onload:function(_abIsOk,_asParam){_abIsOk&&0<_asParam.indexOf("success:true")&&(_oSelf._setData(eval(_asParam)),_oTop.callBack.call(_oSelf,_afCallBack,[{bCksp:_oSelf.permit(_oAddrData[1]),oCklm:_oSelf.getAttachLimit(_oAddrData[0]),oCkdm:_oSelf._getTip(_oAddrData[0])}]))}})},200)):_oTop.callBack.call(_oSelf,_afCallBack,[{bCksp:_oSelf.permit(_oAddrData[1]),oCklm:_oSelf.getAttachLimit(_oAddrData[0]),oCkdm:_oSelf._getTip(_oAddrData[0])}]),_oSelf}};function QMAddrInput(e){this.constructor=arguments.callee,this._initlize(e)._setup(e)._setEvent()._setAutoComplete()}function qmaddrinput_js(){}QMAddrDomainCheck._ui=function(e,t,o){var i=getTop(),s=this,a=[];s._moTmpl=QMAddrDomainCheck._ui._TEMPLATE,s._mnType=t;var n=e.join?e:[e];i.E(n,function(e,t){var o,n=e.getContainer?e.getContainer():e;n.parentNode.insertBefore(o=n.ownerDocument.createElement("div"),n.nextSibling),i.show(o,!1),i.addEvent(o,"click",function(e){return s._doEvent(e,t)}),a.push(o)}),s._moDispErrDomains=new Array(n.length),s._moInputObjs=n,s._moContainers=a,o.oPermit&&(_oBindContainer=o.oPermit,_oBindContainer.appendChild(_oContainer=_oBindContainer.ownerDocument.createElement("div")),i.show(s._moPermit=_oContainer,!1))},QMAddrDomainCheck._ui.prototype={check:function(){for(var e,t=this,o=t._mnType,n=t._moInputObjs,i=[],s=n.length-1;0<=s;s--)(e=n[s]).isDisabled&&e.isDisabled()||i.push(e.get?e.get(";"):e.value);QMAddrDomainCheck.check(i.join(";"),o,function(e){4&o&&t._show(t._moPermit,e.bCksp?[]:[1],4),1&o&&t._checkInput()})},_getDomain:function(){for(var e,t=this._moInputObjs,o=[],n=t.length-1;0<=n;n--)if(!(e=t[n]).isDisabled||!e.isDisabled())for(var i=e.get("json"),s=i.length-1;0<=s;s--)o.push(i[s].addr.replace(/.+@/,""));return o},getAttachLimit:function(){return QMAddrDomainCheck.getAttachLimit(this._getDomain())},getExDomain:function(){return QMAddrDomainCheck.getExDomain(this._getDomain())},_checkInput:function(){var i=this,s=(i._moInputObjs,i._moContainers);getTop().E(i._moInputObjs,function(o,n){if(!o.isDisabled||!o.isDisabled()){var e=o.get?o.get(";"):o.value;QMAddrDomainCheck.check(e,1,function(e){var t=e.oCkdm;i._moDispErrDomains[n]=t,o.setDomainError&&o.setDomainError(t),i._show(s[n],t,1)})}})},_show:function(e,t,o){if(e){var n=getTop(),i=t.length,s=n.qmAnimation,a="expand"==s.getActionType(e)&&""==e.style.display;if(0<i){var r={errors:[],type:o},d=r.errors;if(1&o)for(var _=0;_<i;_++){var l=t[_],c={domain:l.sDom,items:[]};n.E(l.oTips,function(e){c.items.push({data:e})}),d.push(c)}e.innerHTML=this._moTmpl.replace(r),a||s.expand(e,{type:"break"})}else a&&s.fold(e,{type:"break"})}},_doEvent:function(e,t){var o=getTop(),n=this._moContainers[t],i=this._moInputObjs[t],s=this._moDispErrDomains[t],a=o.getEventTarget(e);if(a.name){var r=a.parentNode.getAttribute("domain"),d=a.name;if(i.updateDomain)i.updateDomain(r,d);else{var _=[],l=o.TE('$@$if($nick$)$@$"$nick$"<$@$endif$@$$addr$$@$if($nick$)$@$>$@$endif$@$');o.E(QMAddrParser.parseAddr(i.value),function(e){var t=e.addr.split("@");t.pop()==r&&(e.addr=[t[0],d].join("@")),e.nick=getTop().encodeNick(e.nick),_.push(l.replace(e))}),i.value=_.join(";")}for(var c=0,m=s.length;c<m;c++)if(s[c].sDom==r){s.splice(c,1);break}this._show(n,s,1)}}},QMAddrDomainCheck._ui._TEMPLATE=getTop().TE(['<div style="padding:3px 0;line-height: 18px; margin: 4px 0 0 0;" class="domainCheckDisp">',"$@$if($type$&4)$@$",'<div class="txt_red">\u60a8\u6dfb\u52a0\u7684\u6536\u4ef6\u4eba\u90ae\u4ef6\u5730\u5740\u8fc7\u591a\uff0c\u8bf7\u53bb\u9664\u90e8\u5206\u5730\u5740\u3002</div>',"$@$else$@$",'<div class="graytext">\u6211\u4eec\u53d1\u73b0\u60a8\u8f93\u5165\u7684\u5730\u5740\u53ef\u80fd\u6709\u8bef\uff0c\u8bf7\u9009\u62e9\u4fee\u6539\uff1a</div>',"$@$for($errors$)$@$",'<div style="margin-top: 4px;" domain="$domain$">',"$domain$","$@$for($items$)$@$","$@$if($_idx_$!=0)$@$",",&nbsp;","$@$else if($data$)$@$"," \u2192 ","$@$endif$@$",'<a name="$data$">$data$</a>',"$@$endfor$@$","</div>","$@$endfor$@$","$@$endif$@$","</div>"]),QMAddrInput.get=function(e,t){var o=t[this._CONST._nCacheId];return o&&o[e]},QMAddrInput.prototype={add:function(e,t,o,n,i){var s=this,a=QMAddrParser.parseAddr(e),r=a.length,d=i?0:1;return getTop().E(a,function(e){s._mbInContact&&(o||(e.valid=!1)),!n&&s._addItem(e.addr,e.nick,e.valid,o,d),n&&s._addItem(e.addr,e.nick,!0,o,d)}),r&&getTop().show(s._moDefaultText,!1),r&&!t&&getTop().callBack.call(this,this._mEvent._onchange,["add"]),a},clear:function(){for(var e=this._moAddrList,t=e.length;0!=e.length;)this._deleteItem(e[0]);return t&&getTop().callBack.call(this,this._mEvent._onchange,["del"]),this},del:function(e,t){this.hasAddr(e)&&(this._deleteItem(e),t||getTop().callBack.call(this,this._mEvent._onchange,["del"]))},disabled:function(e){return this._mbIsDisabled="boolean"!=typeof e||e,this},edit:function(e){var t=this,o=t._moAddrMap[e];if(o){var n=o._sNick&&getTop().encodeNick(o._sNick);t._moSelectCtrl.blur(),t._cancelSelectItem(),t._addTextCtrlValue(),t._insertTextBefore(e),t._deleteItem(e),t._changeTextValue(t._moTemplate._ADDREDIT.replace({nick:n,addr:e,splitchar:t._msSplitChar})),t.focus(n?3+n.length:0)}return t},flush:function(){return this._addTextCtrlValue(),this},focus:function(e){var t=this;switch(e){case"all":return t._setTextCursorRange(0,-1);case"start":return t._setTextCursorRange(0,0);case"end":return t._setTextCursorRange(-1,-1)}return"number"==typeof e?t._setTextCursorRange(e,e):"string"==typeof e?t._focusWithLock()._selectItem(e):t._focusWithLock()},get:function(o){var n=[],e=this._moAddrList,i=this._moAddrMap;return"autocomplete"==o?this._moAutoComplete:!o||{error:1,errhtml:1,json:1,validemail:1}[o]?(getTop().E(e,function(e){var t=i[e];switch(o){case"error":t._bIsValid||n.push(e);break;case"errhtml":t._bIsValid||n.push(getTop().htmlEncode(e));break;case"json":n.push({nick:t._sNick,addr:e,valid:t._bIsValid,nid:t._sNid,format:t._sNick?['"',getTop().encodeNick(t._sNick),'"<',e,">"].join(""):e});break;case"validemail":t._bIsValid&&n.push(e);break;default:n.push(t._sNick?['"',getTop().encodeNick(t._sNick),'"<',e,">"].join(""):e)}}),n):e.join(o)},getContainer:function(){return this._moContainer},getId:function(){return this._msId},getOwnerWindow:function(){return this._moWindow},hasAddr:function(e){return this._moAddrMap.hasOwnProperty(e)},isDisabled:function(){return this._mbIsDisabled},length:function(){return this._moAddrList.length},updateDomain:function(t,o){var n=this,i=[],e=this._moAddrList,s=this._moAddrMap;getTop().E(e,function(e){s[e]._sDomain==t&&i.push(e)}),getTop().E(i,function(e){var t=s[e];n._insertTextBefore(e),n.add(n._moTemplate._ADDREDIT.replace({nick:t._sNick,addr:[t._sAlias,o].join("@")}),!0),n._deleteItem(e,!0)}),getTop().callBack.call(this,this._mEvent._onchange,["change"])},setDomainError:function(e){var t=this._moErrorDomainMap;return getTop().E(e,function(e){t[e.sDom]||(t[e.sDom]=!0)}),this._updateErrorDomainDisplay()},_addItem:function(e,t,o,n,i){var s=this,a=s._moAddrMap,r=s._moAddrList,d=s._moTextContainer,_=d.previousSibling,l=(_?s._getAddrPos(_.getAttribute("addr")):-1)+1,c=getTop().QMAddress.getAddress(e).isgroup?1:0;"g_"==e.substring(0,2)&&-1==e.indexOf("@")&&(c=1);var m=i&&c;if(a[e])r.splice(s._getAddrPos(e),1),s._moContainer.insertBefore(a[e]._oDom,d);else{var u=s._moTemplate,h=getTop().htmlEncode(e),p=t,f=e.split("@"),g=o?f[1]:"";function T(e,t){return getTop().htmlEncode(getTop().getAsiiStrLen(e)>t?getTop().subAsiiStr(e,t,"..."):e)}_sAlias=o?f[0]:e,getTop().insertHTML(d,"beforeBegin",u._ADDRITEM.replace({nick:p&&T(p,s._moConst._nMaxNickAsiiLen),alias:_sAlias&&T(_sAlias,s._moConst._nMaxAddrAsiiLen),domain:g&&getTop().htmlEncode(g),addr:h,css:s._moStyle,dispmode:s._msDispMode,splitchar:s._msSplitChar,isvalid:o,isdomainerr:!!s._moErrorDomainMap[g],images_path:getTop().getPath("image"),isshowprofile:m,isgroup:c}));var v=d.previousSibling;a[e]={_sNick:t,_sAlias:_sAlias,_sDomain:g,_oDom:v,_bIsValid:o,_sNid:n},s._setAddrItemEvent(v,e)}s._adjustContainerHeight(),r.splice(l,0,e)},_addTextCtrlValue:function(){return 0!=this.add(getTop().trim(this._moTextCtrl.value))&&(this._changeTextValue(""),!0)},_adjustContainerHeight:function(){var e=this._moContainer;this._mnMaxHeight&&getTop().gnIEVer<7&&(e.style.height="auto",e.offsetHeight>this._mnMaxHeight&&(e.style.height=this._mnMaxHeight+"px"))},_adjustTextWidth:function(e){var t=this,o=t._getTextContainerLen(e);if(229==e&&setTimeout(function(){t._adjustTextWidth(48)}),this._mnTextWidthCache!=o){this._mnTextWidthCache=o;var n=t._moTextContainer,i=t._moConst._nBasicWidth,s=t._moConst._nStepWidth,a=o<i?0:1+Math.floor((o-i)/s),r=Math.min(i+s*a,t._moContainer.offsetWidth-5);r!=n.clientWidth&&(n.style.width=r+"px","paste"==e&&(n.scrollLeft=0))}},_cancelSelectItem:function(e,t){var o=this._moAddrSelInfo;if(this._hasAddrSelected()){var n=o._oData;if(e){var i=o._oList,s=n[e];if(s){this._setAddrItemClass(s,"normal");for(var a=0,r=i.length;a<r;a++)if(i[a]==e){i.splice(a,1);break}delete n[e]}}else{for(var d in n)this._setAddrItemClass(n[d],"normal");o._oData={},o._oList=[],t||(o._nCursorPos=null)}return!0}return!1},_changeTextValue:function(e){this._moTextCtrl.value=e,this._adjustTextWidth()},_deleteItem:function(e){var t="string"==typeof e?e:e.getAttribute("addr"),o=this._moAddrMap[t],n=this._mEvent;o&&(getTop().removeSelf(o._oDom),delete this._moAddrMap[t],this._moAddrList.splice(this._getAddrPos(t),1)),n._onNotify&&n._onNotify()},_deleteSelectItems:function(e,t){var o=this._moAddrSelInfo;if(0!=o._nLength){var n=o._oList,i=this._getAddrPos(n[n.length-1]),s=o._oData;for(var a in this._cancelSelectItem(),s)this._deleteItem(a);var r=this._moAddrList,d=r.length;e||(0!=d&&this._insertTextBefore(i<d?r[i]:null),this.focus("start")),t||getTop().callBack.call(this,this._mEvent._onchange,["del"])}},_focusWithLock:function(){return this._lockFocus()._moTextCtrl.focus(),this._unlockFocus()},_getAddrPos:function(e){for(var t=this._moAddrList,o=0,n=t.length;o<n;o++)if(t[o]==e)return o;return-1},_getAutoCompleteData:function(){var e=getTop(),t=this._moTextCtrl.value,o=[];if(e.QMAddress){var n;n=this._mbInContact?e.QMAddress.search(t,15,["personal","client","biz","emailgroup"]):e.QMAddress.search(t,15);for(var i=0;i<n.length;i++){var s=n[i],a=e.T('"$name$" <$email$>').replace(s),r=new RegExp(t.replace(/([\(\)\.\*\$\[\]\{\}\\])/g,"\\$1"),"g"),d=";;;"+t+";;;",_=new RegExp(d.replace(/([\(\)\.\*\$\[\]\{\}\\])/g,"\\$1"),"g"),l="<b>"+t+"</b>";a=e.htmlEncode(a.replace(r,d)).replace(_,l),o.push({sId:s.nid,oAddress:s,sItemValue:a})}}return o},_getCtrlKeyName:function(){return{cmd:getTop().gbIsMac?"Command":"Ctrl"}},_getTextContainerLen:function(e){var t=this._moTextCtrl.value,o=229==e;if(!(!!t||(32==e||48<=e&&e<229)||o))return 0;8==e&&(t=t.slice(0,-1));var n=t+"WW";if(n==this._msStrLenCacheValue&&!o)return this._mnStrLenCacheResult;var i=this._moStrLenCalcer;return this._msStrLenCacheValue=n,i.innerHTML=getTop().htmlEncode(n).replace(/ /gi,"&nbsp;"),this._mnStrLenCacheResult=i.scrollWidth},_getTextPos:function(){var e=this._moTextContainer.previousSibling;return e?this._getAddrPos(e.getAttribute("addr")):-1},_getTextSelectionState:function(){var e=this._moTextCtrl,t=e.value,o=this._moWindow,n=o.document,i={_nLength:t.length};if(n.selection){var s=e.createTextRange(),a=n.selection.createRange();function r(e){try{return s.moveStart("character",0),s.setEndPoint(["EndTo",e].join(""),a),(s.text||"").length}catch(t){return-1}}i._nStart=r("Start"),i._nEnd=r("End")}else{(s=n.createRange()).selectNode(e);try{a=o.getSelection().getRangeAt(0);var d=1==s.compareBoundaryPoints(Range.START_TO_nStart,a),_=-1==s.compareBoundaryPoints(Range.END_TO_nEnd,a),l=!d&&!_}catch(c){l=!0}i._nStart=l?e.selectionStart:-1,i._nEnd=l?e.selectionEnd:-1}return-1==i._nStart?i._sType="none":i._nStart!=i._nEnd?i._sType="range":i._sType="point",i},_hasAddrSelected:function(){return 0<this._moAddrSelInfo._oList.length},_hideContextMenu:function(){this._moContextMenu.style.left="-200px"},_initlize:function(e){var t=this,o=t.constructor;try{t._moConst=o._CONST,t._moTemplate=o._TEMPLATE,t._msId=e.id,t._moWindow=e.win,t._moContainer=e.dom.container,t._mnMaxHeight=e.maxHeight,t._mnMaxItemView=e.maxItemView||15,t._mnMinWidth=e.minWidth||220,t._mnWidth=e.width||"auto",t._moStyle=getTop().extend({text:"addr_text",normal:"addr_base addr_normal",over:"addr_base addr_over attbg",select:"addr_base addr_select fn_list",error:"addr_base addr_error",errover:"addr_base addr_errover attbg",errsel:"addr_base addr_errsel fn_list",dmerror:"addr_base addr_domain_err",dmerrover:"addr_base addr_domain_errover attbg",dmerrsel:"addr_base addr_domain_errsel fn_list",move:"addr_move",mover:"addr_mover"},e.style),t._msDispMode=e.dispMode,t._msSplitChar=e.splitChar||";",t._msDefaultText=e.defaultText||t._moContainer.getAttribute("defaultText"),t._mbIsEnableTip=!1!==e.isEnableTip,t._mbIsFocusAC=!0===e.isFocusAC,t._mfFilterFunc=e.filterFunc,t._mbIsDisabled=!1,t._moAddrList=[],t._moAddrMap={},t._moErrorDomainMap={},t._mbSimple=e.bSimple,t._mbInContact=e.inContact,t._moAddrSelInfo={_oList:[],_oData:{},_nCursorPos:null},t._mEvent={_onfocus:e.onfocus,_onblur:e.onblur,_onchange:e.onchange,_onkeydown:e.onkeydown,_onNotify:e.onNotify},o._set(t)}catch(n){throw new Error("QMAddrInput constructor:"+n.message)}return t},_insertTextBefore:function(e){var t=this,o=(t._moAddrMap[e]||{})._oDom||t._moContainer.lastChild;return t._moTextContainer.nextSibling!=o&&t._moContainer.insertBefore(t._moTextContainer,o),t},_bIsCollapsed:function(){var e=this,t=e._mbIsTextFocus?e._moTextCtrl:e._moSelectCtrl;return!e._isFocus()||(e._moWindow.getSelection?t.selectionStart==t.selectionEnd:"None"==e._moWindow.document.selection.type)},_isFocus:function(){return this._mbIsTextFocus||this._hasAddrSelected()},_isFocusLock:function(){return this._mbIsFocusLock},_isItemSelected:function(e){return this._moAddrSelInfo._oData["string"==typeof e?e:e.getAttribute("addr")]},_loadInputRange:function(){this._moInputRange&&(window.getSelection||this._moInputRange.select(),this._moInputRange=null)},_lockFocus:function(){return this._mbIsFocusLock=!0,this},_moveItem:function(e,t){var o=this._moAddrMap,n=o[e];if(n){var i=this._moAddrList,s=o[t];i.splice(this._getAddrPos(e),1),s?(this._moContainer.insertBefore(n._oDom,s._oDom),i.splice(this._getAddrPos(t),0,e)):(this._moContainer.insertBefore(n._oDom,this._moTextContainer),i.push(e))}},_saveInputRange:function(){if((this._hasAddrSelected()?this._moSelectCtrl:this._moTextCtrl).focus(),window.getSelection){var e=this._moWindow.getSelection();this._moInputRange=e&&e.rangeCount?e.getRangeAt(0):null}else this._moInputRange=this._moWindow.document.selection.createRange()},_selectItem:function(e,t){var o=this._moAddrMap[e],n=this._moAddrSelInfo;if(o)if("shift"==t){var i,s=this._moAddrList,a=this._moAddrMap,r=n._nCursorPos,d=this._getAddrPos(e);"number"!=typeof r&&-1==(i=this._getAddrPos(n._oList[0]))&&(r=n._nCursorPos=this._getTextPos()),"number"==typeof r&&(i=r+(r<d?1:0)),this._cancelSelectItem(!1,!0);var _=d<i?-1:1,l=n._oList,c=n._oData,m=i;for(d=d+_;m!=d;m+=_){var u=s[m];l.push(u),this._setAddrItemClass(n._oData[u]=a[u]._oDom,"select")}}else if("add"!=t&&this._cancelSelectItem(),this._isItemSelected(e))this._cancelSelectItem(e);else{l=n._oList;this._addTextCtrlValue(),l.push(e),this._setAddrItemClass(n._oData[e]=o._oDom,"select")}if(this._hasAddrSelected()){for(var h=[],p=(s=this._moAddrList,a=this._moAddrMap,c=n._oData,m=0,this.length());m<p;m++){if(c[u=s[m]]){var f=a[u];h.push(f._sNick?['"',getTop().encodeNick(f._sNick),'"<',u,">"].join(""):u)}}h.push("");var g=this._moSelectCtrl;g.value=h.join(";"),g.focus(),g.select()}return this},_selectAllItem:function(){var e=this._moAddrList;this._addTextCtrlValue(),this._selectItem(e[0]),this._selectItem(e[e.length-1],"shift")},_setAutoComplete:function(){var _=this,n=getTop();return _._mbIsEnableTip&&_.constructor._isShowTip(),_._moAutoComplete=new n.QMAutoComplete({oInput:_._moTextCtrl,oPosObj:_._moContainer,nMaxItemView:_._mnMaxItemView,nMinWidth:_._mnMinWidth,nWidth:_._mnWidth,ongetdata:function(e){return _._getAutoCompleteData()},onclick:function(e,t){if(!t){var o=n.getEventTarget(e);o&&"hidetip"==o.getAttribute("opt")&&(this.setHeader(""),_.constructor._hideTip())}},onselect:function(e){var t=getTop(),o=e.oAddress,n=t.T('"$nick$"<$addr$>;'),i=[];function s(e){return n.replace({nick:t.encodeNick(t.htmlDecode(e.name)),addr:t.htmlDecode(e.email)})}if(o.nShortcutGroupId)for(var a=t.QMAddress.getGroup(o.nShortcutGroupId).addressesId,r=0,d=a.length;r<d;r++)_oAddr=t.QMAddress.getAddress(a[r]),_oAddr.nShortcutGroupId||i.push(s(_oAddr));else i.push(s(o));e.isAptitude&&t.ossLog("realtime","all","stat=custom&type=addressaptitude&info=select"),_._doAutoCompleteSelect(i.join(""),o.nid)},ontouchstart:function(){_._lockFocus()}}),_},_setAddrItemEvent:function(e,t){this._addEventForDom(e,{click:this._doAddrItemClick,dblclick:this._doAddrItemDblclick,mouseover:this._doAddrItemMouseOver,mouseout:this._doAddrItemMouseOut},t);for(var o,n=e.childNodes,i=this._mEvent,s=0,a=n.length;s<a;s++)"a"==(o=n[s]).nodeName.toLowerCase()&&"del"==o.getAttribute("name")&&this._addEventForDom(o,{click:this._delSpanClick})&&(s=a);i._onNotify&&i._onNotify()},_setAddrItemClass:function(e,t){var o=this,n="",i={move:"select",mover:"select"}[t],s=o._moAddrMap[e.getAttribute("addr")];return i?n=o._moStyle[t]:i=t||"normal",s&&!s._bIsValid?i={normal:"error",over:"errover",select:"errsel"}[i]:s&&o._moErrorDomainMap[s._sDomain]&&(i={normal:"dmerror",over:"dmerrover",select:"dmerrsel"}[i]),getTop().setClass(e,[o._moStyle[i],n].join(" ")),o},_emptyFuntion:function(){},_setEvent:function(e){var t=this,o=t._mbInContact;t._addEventForDom(t._moContainer,{mousedown:t._doContainerMouseDown,selectstart:t._doContainerSelectStart,contextmenu:o?t._emptyFuntion:t._doContainerContextMenu});var n={focus:t._doTextFocus,blur:t._doTextBlur,keydown:t._doTextKeyDown,keyup:t._doTextKeyUp,paste:o?t._emptyFuntion:t._doTextPaste};return getTop().gbIsTT&&(n.keypress=t._doTextKeyPressForTT),t._addEventForDom(t._moTextCtrl,n),t._addEventForDom(t._moSelectCtrl,{focus:t._doSelectFocus,blur:t._doSelectCancel,keydown:t._doSelectKeyDown,keyup:t._doSelectKeyUp,paste:o?t._emptyFuntion:t._doSelectPaste,cut:t._doSelectCut}),t._addEventForDom(t._moContextMenu,{click:t._doContextMenuClick,contextmenu:t._stopEvent}),t._addEventForDom(t._moDefaultText,{click:t.focus}),t._addEventForDom(t._moMemberCtrl,{click:t.showMemDlg}),t},showMemDlg:function(){var a=this,t=getTop().TE(['<ul class="treeview">',"$@$if($addrs.length$==0)$@$",'<li style="padding:50px 0;text-align:center;background-color:#fff;">','<span class="node_txt">\u6682\u65f6\u6ca1\u6709\u8054\u7cfb\u4eba</span>',"</li>","$@$endif$@$","$@$for($addrs$)$@$","$@$if($email$)$@$",'<li role="checkbox" aria-checked="false" tabindex="0" ku="ku_choose" ck="choose" class="tree_node open" title="$email$" nid="$nid$" aria-label="$@$eval getTop().htmlEncode($name$)$@$" style="outline:0;">','<div class="node_content">','<span class="node_icon">','$@$if($kind$=="emailgroup")$@$','<i class="u_avatar i_group"></i>',"$@$else$@$",'<i class="u_avatar i_man"></i>',"$@$endif$@$","</span>",'<span class="node_txt">$@$eval getTop().htmlEncode($name$)$@$</span>',"</div>","</li>","$@$endif$@$","$@$endfor$@$","</ul>",""]),e=getTop().TE(['<div class="addr_popup">','<div class="tk_people">','<div class="edit_member member_input s_blur">','<div id="addr" style="_width:100%;_height:30px;"></div>',"</div>","</div>",'<div  class="opp_addr">','<div class="member_con" style="height:275px">','<div class="floder_nav">','<ul id="tab_nav" class="f_navobj">','<li tabindex="0" id="nav_personal" class="folder_nav_first fn" ck="changeTab" ku="ku_change_tab" tabfor="tab_personal" title="\u4e2a\u4eba\u5730\u5740\u672c" style="outline:0;"><span>\u4e2a\u4eba</span></li>','<li tabindex="0" id="nav_biz" class="folder_nav_item " ck="changeTab" ku="ku_change_tab" tabfor="tab_biz" title="\u4f01\u4e1a\u5730\u5740\u672c" style="outline:0;"><span>\u4f01\u4e1a</span></li>','<li tabindex="0" id="nav_client" class="folder_nav_item " ck="changeTab" ku="ku_change_tab" tabfor="tab_client" title="\u516c\u5171\u5730\u5740\u672c" style="outline:0;"><span>\u516c\u5171</span></li>','<li tabindex="0" id="nav_group" class="folder_nav_last " ck="changeTab" ku="ku_change_tab" tabfor="tab_group" title="\u90ae\u4ef6\u7fa4\u7ec4" style="outline:0;"><span>\u90ae\u4ef6\u7fa4\u7ec4</span></li>',"</ul>","</div>",'<div id="tab_personal" class="form_tree tab_personal">',"</div>",'<div id="tab_biz" class="form_tree" style="display:none">',"</div>",'<div  id="tab_client" class="form_tree" style="display:none">',"</div>",'<div id="tab_group" class="form_tree" style="display:none">',"</div>",'<div id="" class="form_tree" style="display:none">',"</div>","</div>","</div>","</div>"]);getTop().confirmBox({id:"addNewContactToInput",title:"\u6dfb\u52a0"+{to:"\u6536\u4ef6\u4eba",bcc:"\u5bc6\u9001",cc:"\u6284\u9001",sc:"\u5206\u522b\u53d1\u9001"}[a._msId],width:484,sType:"custom",msg:e,onreturn:function(e){if(e){var t=this._oAddrInput.get("json")||[];if(t&&200<t.length)return getTop().showError("\u6536\u4ef6\u4eba\u4e2a\u6570\u4e0d\u5f97\u8d85\u8fc7200"),!1;getTop().E(t,function(e){a.add(e.format,!1)})}},onclose:function(){a.focus()},onload:function(){var n=this;getTop().loadJsFile(getTop().getPath("js")+getTop().getFullResSuffix("qmmemtree.js"),!0,getTop().document,function(){var i=getTop().QMAddress,s=new QMAddrInput({bSimple:!0,id:"new"+a._msId,win:getTop(),dom:{container:n.S("addr")}});(n._oAddrInput=s,(new(getTop().QMMemTree)).init({oRoot:i.getPersonalTree(),oDom:n.S("tab_personal"),fGetParty:function(e,t){t(i.getAddress(e))},onselect:function(e){var t=i.getAddress(e);t.bParty?getTop().E(t.children,function(e){!e.bParty&&e.email&&s.add('"'+e.name+'"<'+e.email+">",!1,undefined,undefined,!0)}):s.add('"'+t.name+'"<'+t.email+">",!1,undefined,undefined,!0)}}),i.isShared("client"))?0==i.getClientTree().children.length?n.S("tab_client").innerHTML=t.replace({addrs:i.getGroup("client")}):(new(getTop().QMMemTree)).init({oRoot:i.getClientTree(),oDom:n.S("tab_client"),fGetParty:function(e,t){t(i.getAddress(e))},onselect:function(e){var t=i.getAddress(e);t.bParty?getTop().E(t.children,function(e){!e.bParty&&e.email&&s.add('"'+e.name+'"<'+e.email+">",!1,undefined,undefined,!0)}):s.add('"'+t.name+'"<'+t.email+">",!1,undefined,undefined,!0)}}):getTop().show(n.S("nav_client"),!1);i.isShared("emailgroup")?n.S("tab_group").innerHTML=t.replace({addrs:i.getGroup("emailgroup")}):getTop().show(n.S("nav_group"),!1),i.isShared("biz")?i.getPartyTree(function(e){(new(getTop().QMMemTree)).init({oRoot:e,oDom:n.S("tab_biz"),fGetParty:function(e,t){i.getFullParty(e,t)},onselect:function(e){if(""!=e){var t=i.getAddress(e);t.bParty?i.getAddressFromRemote(e,function(e){e=e||[],getTop().E(e,function(e){s.add('"'+e.name+'"<'+e.email+">",!1,undefined,undefined,!0)})}):s.add('"'+t.name+'"<'+t.email+">",!1,undefined,undefined,!0)}}})}):getTop().show(n.S("nav_biz"),!1),setTimeout(function(){n._oAddrInput.focus()},500);var e={click:{choose:{bPropagable:!1},changeTab:{bPropagable:!1}},keyup:{ku_change_tab:{bPropagable:!1},ku_choose:{bPropagable:!1}}},o={ku_choose:function(e,t){32!=e.keyCode&&13!=e.keyCode||o.choose(e,t)},ku_change_tab:function(e,t){13==e.keyCode&&o.changeTab(e,t)},choose:function(e,t){var o=t.getAttribute("nid"),n=i.getAddress(o);s.add('"'+n.name+'"<'+n.email+">",!1,undefined,undefined,!0),t.setAttribute("aria-checked","true")},changeTab:function(e,t){var o=t.getAttribute("tabfor");getTop().show(n.S("tab_personal"),!1),getTop().show(n.S("tab_client"),!1),getTop().show(n.S("tab_biz"),!1),getTop().show(n.S("tab_group"),!1),getTop().show(n.S(o),!0),getTop().rmClass(n.S("nav_personal"),"fn"),getTop().rmClass(n.S("nav_client"),"fn"),getTop().rmClass(n.S("nav_biz"),"fn"),getTop().rmClass(n.S("nav_group"),"fn"),getTop().addClass(t,"fn")}};getTop().liveEvent(n.getPanelDom(),{rule:function(){return e},events:function(){return o}})})}})},_setTextCursorRange:function(e,t){var o=this._moTextCtrl,n=o.value.length;function i(e){return e||(e=0),e<0&&(e=n+e+1),e<0?0:n<e?n:e}var s=i(e),a=i(t);if(o.createTextRange){var r=o.createTextRange();r.moveStart("character",s),r.collapse(),r.moveEnd("character",a-s),r.select(),this._focusWithLock()}else this._focusWithLock(),o.selectionStart=s,o.selectionEnd=a;return this},_setup:function(e){var t,o,n,i,s,a=this,r=a._moContainer,d=e.tabIndex;r.unselectable="on",r.style.cursor="text",r.innerHTML=a._moTemplate._INPUT.replace({css:a._moStyle.text,width:a._moConst._nBasicWidth,defaulttext:a._msDefaultText,id:e.id}),t=a._moMemberCtrl=r.firstChild,o=a._moDefaultText=t.nextSibling,n=a._moTextContainer=o.nextSibling,i=a._moTextCtrl=n.firstChild,s=a._moStrLenCalcer=n.lastChild,a._moSelectCtrl=r.lastChild.firstChild,a._mbSimple||getTop().waitFor(function(){return getTop().QMAddress&&getTop().QMAddress.isInit()},function(e){e?t.style.display="":getTop().QMAddress&&getTop().QMAddress.initAddress()},100,3e4),a._mnTabIndex="number"==typeof d?d:0,i.tabIndex=d,a._syncFontStyle(s,i);var _=[],l=a._moWindow.document.body;return getTop().E(a._moConst._oMenuItems,function(e){var t=e.split("|");_.push("seperater"==t[0]?a._moTemplate._CONTEXTMENU_SEP:a._moTemplate._CONTEXTMENU_ITEM.replace({operate:t[0],name:t[1],shortcut:getTop().T(t[2]||"").replace(a._getCtrlKeyName())}))}),getTop().insertHTML(l,"afterBegin",a._moTemplate._CONTEXTMENU.replace({items:_.join(""),width:getTop().gbIsMac?160:130})),a._moContextMenu=l.firstChild,a},_showAutoComplete:function(){return this._moAutoComplete.show(this._getAutoCompleteData()),this},_showContextMenu:function(e,t){var o=this._moWindow.document.body,n=o.clientWidth,i=o.clientHeight,s=this._moContextMenu,a=s.clientWidth,r=s.clientHeight;s.style.left=o.scrollLeft+(n<e+a?e-a:e)+"px",s.style.top=o.scrollTop+(i<t+r?t-r:t)+"px";var d=this._bIsCollapsed();getTop().E(getTop().GelTags("div",s)[0].childNodes,function(e){switch(e.getAttribute("opt")){case"cut":case"copy":case"delete":getTop().setClass(e,d?"menu_item_nofun":"menu_item")}})},_syncFontStyle:function(t,o){getTop().E("fontFamily,fontSize,fontWeight,lineHeight,wordSpacing".split(","),function(e){t.style[e]=getTop().getStyle(o,e)})},_unlockFocus:function(){return this._mbIsFocusLock=!1,this},_updateErrorDomainDisplay:function(){var i=this,s=i._moAddrMap,a=i._moErrorDomainMap;return getTop().E(i._moAddrList,function(e){var t=s[e],o=a[t._sDomain]?i._moTemplate._ADDRITEM.replace({},"errdomainmsg"):t._bIsValid?e:i._moTemplate._ADDRITEM.replace({},"errmsg"),n=t._oDom;n.title!=o&&(n.title=o,i._setAddrItemClass(n,"normal"))}),i},_readyToCalcAddrItemDispInfo:function(){var e,t,o,n,i,s,a,r,d,_,l,c,m,u=this._moAddrList,h=this._moAddrMap;this._moAddrItemCalcInfo&&delete this._moAddrItemCalcInfo,0!=u.length&&(e=h[u[0]]._oDom,o=(t=h[u[u.length-1]]._oDom).nextSibling,n=e.offsetParent,s=(i=getTop().calcPos(n))[0],a=i[3],r=e.offsetHeight),_=(d=getTop().calcPos(this._moContainer))[0],l=d[3],c=d[2],m=d[1],this._moAddrItemCalcInfo={_oFirstItem:e,_oLastItem:t,_nEndItem:o,_nOffsetTop:s,_nOffsetLeft:a,_oItemHeight:r,_oContainerTop:_,_oContainerLeft:l,_oContainerBottom:c,_oContainerRight:m}},_isInContainer:function(e){var t=this._moAddrItemCalcInfo,o=e.clientX,n=e.clientY;return o>=t._oContainerLeft&&o<=t._oContainerRight&&n>=t._oContainerTop&&n<=t._oContainerBottom},_getNearestAddrItemInfo:function(e,t){var o={};if(!("limit"==t)||this._isInContainer(e)){var n=this._getAddrItemRowsList(),i=n.length;if(0<i){var s,a,r,d,_,l,c,m,u,h,p=this._moAddrItemCalcInfo,f=e.clientX-p._nOffsetLeft,g=e.clientY-p._nOffsetTop,T=this._getPointRow(e.clientY);T<0?T=0:i<=T&&(T=i-1),a=(s=n[T]._oRowList).length;for(var v=0,C=9999999;v<a&&(r=f-(u=s[v]).offsetLeft,d=u.offsetWidth-r,(h=Math.min(Math.abs(r),Math.abs(d)))<C);v++)_=u,C=h,c=r,m=d;l=_.offsetTop,o._oItem=_,o._nRow=T,o._nXin=0<c&&0<m,o._nYin=l<=g&&g<=l+p._oItemHeight,o._sAlign=c<m?"left":"right"}}return o},_getAddrItemRowsList:function(){var e=this._moAddrItemCalcInfo,t=e._oRowsList;if(t)return t;var o,n,i,s=e._oFirstItem,a=e._nEndItem;for(e._oRowsList=t=[];s&&s!=a;s=s.nextSibling)s.getAttribute("addr")&&(n!=(i=s.offsetTop)?(n=i,o=[s],t.push({_nOffsetTop:n,_oRowList:o})):o.push(s));return t},_getPointRow:function(e){var t=this._moAddrItemCalcInfo,o=t._oContainerTop,n=this._getAddrItemRowsList().length;return n?Math.floor((e-o)*n/(t._oContainerBottom-o)):0},_addEventForDom:function(t,o,n){var i=this;for(var s in o)!function(){var e=o[s];getTop().addEvent(t,s,function(){e.call(i,arguments[0],t,n)})}();return i},_doContainerMouseDown:function(e,t){var o=this,n=e.srcElement||e.target;if(window.getSelection&&0==e.button||!window.getSelection&&1==e.button){var i=("SPAN"==n.tagName||"B"==n.tagName?n.parentNode:n).getAttribute("addr"),s=n!=o._moTextCtrl;if(n==t&&(getTop().now()-(o._mnContainerClickTime||0)<300?o._selectAllItem():o._doContainerMoveSelection(e,t),o._mnContainerClickTime=getTop().now()),i){if(e.ctrlKey||e.metaKey)o._selectItem(i,"add");else if(e.shiftKey)o._selectItem(i,"shift");else if(!o._isItemSelected(i)){var a=t.parentNode.scrollTop;o._selectItem(i),t.parentNode.scrollTop=a}}else(s||0==o._moTextCtrl.value.length)&&o._doContainerTrySelect(e);s&&getTop().preventDefault(e),(s||0==o._moTextCtrl.value.length)&&o._moAutoComplete.close(),o._hideContextMenu()}else if(2==e.button||getTop().gbIsIE&&0==e.button){if(n!=o._moTextCtrl)(i=("SPAN"==n.tagName||"B"==n.tagName?n.parentNode:n).getAttribute("addr"))&&!o._isItemSelected(i)&&(getTop().gbIsIE&&(this._mbIsTextFocus=!1),o._selectItem(i)),o._stopEvent(e),o._saveInputRange()}else n!=o._moTextCtrl&&o._stopEvent(e)},_doContainerSelectStart:function(e){var t=e.srcElement||e.target;t!=this._moTextCtrl&&t!=this._moSelectCtrl&&getTop().preventDefault(e)},_doContainerDragStart:function(e,t,r){var d=this,i=this._moWindow,s=i.document,_=i.captureEvents?i:s.body,a=e.clientX,l=e.clientY,c=s.createElement("div"),m=s.createElement("div");c.className="addr_cursor",c.innerHTML="&nbsp;",m.style.cssText="position:absolute;z-index:99999;top:-999px;left:-999px;",m.innerHTML=this._moTemplate._MOVER;var u=this._moContainerMouseDownInfo={_bIsInitlize:!1,_oInsertCursor:c,_oMover:m,_oContainer:t,_fDoMouseUp:function(e){if(d._moContainerMouseDownInfo){d._moContainerMouseDownInfo=null,d._releaseCapture(),getTop().removeEvent(_,"mouseup",u._fDoMouseUp),getTop().removeEvent(_,"mousemove",u._fDoMouseMove);try{if(u._bIsInitlize){var t=d._moSelectCtrl.value,o=u._oObjectList[u._nInObjIdx]._oInstance,n=o._moContainer,i=[],s=d._moAddrList;c.parentNode==n&&(n.style.backgroundColor="#fff",getTop().E(s,function(e){d._isItemSelected(e)&&i.push(e)}),d._deleteSelectItems(!0,!0),n.insertBefore(o._moTextContainer,c),o.add(t,!0),getTop().E(i,function(e){o._selectItem(e,"add")}),d==o?getTop().callBack.call(d,d._mEvent._onchange,["move"]):(getTop().callBack.call(d,d._mEvent._onchange,["del"]),getTop().callBack.call(o,o._mEvent._onchange,["add"])))}else d._selectItem(r)}catch(a){doPageError(a.message,"/js/qmaddrinput.js","_fDoMouseUp")}getTop().removeSelf(c),getTop().removeSelf(m),delete m,delete c,delete u}d._stopEvent(e)},_fDoMouseMove:function(e){if(!u._bIsInitlize&&8<Math.max(Math.abs(a-e.clientX),Math.abs(l-e.clientY))){var n=[],t=s.body;if(getTop().E(QMAddrInput._get(i),function(e,t){var o=getTop().calcPos(e._moContainer);o[2]&&(e==d&&(u._nInObjIdx=t),n[t]={_oInstance:e,_nPos:o},e._readyToCalcAddrItemDispInfo())}),t.insertBefore(m,t.firstChild),getTop().gsAgent&&-1!=getTop().gsAgent.indexOf("mac")){var o=m.firstChild.style;o.left=parseInt(o.left)-2,o.top=parseInt(o.top)-4}u._bIsInitlize=!0,u._oObjectList=n}d._doContainerDragMove(e),d._stopEvent(e)}};this._setCapture(),getTop().addEvent(_,"mouseup",u._fDoMouseUp),getTop().addEvent(_,"mousemove",u._fDoMouseMove)},_doContainerDragMove:function(e){var t=this._moContainerMouseDownInfo;if(t&&t._bIsInitlize){var o,n=t._oInsertCursor,i=t._oMover,s=t._oObjectList,a=t._nInObjIdx,r=s[a]._oInstance._moContainer;i.style.left=e.clientX-5+"px",i.style.top=e.clientY-5+"px";for(var d=s.length-1;0<=d;d--){var _=s[d];if(_&&_._oInstance&&_._oInstance._isInContainer(e)){o=_._oInstance;break}}if(o){a!=d&&(t._nInObjIdx=d);o._moAddrItemCalcInfo;var l=o._moContainer,c=o._getNearestAddrItemInfo(e),m=c._oItem;m&&"right"==c._sAlign&&(m=m.nextSibling),l!=r&&(r.style.backgroundColor="#fff"),t._oContainer!=l&&(l.style.backgroundColor="#f9f2b3"),l.insertBefore(n,m||l.firstChild)}else n.parentNode==r&&(getTop().removeSelf(n),r.style.backgroundColor="#fff")}},_doContainerContextMenu:function(e){(e.srcElement||e.target)!=this._moTextCtrl&&(this._stopEvent(e),this._loadInputRange(),this._showContextMenu(e.clientX,e.clientY),this._moAutoComplete.close())},_doContainerMoveSelection:function(e,t){for(var o=t.childNodes,n=o[1].offsetParent,i=getTop().calcPos(n),s=i[3],a=i[0],r=e.clientX,d=e.clientY,_=!1,l=0,c=o.length-1;l<c;l++){var m=o[l],u=a+m.offsetTop,h=r<=s+m.offsetLeft+2,p=d<=u,f=d<=u+m.offsetHeight;if(h&&f||!h&&p){var g=m.getAttribute("addr");g?m.previousSibling==this._moTextContainer?this.focus("end"):(this._addTextCtrlValue(),this._insertTextBefore(g),this.focus("start")):this.focus("start"),_=!0;break}}_||(m==this._moTextContainer?this.focus("end"):(this._addTextCtrlValue(),this._insertTextBefore(),this.focus("start")))},_doContainerTrySelect:function(e){if(0!=this._moAddrList.length&&0==this._moTextCtrl.value.length){var t=this._moWindow,o=t.captureEvents?t:t.document.body,_=this,l=e.clientX,c=e.clientY,n=this._moContainerMouseDownInfo={_bIsInitlize:!0,_fDoMouseUp:function(e){_._moContainerMouseDownInfo&&(_._moContainerMouseDownInfo=null,_._releaseCapture(),getTop().removeEvent(o,"mouseup",n._fDoMouseUp),getTop().removeEvent(o,"mousemove",n._fDoMouseMove),delete n),_._stopEvent(e)},_fDoMouseMove:function(e){if(_._moContainerMouseDownInfo){var t,o,n=e.clientX,i=e.clientY;if(2<Math.abs(n-l)||5<Math.abs(i-c)){_._moAddrItemCalcInfo;var s,a=_._getNearestAddrItemInfo(e),r=a._oItem,d=a._nRow;if(a._nXin)t=r;else s=d==_._getPointRow(c)?n<l?"left":"right":i<c?"left":"right",a._sAlign==s?r&&r["left"==s?"previousSibling":"nextSibling"]!=_._moTextContainer&&(t=r):t=r&&r["right"==s?"previousSibling":"nextSibling"]}(o=t&&t.getAttribute("addr"))?_._selectItem(o,"shift"):_._cancelSelectItem()&&_.focus("start")}_._stopEvent(e)}};this._readyToCalcAddrItemDispInfo(),this._setCapture(),getTop().addEvent(o,"mouseup",n._fDoMouseUp),getTop().addEvent(o,"mousemove",n._fDoMouseMove)}},_doTextFocus:function(e){var t=this;t._mbIsTextFocus=!0,getTop().show(t._moDefaultText,!1),setTimeout(function(){t._mbIsFocusAC&&!t.length()&&t._showAutoComplete()}),getTop().callBack.call(t,t._mEvent._onfocus,[e])},_doTextBlur:function(e){var t=this;t._isFocusLock()||(t._mbIsTextFocus&&t._hideContextMenu(),t._mbIsTextFocus=!1,t._addTextCtrlValue(),!t.length()&&getTop().show(t._moDefaultText,!0),getTop().callBack.call(t,t._mEvent._onblur,[e]))},_doTextKeyDown:function(_aoEvent){_aoEvent=_aoEvent||window.event;var target=_aoEvent.srcElement||_aoEvent.target,father=target.parentNode.parentNode.parentNode.firstChild;if("function"==typeof eval(father.getAttribute)||"object"==typeof eval(father.getAttribute)){var _sCheckInput=father.getAttribute("id");if("addNewContactToInputFilter"==_sCheckInput.substring(0,26)||"GrpDetailAdd"==_sCheckInput.substring(0,12)){for(var _oAddr=getTop().QMAddress._moAddrBook.personal,_oTemp=[],i=0;i<_oAddr.length;i++){var _sName=_oAddr[i].email;_sName?"g_"==_sName.substring(0,2)&&-1==_sName.indexOf("@")||_oTemp.push(_oAddr[i]):"personal"!=_oAddr[i].kind&&_oTemp.push(_oAddr[i])}getTop().QMAddress._moAddrBook.personal=_oTemp}}switch(this._adjustTextWidth(_aoEvent.ctrlKey?0:_aoEvent.keyCode),_aoEvent.keyCode){case 59:case 186:case 188:if(_aoEvent.shiftKey)break;case 32:this._addTextCtrlValue()&&this._stopEvent(_aoEvent);break;case 8:var _oTextSelState=this._getTextSelectionState();"point"==_oTextSelState._sType&&0==_oTextSelState._nStart&&this._moTextContainer.previousSibling&&(this._deleteItem(this._moTextContainer.previousSibling),this._stopEvent(_aoEvent),getTop().callBack.call(this,this._mEvent._onchange,["del"]));break;case 46:var _oTextSelState=this._getTextSelectionState();"point"==_oTextSelState._sType&&_oTextSelState._nEnd==_oTextSelState._nLength&&this._moTextContainer.nextSibling&&(this._deleteItem(this._moTextContainer.nextSibling),this._stopEvent(_aoEvent),getTop().callBack.call(this,this._mEvent._onchange,["del"]));break;case 37:var _oTextSelState=this._getTextSelectionState(),_oPreviousItem=this._moTextContainer.previousSibling,_sPreviousAddr=_oPreviousItem&&_oPreviousItem.getAttribute("addr");"point"==_oTextSelState._sType&&0==_oTextSelState._nStart&&_sPreviousAddr&&(_aoEvent.shiftKey?this._selectItem(_sPreviousAddr,"shift"):(this._addTextCtrlValue(),this._insertTextBefore(_sPreviousAddr),this.focus("start")),this._stopEvent(_aoEvent));break;case 39:var _oTextSelState=this._getTextSelectionState(),_oNextItem=this._moTextContainer.nextSibling,_sNextAddr=_oNextItem&&_oNextItem.getAttribute("addr");"point"==_oTextSelState._sType&&_oTextSelState._nEnd==_oTextSelState._nLength&&_sNextAddr&&(_aoEvent.shiftKey?this._selectItem(_sNextAddr,"shift"):(this._addTextCtrlValue(),this._insertTextBefore(_oNextItem.nextSibling.getAttribute("addr")),this.focus("start")),this._stopEvent(_aoEvent));break;case 36:var _oTextSelState=this._getTextSelectionState();"point"==_oTextSelState._sType&&0==_oTextSelState._nStart&&(this._addTextCtrlValue(),_aoEvent.shiftKey&&-1!=this._getTextPos()?this._selectItem(this._moAddrList[0],"shift"):(this._insertTextBefore(this._moAddrList[0]),this.focus("start")),this._stopEvent(_aoEvent));break;case 35:var _oTextSelState=this._getTextSelectionState();if("point"==_oTextSelState._sType&&_oTextSelState._nEnd==_oTextSelState._nLength){this._addTextCtrlValue();var _nAddrListLastPos=this._moAddrList.length-1;_aoEvent.shiftKey&&this._getTextPos()!=_nAddrListLastPos?this._selectItem(this._moAddrList[_nAddrListLastPos],"shift"):(this._insertTextBefore(),this.focus("start")),this._stopEvent(_aoEvent)}break;case 65:if(_aoEvent.ctrlKey||_aoEvent.metaKey){var _oTextSelState=this._getTextSelectionState(),_oAddrList=this._moAddrList;0==_oTextSelState._nStart&&_oTextSelState._nEnd==_oTextSelState._nLength&&0!=_oAddrList.length&&(this._addTextCtrlValue(),this._selectItem(_oAddrList[0]),this._selectItem(_oAddrList[_oAddrList.length-1],"shift"),this._stopEvent(_aoEvent))}break;case 38:case 40:if(!this._moAutoComplete.isShow()){var _bIsUp=38==_aoEvent.keyCode,_oNode=this._moTextContainer[_bIsUp?"previousSibling":"nextSibling"];if(_sAddr=_oNode.getAttribute("addr"),_nAddrPos=this._getAddrPos(_sAddr),-1!=_nAddrPos){var _oOffsetParent=_oNode.offsetParent,_nOffsetPos=getTop().calcPos(_oOffsetParent),_nParentTop=_nOffsetPos[0],_nParentLeft=_nOffsetPos[3],_oTextPos=getTop().calcPos(this._moTextContainer);_nTextTop=_oTextPos[0],_nTextLeft=_oTextPos[3],_oClientPos=getTop().calcPos(this._moContainer),_nClientLeft=_oClientPos[3],_nClientTop=_oClientPos[0],_oAddrList=this._moAddrList,_oAddrMap=this._moAddrMap,_nDulta=9999999,_sDultaAddr=null,_oDultaItem=null;for(var i=_nAddrPos,_oListLen=_oAddrList.length,_nLen=_bIsUp?-1:_oListLen+1,_nStep=_bIsUp?-1:1;i!=_nLen;i+=_nStep){if(i==_oListLen)var _sCurAddr="",_sAddrItem=_oAddrMap[_oAddrList[_oListLen-1]]._oDom,_oItemLeft=_nParentLeft+_sAddrItem.offsetLeft+_sAddrItem.offsetWidth,_oItemTop=_nParentTop+_sAddrItem.offsetTop,_nDisHeight=Math.abs(_oItemTop-_nTextTop);else var _sCurAddr=_oAddrList[i],_sAddrItem=_oAddrMap[_sCurAddr]._oDom,_oItemLeft=_nParentLeft+_sAddrItem.offsetLeft,_oItemTop=_nParentTop+_sAddrItem.offsetTop,_nDisHeight=Math.abs(_oItemTop-_nTextTop);if(Math.abs(_oItemLeft-_nClientLeft)<5&&5<Math.abs(_oItemTop-_nClientTop)){var _oParentNode=_sAddrItem.previousSibling;_nDisHeight-=_sAddrItem.offsetHeight*_nStep,_oItemLeft=_nParentLeft+_oParentNode.offsetLeft+_oParentNode.offsetWidth}if(!(_nDisHeight<5)){if(_nDisHeight>5+_sAddrItem.offsetHeight)break;var _nCurDulta=Math.abs(_oItemLeft-_nTextLeft);if(_nCurDulta>=_nDulta)break;_nDulta=_nCurDulta,_sDultaAddr=_sCurAddr,_oDultaItem=_oDultaItem}}null!=_sDultaAddr&&(this._addTextCtrlValue(),_aoEvent.shiftKey?this._selectItem(_sDultaAddr,"shift"):(this._insertTextBefore(_sDultaAddr),this.focus("start")))}this._stopEvent(_aoEvent)}break;case 13:if(!this._moAutoComplete.isShow()){var _oSelf=this;_oSelf._isFocusLock()||(_oSelf._mbIsTextFocus&&_oSelf._hideContextMenu(),_oSelf._mbIsTextFocus=!1,_oSelf._addTextCtrlValue(),!_oSelf.length()&&getTop().show(_oSelf._moDefaultText,!0),getTop().callBack.call(_oSelf,_oSelf._mEvent._onblur,[_aoEvent]))}break;default:getTop().callBack.call(this,this._mEvent._onkeydown,[_aoEvent])}this._hideContextMenu()},_doTextKeyPressForTT:function(){this._adjustTextWidth()},_doTextKeyUp:function(e){this._adjustTextWidth(),186!=e.keyCode&&188!=e.keyCode&&59!=e.keyCode||this._addTextCtrlValue()&&this._stopEvent(e)},_doTextPaste:function(){var e=this;this._moWindow.setTimeout(function(){e._adjustTextWidth("paste"),getTop().gbIsFF&&(getTop().show(e._moTextCtrl,!1),setTimeout(function(){getTop().show(e._moTextCtrl,!0),e.focus("end")}))},0),this._moWindow.setTimeout(function(){-1!=e._moTextCtrl.value.indexOf("@")&&e._addTextCtrlValue()},100)},_doSelectFocus:function(e){this._moSelectCtrl.tabIndex=this._mnTabIndex,getTop().callBack.call(this,this._mEvent._onfocus,[e])},_doSelectCancel:function(e){this._moSelectCtrl.tabIndex=-1,this._hasAddrSelected()&&(this._cancelSelectItem(),this._hideContextMenu(),getTop().callBack.call(this,this._mEvent._onblur,[e]))},_doSelectKeyDown:function(e){switch(e.keyCode){case 8:case 46:this._deleteSelectItems();break;case 37:var t=(i=(n=this._moAddrSelInfo)._oList)[i.length-1];if(e.shiftKey){var o=this._getAddrPos(t)-1;0<=o?this._selectItem(this._moAddrList[o],"shift"):-1==this._getTextPos()&&(this._insertTextBefore(this._moAddrList[0]),this.focus("start"))}else this._cancelSelectItem(),this._insertTextBefore(t),this.focus("start");break;case 39:var n,i;t=(i=(n=this._moAddrSelInfo)._oList)[i.length-1];if(e.shiftKey){var s=this._getAddrPos(t)+1;s<=(r=this._moAddrList.length-1)?this._selectItem(this._moAddrList[s],"shift"):this._getTextPos()==r&&(this._insertTextBefore(),this.focus("start"))}else{var a=n._oData[t].nextSibling.getAttribute("addr");this._cancelSelectItem(),this._insertTextBefore(a),this.focus("start")}break;case 36:e.shiftKey&&-1!=this._getTextPos()?this._selectItem(this._moAddrList[0],"shift"):(this._insertTextBefore(this._moAddrList[0]),this.focus("start")),this._stopEvent(e);break;case 35:var r=this._moAddrList.length-1;e.shiftKey&&this._getTextPos()!=r?this._selectItem(this._moAddrList[r],"shift"):(this._insertTextBefore(),this.focus("start")),this._stopEvent(e);break;default:getTop().callBack.call(this,this._mEvent._onkeydown,[e])}(!e.ctrlKey&&!e.metaKey||67!=e.keyCode&&86!=e.keyCode&&88!=e.keyCode)&&9!=e.keyCode&&this._stopEvent(e),this._hideContextMenu()},_doSelectKeyUp:function(e){if(13==e.keyCode||113==e.keyCode){var t=this._moAddrSelInfo._oList,o=t[t.length-1];this.edit(o),this._stopEvent(e)}},_doSelectPaste:function(e){var t=this;this._moWindow.setTimeout(function(){t._deleteSelectItems(),t._moTextCtrl.value=t._moSelectCtrl.value,t._adjustTextWidth("paste"),t.focus("end")})},_doSelectCut:function(){var e=this;this._moWindow.setTimeout(function(){e._deleteSelectItems()})},_delSpanClick:function(e,t,o){getTop().stopPropagation(e);var n=(e.srcElement||e.target).parentNode.getAttribute("addr");n&&this._deleteItem(n)},_doAddrItemClick:function(e,t,o){"IMG"==(e.srcElement||e.target).tagName&&getTop().isObjContainTarget(t,e.srcElement||e.target)&&this._deleteItem(o)},_doAddrItemDblclick:function(e,t,o){this._mbInContact||getTop().isObjContainTarget(t,e.srcElement||e.target)&&(this.edit(o),getTop().stopPropagation(e))},_doAddrItemMouseOver:function(e,t){this._moContainerMouseDownInfo||this._isItemSelected(t)||!getTop().isObjContainTarget(t,e.srcElement||e.target)||this._setAddrItemClass(t,"over")},_doAddrItemMouseOut:function(e,t){this._moContainerMouseDownInfo||this._isItemSelected(t)||getTop().isObjContainTarget(t,e.relatedTarget||e.toElement)||!getTop().isObjContainTarget(t,e.srcElement||e.target)||this._setAddrItemClass(t,"normal")},_doContextMenuClick:function(e){var t=e.srcElement||e.target;if("menu_item_nofun"!=t.className){var o=this;switch(t.getAttribute("opt")){case"cut":o._hideContextMenu(),getTop().gbIsIE?o._moWindow.document.execCommand("Cut"):alert(getTop().T("\u60a8\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u7f16\u8f91\u5668\u81ea\u52a8\u6267\u884c\u526a\u5207\u64cd\u4f5c\uff0c\u8bf7\u4f7f\u7528\u952e\u76d8\u5feb\u6377\u952e($cmd$+X)\u6765\u5b8c\u6210\u3002").replace(o._getCtrlKeyName()));break;case"copy":o._hideContextMenu(),getTop().gbIsIE?o._moWindow.document.execCommand("Copy"):alert(getTop().T("\u60a8\u7684\u6d4f\u89c8\u5668\u5b89\u5168\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u7f16\u8f91\u5668\u81ea\u52a8\u6267\u884c\u590d\u5236\u64cd\u4f5c\uff0c\u8bf7\u4f7f\u7528\u952e\u76d8\u5feb\u6377\u952e($cmd$+C)\u6765\u5b8c\u6210\u3002").replace(o._getCtrlKeyName()));break;case"paste":if(o._hideContextMenu(),getTop().gbIsIE)o._moWindow.document.execCommand("Paste");else{var n=prompt(getTop().T(["\u56e0\u4e3a\u4f60\u7684\u6d4f\u89c8\u5668\u7684\u5b89\u5168\u8bbe\u7f6e\u539f\u56e0\uff0c\u672c\u7f16\u8f91\u5668\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u4f60\u7684\u526a\u8d34\u677f\u5185\u5bb9\uff0c\u4f60\u9700\u8981\u5728\u672c\u5bf9\u8bdd\u6846\u91cd\u65b0\u7c98\u8d34\u4e00\u6b21\u3002\n\n","\u8bf7\u4f7f\u7528\u952e\u76d8\u5feb\u6377\u952e($cmd$+V)\u628a\u5185\u5bb9\u7c98\u8d34\u5230\u4e0b\u9762\u7684\u65b9\u6846\u91cc\uff0c\u518d\u6309 \u786e\u5b9a\u3002"]).replace(o._getCtrlKeyName()));n&&(o._moTextCtrl.value=n,o._adjustTextWidth(),o.focus("end"))}break;case"delete":o._hideContextMenu(),o._hasAddrSelected()?o._deleteSelectItems():o._moWindow.document.execCommand("delete");break;case"selectall":o._hideContextMenu(),o._selectAllItem()}}},_doAutoCompleteSelect:function(e,t){this._changeTextValue(""),this.add(e,!1,t),this.focus()},_setCapture:function(){var e=this._moContainer;e.setCapture?e.setCapture():this._moWindow.captureEvents&&this._moWindow.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)},_stopEvent:function(e){getTop().preventDefault(e)},_releaseCapture:function(){var e=this._moContainer;e.releaseCapture?e.releaseCapture():this._moWindow.releaseEvents&&this._moWindow.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP)}},QMAddrInput._CONST={_nCacheId:"QMAddrInput_aTGdf$#HAsGf",_nMaxNickAsiiLen:25,_nMaxAddrAsiiLen:40,_nBasicWidth:13,_nStepWidth:1,_oMenuItems:["cut|\u526a\u5207|$cmd$+X","copy|\u590d\u5236|$cmd$+C","paste|\u7c98\u8d34|$cmd$+V","delete|\u5220\u9664","seperater","selectall|\u5168\u9009|$cmd$+A"]},QMAddrInput._get=function(e){var t=[],o=e&&e[this._CONST._nCacheId];for(var n in o)t.push(o[n]);return t},QMAddrInput._set=function(e){var t=e._moWindow,o=this._CONST._nCacheId;t[o]||(t[o]=new t.Object),t[o][e._msId]=e},QMAddrInput._TEMPLATE={_INPUT:getTop().TE(['<a hidefocus class="icon_addr" title="\u70b9\u51fb\u9009\u62e9\u66f4\u591a\u8054\u7cfb\u4eba" style="display:none"></a>','<div style="position:absolute;color:#A0A0A0;padding-top:1px;',"$@$if(!$defaulttext$)$@$","display:none;","$@$endif$@$",'">$defaulttext$</div>','<div class="$css$" style="float:left;border:none;overflow:hidden;width:$width$px;">','<input type="input" style="border:none;outline:none;-webkit-appearance:none;width:100%;" aria-labelledby="$id$_btn" aria-label="\u586b\u5199\u6536\u4ef6\u4eba\uff0c\u591a\u4e2a\u4f7f\u7528\u5206\u53f7\u9694\u5f00" />','<div id="calCC" style="width:1px;height:1px;overflow:auto;*overflow:hidden;white-space:nowrap;border:none;margin:0;padding:0;"></div>',"</div>",'<div style="clear:both;border:none;margin:0;padding:0;" unselectable="on">','<input type="text" style="position:absolute;border:none;padding:0;width:10px;left:-9999px;top:-9999px;" tabindex=-1 >',"</div>"]),_MOVER:getTop().T(['<div style="width:8px;height:8px;*width:12px;*height:12px;','font-size:1px;border:2px solid #7B7D84;position:absolute;top:18px;left:9px;"></div>','<div style="background:#fff;width:11px;height:11px;font:1px;opacity:0;filter:alpha(opacity:0);"></div>']),_CONTEXTMENU:getTop().T(['<table style="position:absolute;z-index:2999;left:-200px;top:0;"',' cellspacing="0" cellpadding="0" onmousedown="return false;" unselectable="on">',"<tr><td>",'<div style="border:1px solid #ACA899;width:$width$px;padding:2px;background:#fff;">',"$items$","</div>",'</td><td style="height:100%;filter:alpha(opacity=50);opacity:0.5;">','<div style="margin-top:4px;border-left:2px solid black;height:100%;"></div>',"</td></tr>",'<tr><td style="filter:alpha(opacity=50);opacity:0.5;">','<div style="margin-left:4px;border-top:2px solid black;height:2px;"></div>','</td><td style="filter:alpha(opacity=50);opacity:0.5;">','<div style="margin-left:0px;border-top:2px solid black;height:2px;"></div>',"</td></tr>","</table>"]),_CONTEXTMENU_ITEM:getTop().T(['<div class="menu_item" onmouseover="',"if (this.className == 'menu_item')","{","this.className = 'menu_item_high';","}",'" onmouseout="',"if (this.className == 'menu_item_high')","{","this.className = 'menu_item';","}",'" style="padding:0 20px;line-height:19px;" unselectable="on" opt="$operate$">','<div style="float:right;" unselectable="on" opt="$operate$">$shortcut$</div>',"$name$","</div>"]),_CONTEXTMENU_SEP:getTop().T(['<div style="font-size:1px;height:7px;overflow:hidden;" unselectable="on">','<div style="border-top:1px solid #ACA899;margin-top:3px;"></div>',"</div>"]),_ADDREDIT:getTop().TE(['$@$if($nick$)$@$"$nick$"<$@$endif$@$',"$addr$","$@$if($nick$)$@$>$@$endif$@$","$splitchar$"]),_ADDRDISP:getTop().T(["$alias$","$@$if($domain$)$@$",'<span t="u" class="domain" unselectable="on" addr="$addr$">@$domain$</span>',"$@$endif$@$"])},QMAddrInput._TEMPLATE._ADDRITEM=getTop().TE(['<div t="$isshowprofile$" e="$addr$" b g="$isgroup$" n="$nick$" class="',"$@$if(!$isvalid$)$@$","$css.error$","$@$else if($isdomainerr$)$@$","$css.dmerror$","$@$else$@$","$css.normal$","$@$endif$@$",'" style="float:left;white-space:nowrap;" ','addr="$addr$" unselectable="on" nick="$nick$">',"$@$if($nick$)$@$",'<b t="u" unselectable="on" addr="$addr$">$nick$</b>','<span t="u" unselectable="on" addr="$addr$"','$@$if($dispmode$=="onlynick")$@$',' style="display:none";',"$@$endif$@$",">&lt;",QMAddrInput._TEMPLATE._ADDRDISP,"&gt;</span>","$@$else$@$",'<b t="u" unselectable="on" addr="$addr$">',QMAddrInput._TEMPLATE._ADDRDISP,"</b>","$@$endif$@$",'<span class="semicolon">',"$splitchar$","</span>",'<a href="javascript:;" class="addr_del" name="del"></a>',"</div>"]),QMAddrInput._isShowTip=function(){var o=getTop(),n="IS_SHOW_TOADDR_TIP",e=o.getGlobalVarValue(n);return void 0===e&&(o.setGlobalVarValue(n,"loading"),o.QMAjax.send("/cgi-bin/readtemplate",{content:o.T("sid=$sid$&t=tip&s=isshowtip&tipid=29").replace({sid:o.getSid()}),onload:function(e,t){o.setGlobalVarValue(n,t)}})),7!=o.gnIEVer&&"true"==e},QMAddrInput._hideTip=function(){getTop().ossLog("realtime","all","stat=tips&type=close&tipid=29"),getTop().setGlobalVarValue("IS_SHOW_TOADDR_TIP","false")};