(function(s){var $={_sQReply:"quickreply",_sQSource:"source",_sQSendBtn:"sendbtn",_sQReplyTxtContainer:"qmQuickReplyTextContainer",_sQReplyBtnContainer:"qmQuickReplyButtonContainer",_sAfterSendDiv:"afterSendDiv",_sAfterSendingDiv:"afterSendingDiv",_sQuickReplyPart:"QuickReplyPart",_sQMEditorArea:"QMEditorArea",_sQMEditorToolArea:"QMEditorToolBarPlusArea",_sJumpToNewWin:"jumpToNewWin",_sReplyFrm:"replyfrm",_sSubMailStartDiv:"submail_start_div",_sContentDiv:"contentDiv",_sImgStar:"img_star",_sStarStatus:"starStatus",_sTagContainer:"tagContainer",_sMailContainer:"mailContentContainer",_sSendTimeMsg:"send_time_msg",_sAttachment:"attachment",_sPageEnd:"pageEnd",_sNextMailTop:"nextmail_top",_sNextMailBt:"nextmail_bt",_sNextNewMail:"nextnewmail",_sNextNewDiv:"nextnewDiv",_sQQMailBgMusicInfo:"QQMailBgMusicInfo",_sBgMusic:"bgmusic",_sMp3PlayerContainer:"mp3player_container",_sMp3PlayerInfo:"mp3player_info",_sSubMail:"submail",_sFold:"fold",_sDetail:"detail",_sSum:"sum",_sExpand:"expand",_sDetailBtn:"detailBtn",_sReferInfo:"referinfo",_sSettingGroup:"setting_group",_sRmd:"rmd",_sRemarkContent:"remarkContent",_sRemarkContainer:"remarkcontainer",_sRemarkText:"remarktext",_sRemarkWrite:"remarkwrite",_sRemarkRead:"remarkread",_sRemarkSave:"remarksave",_sSenderInfo:"senderInfo",_sSenderInfo2:"senderInfo2",_sSenderInfo3:"senderInfo3",_sMainMail:"mainmail",_sRejectGroupY:"rejectgroupy",_sRejectGroupN:"rejectgroupn",_sCheatCodeBar:"spam",_sGreenBar:"cheatcode_greenbar",_sGreenBarText:"greenbar_text"},t="convreandfw",i="spam",r="moreoprContainer",b="qmTranslate",l="\u8bf7\u5728\u6b64\u8f93\u5165\u5907\u6ce8...",o=T(['<img src="$images_path$spacer.gif" class="icon_addMusic_d"/>','&nbsp;<a href="http://cgi.music.soso.com/fcgi-bin/m.q?w=$title$%20$author$&t=0" target="_blank">$title$ - $author$</a>']),n=TE(["/cgi-bin/mail_list?sid=$sid$",'$@$if($s$=="from_unread_list")$@$',"&flag=new&folderid=$folderid$&s=unread",'$@$else if($s$=="from_star_list")$@$',"&flag=star&folderid=$folderid$&s=star","$@$endif$@$","$@$if($more$)$@$","$more$","$@$endif$@$"]),d="/cgi-bin/readmail?sid=$sid$&mailid=$mailid$",h=TE([d,"&t=","$@$if($t$)$@$","$t$","$@$else$@$","compose","$@$endif$@$","&s=$s$&disptype=$disptype$"]),a=(TE("/cgi-bin/grouplist?oper=$oper$&sid=$sid$&gid=$gid$@groupmail.qq.com&t=mail_mgr2&mailaction=$action$"),TE("/cgi-bin/grouplist?oper=reject&sid=$sid$&reject=$yn$&gid=$gid$@groupmail.qq.com&t=mail_mgr2&mailaction=reject_group"),TE("/cgi-bin/reader_list?type=home&classtype=allfriend&uin=$mail.from.qq$&t=reader_personal&sid=$sid$&s=sidebar")),c=TE(['<form method="$sMethod$" id="$sFormId$" name="$sFormId$" target="$sTarget$" action="$sAction$" enctype="multipart/form-data">',"$@$for($oInputs$)$@$",'<input name="$name$" type="hidden" value="$value$"/>',"$@$endfor$@$","</form>"]),e='"$name$"<$addr$>; ',m=TE(["$@$for($addrs$)$@$",'"$@$eval getTop().encodeNick(getTop().htmlDecode($name$))$@$"<$addr$>; ',"$@$endfor$@$"]),u=(TE(['<div id="container" style="line-height:20px">',"<div>",'<div style="margin:8px 4px 0 0;">','<a class="right" id="other" href="/cgi-bin/grouplist?sid=$sid$&t=setting_group&oper=list">\u7ba1\u7406\u5176\u4ed6\u7fa4</a>','<p style="margin:0;">\u5bf9\u6b64\u7fa4:</p>',"</div>",'<div style="margin-bottom:5px;margin-left:8px;">','<div style="padding:5px 0 3px">','<input type="radio" name="qqnotify" value="notifyyes" $@$if(!$bReject$&&$bNotify$)$@$checked="true"$@$endif$@$ id="qqnotify"/>','<label for="qqnotify" style="color:#333">\u63a5\u6536\u65b0\u90ae\u4ef6\uff0c\u5e76\u5728QQ\u63d0\u9192</label>',"</div>",'<div style="padding:5px 0 3px">','<input type="radio" name="qqnotify" value="notifyno" $@$if(!$bReject$&&!$bNotify$)$@$checked="true"$@$endif$@$ id="noqqnotify"/>','<label for="noqqnotify" style="color:#333">\u63a5\u6536\u65b0\u90ae\u4ef6\uff0c\u4e0d\u5728QQ\u63d0\u9192</label>',"</div>",'<div style="padding:5px 0 3px;">','<input type="radio" name="qqnotify" value="reject" $@$if($bReject$)$@$checked="true"$@$endif$@$ id="reject"/>','<label for="reject" style="color:#333">\u62d2\u6536\u90ae\u4ef6</label>',"</div>","</div>","</div>",'<div style="position:relative;border-top:1px solid #ccc;padding-top:8px;$@$if($bReject$)$@$display:none;$@$endif$@$;" class="clear" id="setnewdiv">','<p style="margin:0;">\u5bf9\u6b64\u7fa4\u5df2\u8bfb\u90ae\u4ef6:</p>','<div style="margin-left:8px;">','<div style="padding:5px 0 3px">','<input type="radio" name="unread" value="setnewyes" $@$if($bNewreply$)$@$checked="true"$@$endif$@$ id="setunread"/>','<label for="setunread" style="color:#333">\u6709\u65b0\u56de\u590d\u65f6\uff0c\u6807\u4e3a\u672a\u8bfb</label>',"</div>",'<div style="padding:5px 0 3px">','<input type="radio" name="unread" value="setnewno" $@$if(!$bNewreply$)$@$checked="true"$@$endif$@$ id="setread"/>','<label for="setread" style="color:#333">\u6709\u65b0\u56de\u590d\u65f6\uff0c\u4fdd\u6301\u5df2\u8bfb</label>',"</div>","</div>","</div>",'<div style="padding:10px 0;overflow:hidden;" class="clear">','<a class="bold button_green_md" style="display:inline-block;" id="save">\u4fdd\u5b58\u66f4\u6539</a>&nbsp;','<a style="margin:3px 0 0 5px;" href="javascript:;" id="cancel">\u53d6\u6d88</a>&nbsp;',"</div>","</div>"]),{_REPLY_DLG:T(["<div style='padding:25px 10px 0 35px;text-align:left;'><b>\u60a8\u662f\u5bc6\u9001\u7684\u6536\u4ef6\u4eba\uff0c\u5176\u4ed6\u6536\u4ef6\u4eba\u4e0d\u77e5\u9053\u60a8\u6536\u5230\u4e86\u6b64\u90ae\u4ef6\uff01<br>\u662f\u5426\u8981\u56de\u590d\u5168\u90e8\u6536\u4ef6\u4eba\uff1f</b></div>","<div style='padding:23px 10px 10px 10px;text-align:right;'>","<input type=button id='replyall' class='btn wd4' value='\u56de\u590d\u5168\u90e8'>","<input type=button class='btn wd4' value='\u56de\u590d\u53d1\u4ef6\u4eba' id='reply'>","<input type=button class='btn wd4' value='\u53d6\u6d88' id='cancel'>","</div>"]),_REFERPART:TE(['<div style="font:Verdana normal 14px;color:#000;padding:8px 0px;">',"<div>&nbsp;</div><div>&nbsp;</div>",'<div style="FONT-SIZE: 12px;FONT-FAMILY: Arial Narrow;padding:2px 0 2px 0;">',"------------------&nbsp;$REFER$&nbsp;------------------","</div>",'<div style="FONT-SIZE: 12px;background:#efefef;padding:8px;">','<div><b>$FROM$</b> "$from.name$"<$from.addr$>; </div>',"<div><b>$DATE$</b> $date$</div>","<div><b>$TO$</b> $@$for($to$)$@$",e,"$@$endfor$@$</div>","$@$if($cc.length$)$@$","<div><b >$CC$</b> $@$for($cc$)$@$",e,"$@$endfor$@$</div>","$@$endif$@$","<div><b>$SUBJECT$</b> $subject$</div>","</div><div>&nbsp;</div>","$orgcontent$","</div>"]),_BODY:T(['<div style="font-family:$fontName$;font-size:$fontSize$;color:$fontColor$;">',"$content$","</div>"])}),f={_ZH_CN:{REFER:"\u539f\u59cb\u90ae\u4ef6",FROM:"\u53d1\u4ef6\u4eba:",DATE:"\u53d1\u9001\u65f6\u95f4:",TO:"\u6536\u4ef6\u4eba:",CC:"\u6284\u9001:",SUBJECT:"\u4e3b\u9898:"},_EN_US:{REFER:"Original",FROM:"From:",DATE:"Date:",TO:"To:",CC:"Cc:",SUBJECT:"Subject:"}},p=T("/cgi-bin/config_blackwhitelist?sid=$sid$&act=whitelist&Fun=submit&pagefrom=readmail&group=$fromaddr$&sloc=readmail_yellow_tip"),g=T("/cgi-bin/report_cgi?r_type=$rtype$&r_result=$rresult$&r_msg=$rmsg$");function _(e,t){var i=e.sFormId||unikey(),n=S(i,e.oWin),a=[];return n&&removeSelf(n),(t=t||{}).sid=t.sid||getSid(),E(t,function(e,t){a.push({name:t,value:e})}),e.oInputs=a,insertHTML(e.oWin.document.body,"beforeEnd",c.replace(extend({sFormId:i,sTarget:"actionFrame",sMethod:"POST"},e))),S(i,e.oWin)}function v(e,t){rdVer(e,1),rdVer.check(t)||reloadFrm(t)}function y(e,t,i,n,a){var o=new Date;return["\u6b64\u90ae\u4ef6\u662f\u5b9a\u65f6\u90ae\u4ef6\uff0c",new Date(e,t,i,n,a,0)<o?"\u5df2":"\u5c06","\u5728",'<span style="color:black;">',e,"\u5e74",t,"\u6708",i,"\u65e5",n,"\u65f6",a,"\u5206","</span>","\u53d1\u51fa\u3002"].join("")}function M(e,t){return e.ctrlKey&&13==e.keyCode||e.altKey&&83==e.keyCode}var w={},x=w._qmBaseDM=inherit("_qmBaseDM",Object,function(e){return{$_constructor_:function(){var e=arguments;if(e.length){var t=this;t._moContext=e[e.length-1],t._moWin=t._moContext.oWin,t._msModuleName=t._moContext.sModuleName,t._init.apply(t,arguments)}},_initMemVar:function(){},_setEvent:function(){},_ready:function(){},_startSubMod:function(){},_init:function(){var e=this;e._initMemVar.apply(e,arguments),e._setEvent.apply(e,arguments),e._ready.apply(e,arguments)},attr:function(e,t,i){var n=attr(e,t,i);return!n&&e?i===undefined?e[t]:e[t]=i:n},S:function(e){return S(e+(this._moContext.sAux||""),this._moWin)},SN:function(e){return SN(e+(this._moContext.sAux||""),this._moWin)},context:function(e){return e=e||"sContext",this._moContext[e]},_handle:function(e,t){for(var i,n,a,o,r=this,l=getEventTarget(t),s=l.ownerDocument,d=r._msModuleName;l&&l!=s;){if((i=attr(l,e))&&(n=i,o=l),i=attr(l,x._MOD_ATTR)){if(i==d){if(a){var c=r._startSubMod(a);c&&c._handle(e,t)}n&&"function"==typeof r[n]&&r[n](o,r.context("sContext"),t);break}a="1"!=attr(l,x._MOD_STATE)?(debug([attr(l,x._CON_ATTR),r.context("sContext")]),{sModuleName:i,sContext:attr(l,x._CON_ATTR)||r.context("sContext"),sAux:attr(l,x._AUX_ATTR)}):null,n=null}l=l.parentNode}},evt:function(e,t){var n=this,i=function(i){i="string"==typeof i?n.S(i):i,attr(i,x._MOD_STATE,"1"),E(e,function(t){var e=x._oEvtMap[t];e&&addEvent(i,e,function(e){n._handle(t,e)})})};"string"==typeof t&&(t=n.S(t)),t.nodeType?i(t):E(t,function(e){i(e)})}}},{_MOD_STATE:"_module_state_",_MOD_ATTR:"module",_CON_ATTR:"context",_AUX_ATTR:"aux",_oEvtMap:{ck:"click",md:"mousedown",dck:"dblclick"}});function C(e){var t=e.method||"GET",i=e.url,n=e.success||function(){},a=e.error||function(){},o=e.data||"",r=null;try{r=new XMLHttpRequest}catch(l){try{r=new ActiveXObject("MSXML2.XMLHTTP")}catch(l){try{r=new ActiveXObject("Microsoft.XMLHTTP")}catch(l){}}}r&&(r.open(t,i,!0),"POST"===t.toUpperCase()&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(r.readyState==XMLHttpRequest.DONE)if(200==r.status){try{var e=JSON.parse(r.responseText)}catch(t){e={}}n(e)}else a()},r.send(o))}w.qmReadMail=inherit("qmReadMail",w._qmBaseDM,function(e){return{_ready:function(){var e=this;e._initWinFunc.apply(e,arguments),setTimeout(function(){e._pageReady.apply(e,arguments)},50)},_rInsPageEnd:function(){var e=this.S($._sPageEnd);this._moWin.document.body.appendChild(e),show(e,!0)},_fakeReadMail:function(){var o=this,e=o._moConfig;QMAjax.send(T("/cgi-bin/readmail?sid=$sid$&mailid=$mailid$&t=readsubmail&mode=fake&s=r2&base=$base$&pf=$pf$").replace({sid:getSid(),mailid:o.getMailId(),pf:rdVer.isPre(e.folderid)?1:0,base:rdVer("BaseVer",0)}),{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t){var i=trim(t);if(e&&0==i.indexOf("(")){var n=evalValue(i);n&&o._updatePreAndNext(n)}else{var a=getActionWin().document;a.open(),a.write(t)}}})},_flushFolder:function(){var e=this._moConfig,t=this.getMailId();1!=e.bNewMail||QMMailCache.getData(t)?getTop().recordCompareReadedMailId(t):folderOpt({bNewMail:e.bNewMail,sFolderId:e.folderid,sMailId:t,oMatchTag:e.oMatchTag,bStar:e.bStar,bBsm:e.bBsm})},_setEvent:function(){var e=this,t=e._moWin;e.evt(["ck","md"],t.document.body),addEvent(t,"resize",function(){e._adjustView()})},_initWinFunc:function(){var r=this,e=r._moWin;e.QMReadMail=r,e.go=function(e,t,i,n,a){var o={opt:i};a&&(o.more=["&loc=",r._moConfig.loc,a].join("")),r.optMail(o,r.getMailId(),e)},e.fw=function(e,t){callBack.call(r,r[e],t)},e.goback=function(){r.goback()},e.setRemindSpan=function(e){r.S("remind_edit_"+e).innerHTML=(reminddetail["mailid:"+e]||"").replace(/linktitle=.*&sid=/g,function(e){return e.replace(/\'/g,"&#039;")})},e.setMoreOperation=function(e,t){r._moMoreOptSel&&r._moMoreOptSel.switchPair(e,t)},e.fjGetFlvAttrUrl=function(){return T("/cgi-bin/readtemplate?sid=$sid$&t=video_ref.smil&vsrc=$vsrc$").replace({sid:getSid(),vsrc:encodeURIComponent(e.sFlvPlayUrl.substr(1))})}},_initMemVar:function(e,t){this._moConfig=e,this._moMailInfo=t},_updatePreAndNext:function(e){var t,i=this.S($._sNextMailTop),n=this.S($._sNextMailBt),a=this.S($._sNextNewMail);n&&i&&a&&(-1!=e.sPn.indexOf("\u4e0a\u4e00\u5c01")&&-1!=e.sPn.indexOf("\u4e0b\u4e00\u5c01")&&(i.innerHTML=n.innerHTML=e.sPn),(t=trim(e.sPnNew))&&(a.innerHTML=t),show(attr(this.S($._sNextNewDiv),"mailid",e.sPnNewMailId),""!=t))},clearCache:function(){rdVer(this.getMailId(),1)},_onMoreOptSel:function(e){var t=this.getMailId();switch(e){case"delremark":case"addremark":this._moRemark.toggle(t);break;case"delremind":case"addremind":var i=GelTags("a",S("remind_edit_"+t,document));if(i&&i[0])if("addremind"==_aoItem.sId)fireMouseEvent(i[0],"click");else{var n=location.getParams(S("remind_delete",document).href),a=document.remind_frm;a.ruleid.value=n.ruleid,a.from.value=n.from,a.submit()}break;case"print":this.optMail2({opt:"print"})}},_readMailFinish:function(e){if(bnewwin){var t=window.opener,i=this._moConfig;try{t&&t.readMailFinish&&t.readMailFinish(this.getMailId(),i.reandfw,i.folderid)}catch(n){}}},_adjustView:function(){var e=this.S($._sMailContainer),t=this._moWin.document.documentElement.clientWidth;"6"!=this._moConfig.xqqstyle&&e&&(e.style.marginRight=1e3<t?"170px":"0px")},_adjustMailContainer:function(){var e=this.S($._sMailContainer)||this.S($._sContentDiv);e&&(e.style.overflowY="scroll",10<e.scrollHeight-e.offsetHeight&&(e.style.height=e.scrollHeight+"px"),e.style.overflowY="")},_startSubMod:function(e){var t,i=this,n=i._moMailInfo,a=extend({},i._moContext,e),o=i._moConfig;switch(a.sModuleName){case"qmRemark":t=i._moRemark=new w.qmRemark(function(e){var t=i._moMoreOptSel;if(t)switch(e){case"del":t.switchPair("addremark","delremark");break;case"save":t.switchPair("delremark","addremark")}QMMailCache.setExpire(),i.clearCache()},a);break;case"qmMoreOptSel":t=i._moMoreOptSel=new w.qmMoreOptSel({oMoreOpt:o.oMoreOpt,fOnSelect:function(e){i._onMoreOptSel(e)}},a);break;case"qmQReply":t=i._moQReply=new w.qmQReply(o,n,{fCheckBcc:function(){callBack.call(i,i.checkBcc,arguments)},sSubTmp:""},a);break;case"qmAntiSpam":t=i._moAntiSpam=new w.qmAntiSpam(o,n,a);break;case"qmSenderInfo":t=new w.qmSenderInfo(o,n,a);break;case"qmPlayerParser":t=new w.qmPlayerParser({oContentDom:i.S($._sContentDiv),bManuPlay:o.bMusicManuPlay},a);break;case b:var r=getTop();"1"==r.getGlobalVarValue("DEF_TRANSLATE")&&loadJsFile(r.getPath("js")+r.getFullResSuffix("qmtranslate.js"),!0,s.document,function(){waitFor(function(){return i.S($._sContentDiv)&&s.QMTranslate},function(e){if(e){var t=i.S($._sContentDiv);new s.QMTranslate({oDom:t})}})})}return t},_pageReady:function(){var i=getTop(),n=this,e=n._moWin,t=n._moMailInfo,a=n._moConfig,o=n.S($._sContentDiv),r=S("folder_"+a.folderid,i),l=e.document.body.background;n._adjustView(),n._rInsPageEnd(),n._fakeReadMail(),a.bBccToMe=function _(e){var a;try{a=getDefalutAllMail()}catch(i){return!1}function t(e){for(var t=0;t<e.length;t++)if(e[t]){var i=e[t].addr||"";if(e[t].qq==g_admuin)return!0;for(var n=0;n<a.length;n++)if((a[n].email||"").toLowerCase()==i.toLowerCase())return!0}return!1}return!!a.length&&!(t(e.to)||t(e.cc)||t([e.from]))}(t),a.sMailContent=$._sMailContainer,n._readMailFinish(),l&&(o.style.backgroundImage="url("+l+")"),swapLink(o,a.disptype,e,n.getMailId()),initMailSelect(a.oMoveItems,!0,"1"==a.bOpenTag,e,a.folderid,a.bAutoTag),n._startSubMod({sModuleName:"qmQReply"}),n._startSubMod({sModuleName:"qmRemark"}),n._startSubMod({sModuleName:"qmAntiSpam"}),n._startSubMod({sModuleName:"qmSenderInfo"}),n._startSubMod({sModuleName:"qmPlayerParser"});var s=e.document.body;s.scrollWidth>s.clientWidth&&requestShowTip("tipRemindEdit",19,e),n._addWidth1024Class(),r&&"folder_pop_td"==r.parentNode.parentNode.id&&new QMSender({oWin:e,nCurFolderId:a.folderid,sWidth:210,sCurSaveFrom:a.saveFrom}),a.bClearRDCache&&n.clearCache(),n._sendTimeMail(),a.flowid&&ossLog("realtime","all","flowid="+a.flowid),n._flushFolder(),getTop().QMWebpushTip&&getTop().QMWebpushTip.read(1,n.getMailId()),getTop().goUserInfo.deferget("DEF_TRANSLATE",function(e){n._startSubMod({sModuleName:b})});var d=function(e){for(var t=[],i=0;i<e.attributes.length;i++)0==e.attributes[i].name.indexOf("on")&&t.push(e.attributes[i].name);for(i=0;i<t.length;i++)e.removeAttribute(t[i])};container_name="mailContentContainer";for(var c=0,m=document.getElementById("mainFrame").contentWindow.document.getElementById(container_name).getElementsByTagName("*"),u=m.length,f=0;f<u;f++)null!=m[f].getAttribute("lazybackground")?(c+=1,d(m[f])):"img"==m[f].tagName.toLowerCase()&&null!=m[f].getAttribute("lazysrc")?(c+=1,d(m[f])):"image"==m[f].tagName.toLowerCase()&&d(m[f]);if(50<c){!function h(){for(var e=[],t=0;t<u;t++)null!=m[t].getAttribute("lazybackground")?(m[t].setAttribute("lazybackground",m[t].getAttribute("lazybackground")+"?"+Math.random()),e.push(m[t])):"img"==m[t].tagName.toLowerCase()&&null!=m[t].getAttribute("lazysrc")&&(m[t].setAttribute("lazysrc",m[t].getAttribute("lazysrc")+"?"+Math.random()),e.push(m[t]));new ImagesLazyLoad({container:container_name,mode:"cross",holder:"",onLoad:function(e){},images:e,getSrc:function(e){return null!=e.getAttribute("lazybackground")?e.getAttribute("lazybackground"):"img"==e.tagName.toLowerCase()&&null!=e.getAttribute("lazysrc")?e.getAttribute("lazysrc"):void 0}})}()}else for(f=0;f<u;f++)null!=m[f].getAttribute("lazybackground")?(m[f].setAttribute("background",m[f].getAttribute("lazybackground")),m[f].removeAttribute("lazybackground")):"img"==m[f].tagName.toLowerCase()&&null!=m[f].getAttribute("lazysrc")&&(m[f].src=m[f].getAttribute("lazysrc"),m[f].removeAttribute("lazysrc"));setTimeout(function(){n._adjustMailContainer()},200),n.hasLeave=!1,getMainWin().exitConfirm=function(e){try{n.hasLeave||(i.doReadMailStatistics(n.getMailId(),"st_readtime"),n.hasLeave=!0),"function"==typeof e?e():i.globalEval(e,window)}catch(t){}},n._fixAbsoluteContent();var p=n.S("exmail-online-doc-detect-uuid");if(p){var g="/cgi-bin/readtemplate?action=get_code_for_online_doc&f=json&sid="+getSid();QMAjax.send(g,{method:"GET",timeout:1e4,onload:function(e,t){var i=evalValue(t);if(e&&i&&"0"==i.RetCode&&"0"==i.errorcode[0].DATA){var n=i.online_doc_code[0].DATA,a=p.getAttribute("href");p.setAttribute("href",a+"&qy_online_doc_code="+n)}}})}},_fixAbsoluteContent:function(e){var t=getTop(),i=$._sContentDiv;"string"==typeof e&&(i+=e);var n=this.S(i)||S(i,t.getMainWin());if(n){var a=0;t.E(n.getElementsByTagName("*"),function(e){3!=e.nodeType&&"absolute"==t.getStyle(e,"position")&&(a=Math.max(t.calcPos(e,"json").bottom,a))}),o()}function o(){if(a&&t.isShow(n)){var e=t.calcPos(n,"json");a-=e.top,debug("content height fix",a),a>e.height&&(n.style.height=a+"px")}}},_addWidth1024Class:function(){var e=getTop(),t=this;e.document.body.clientWidth<=1024&&e.addClass(t.S("mainmail"),"width1024"),e.addEvent(e,"resize",function(){e.document.body.clientWidth<=1024?e.addClass(t.S("mainmail"),"width1024"):e.rmClass(t.S("mainmail"),"width1024")})},_sendTimeMail:function(){var t=this.S($._sSendTimeMsg),i=[];t&&(E(["year","month","day","hour","min"],function(e){i.push(attr(t,e))}),t.innerHTML=callBack(y,i))},checkDecryptMail:function(){var t=this;_oConfig=t._moConfig,_oConfig.bEncrypt&&addEvent(t.S("decryptmail_pw"),"keydown",function(e){"13"==e.keyCode&&fireMouseEvent(t.S("decryptmail"),"click")})},decryptMail:function(e,t,i){var n=this,a=(n._moWin,encodeURIComponent(n.S("decryptmail_pw").value));a?QMAjax.send(T("/cgi-bin/readmail?sid=$sid$&mailid=$mailid$&action=decryptmail&t=success&secmailcode=$code$&ef=js&resp_charset=UTF8").replace({mailid:t,sid:getSid(),code:a}),{method:"GET",onload:function(e,t){if(e){var i=evalValue(t);"0"==i.errcode?(n._moConfig.bEncrypt=!1,n.afterDecrytMail()):showError(i.errmsg)}}}):(showError("\u8bf7\u8f93\u5165\u5bc6\u7801"),n.S("decryptmail_pw").focus())},afterDecrytMail:function(){var e=this,t=e._moConfig;if(showInfo("\u90ae\u4ef6\u89e3\u5bc6\u6210\u529f"),t.bNeedReceipt&&t.bNewMail){var i=e._moWin.location.href;e.clearCache(),goUrl(e._moWin,cookQueryString(i,{force_needreceipt:1,r:Math.random()}))}else v(e.getMailId(),e._moWin)},getMailInfo:function(){return this._moMailInfo},getCBInfo:function(){var e=this,t=e._moConfig,i=e._moMailInfo.from||{},n=e.S($._sImgStar);return{oWin:e._moWin,sFid:t.folderid,bML:!1,oMail:[{sMid:e.getMailId(),bSys:t.bSys,bUnr:!1,bSubUnr:!1,bStar:"qm_ico_flagon"==n.className,bTms:!1,oTagIds:t.oMatchTag,sSName:i.name,sSEmail:i.addr,oStar:n,oTCont:e.S($._sTagContainer)}]}},notify:function(e,t){var i=this._moMailInfo;switch(e){case"delsubmail":--i.nLen<=0&&this.goback(),QMMailCache.setExpire();break;case"toRefer":var n=this._moSubMails[t];n&&n.seek()}},getMailId:function(){return this.context("sContext")},modifyTag:function(e,t){var i=this._moConfig.oMatchTag;if(i){for(var n=i.length-1;0<=n&&i[n]!=e;n--);t?e<0?i.length=0:i.splice(n,1):n<0&&i.push(e)}},toAttach:function(e){var t,n=this.S($._sAttachment+(this.attr(e,"seq")||""));function i(e,t){var i=arguments.callee;t&&i.time||(i.orgclass=n.className,i.time=0),n.className=i.time%2==0?"toolbg":i.orgclass,n.style.height=(i.time,"auto"),++i.time<e&&setTimeout(function(){i(e,!0)},70)}n&&((t=this._moWin.document.documentElement).scrollHeight<=t.clientHeight?i(6):(scrollIntoMidView(n,t,!1,0,!0),i(4)))},prevandnext:function(e,t,i){var n=this.attr(e,"mailid");rdVer.log(n,"hit"),goUrl(this._moWin,["/cgi-bin/readmail?",rdVer.url(n,this._moConfig.folderid,"","",!1,"",!1,"",!0),bnewwin?"&newwin=true":""].join(""),!0),i&&preventDefault(i)},_makeMailListUrl:function(){var e=this._moConfig;return n.replace({sid:getSid(),folderid:e.folderid,s:e.subtmpl})},goback:function(){if(bnewwin)goUrlTopWin("/cgi-bin/frame_html?sid="+getSid());else if(trace("history back","","start","mail_list"),!QMHistory.tryBackTo("mail_list")){this._moWin.location.href=QMHistory.getUrl("mail_list")||this._makeMailListUrl()}},tag:function(e,t,i){QMTag.readclose(i,this.getCBInfo())},starMail:function(e){var i=this;starMail(null,extend(i.getCBInfo(),{oncomplete:function(e,t){return i.clearCache(),show(i.S($._sStarStatus),t),!0}}),"mailinfo")},previewAttach:function(e,t,i){var n=T(d).replace({sid:getSid(),mailid:t}),a=T("$url$&nocheckframe=true&t=attachments&select=$select$").replace({url:n,select:this.attr(e,"select")});-1!=window.location.hostname.indexOf("exmail.qq.com")&&(a=getTop().getTopHost()+a),getTop().gbIsIE?window.open("/cgi-bin/readtemplate?t=previewAttachRedirect&previewurl="+encodeURIComponent(a),"_blank"):window.open(a,"_blank"),preventDefault(i)},previewAttachNative:function(e,t,i){var n=e.getAttribute("data-name"),a=(t=e.getAttribute("data-mailid"),"/qy_mng_logic/attach/preview?filename="+encodeURIComponent(n)+"&mailid="+t+"&sid="+getSid());if(!getTop().gbIsIE||10<=getTop().gnIEVer)window.open(a,"_blank");else{var o=T(d).replace({sid:getSid(),mailid:t}),r=T("$url$&nocheckframe=true&t=attachments&select=$select$").replace({url:o,select:this.attr(e,"select")});-1!=window.location.hostname.indexOf("exmail.qq.com")&&(r=getTop().getTopHost()+r),getTop().gbIsIE?window.open("/cgi-bin/readtemplate?t=previewAttachRedirect&previewurl="+encodeURIComponent(r),"_blank"):window.open(r,"_blank"),preventDefault(i)}},archive_previewAtt:function(e,t,i){var n=T("/cgi-bin/archive_readmail?sid=$sid$&mailid=$mailid$").replace({sid:getSid(),mailid:t}),a=T("$url$&nocheckframe=true&t=attachments&select=$select$&folderid=$fid$").replace({url:n,select:this.attr(e,"select"),fid:this._moConfig.folderid});window.open(a,"_blank"),preventDefault(i)},playAttach:function(e){var t=GelTags("span",e.parentNode.parentNode),i=0==t.length?{}:t[0],n=this.S($._sMp3PlayerContainer);return!!i.getAttribute("player")&&(show(n,!0),audioPlay({container:n,url:i.getAttribute("player"),title:i.innerHTML,autoplay:!0,global:!0}),!0)},checkBcc:function(e,i,t){var n=this;if(n._moConfig.bBccToMe)return new QMDialog({sId:"reply_dlg",sTitle:"\u56de\u590d\u63d0\u793a:",sBodyHtml:u._REPLY_DLG.toString(),nWidth:405,nHeight:160,onshow:function(){this.S("replyall").focus()},onload:function(){var t=this;addEvent(t.S("replyall"),"click",function(){n._moConfig.bBccToMe=!1,"TEXTAREA"==e.tagName?n._moQReply.focus():n.optMail({opt:"reply_all"},i),t.close()}),addEvent(t.S("reply"),"click",function(e){n.optMail({opt:"reply"},i),t.close()}),addEvent(t.S("cancel"),"click",function(){t.close()})}}),preventDefault(t),!0},setAutoDel:function(e,t){var i=this._moWin;"6"==this._moConfig.xqqstyle&&_({oWin:i,sAction:"/cgi-bin/mail_mgr"},{mailid:t,mailaction:"autodel",reporttype:_attr(e,"flag"),s:"autodel"}).submit()},mailRecall:function(e,a){var o=attr(e,"loccnt"),r=attr(e,"mid"),l=attr(e,"mdata"),s=attr(e,"odd"),d=0;getTop().QMAjax.send(T("/cgi-bin/send_status?sid=$sid$&t=biz_rf_mgr&ef=jsnew&action=checksender&mailid=$mailid$&r=$r$").replace({sid:getSid(),mailid:a,r:Math.random()}),{method:"GET",onload:function(e,t){if(e){var i,n=evalValue(t);if(n.data&&0==n.data.check_res)if(0<o&&"0"!=s)d=1,new QMDialog({sId:"mailrecall",sTitle:"\u64a4\u56de\u90ae\u4ef6",sUrl:T("/cgi-bin/readtemplate?sid=$sid$&t=mailrecall_confirm&mailid=$mailid$&localcount=$loccnt$&messageid=$mid$&date=$mdate$&odd=$odd$").replace({sid:getSid(),mailid:a,loccnt:o,mid:r,mdate:l,odd:s}),nWidth:485,nHeight:256});else i="0"==s?(d=2,"\u6b64\u90ae\u4ef6\u8ddd\u53d1\u9001\u65f6\u5df2\u8d85\u8fc724\u5c0f\u65f6\uff0c\u65e0\u6cd5\u64a4\u56de\u3002"):(d=3,"\u6b64\u90ae\u4ef6\u53d1\u5f80\u975e\u817e\u8baf\u4f01\u4e1a\u90ae\u548c\u975eQQ\u90ae\u7bb1\uff0c\u4e0d\u652f\u6301\u64a4\u56de\u64cd\u4f5c\uff0c\u8bf7\u8c05\u89e3\u3002<br/>\u4ec5\u652f\u6301\u64a4\u56de\u53d1\u5f80\u817e\u8baf\u4f01\u4e1a\u90ae\u548cQQ\u90ae\u7bb1\u7684\u90ae\u4ef6\u3002"),msgBox(T(['<b class="b_size">\u6b64\u90ae\u4ef6\u4e0d\u652f\u6301\u64a4\u56de</b>','<div style="overflow:hidden;margin-top:5px;">',"$m$","</div>"]).replace({m:i}),"dialog");else msgBox("\u64a4\u56de\u5931\u8d25\uff0c\u6b64\u90ae\u4ef6\u53d1\u4ef6\u4eba\u4e0d\u662f\u5f53\u524d\u8d26\u53f7\uff0c\u65e0\u6cd5\u64a4\u56de","dialog")}}}),ossLog("realtime","all",T(["stat=custom&type=MAILRECALL_STAT&info=","$actionid$,$mailid$,$messageid$,$attachlist$"]).replace({actionid:d,mailid:encodeURIComponent(a),messageid:encodeURIComponent(r)}))},xfDl:function(){var i=this._moMailInfo.oXfLinkArray;if(!(i.length<1)){var e=new(getTop().clsXfBatchDownload);e.init()&&(e.makeGetUrlArray=function(){var e=[];for(var t in i)e.push(i[t].replace("t=exs_ftn_download","t=exs_ftn_getfiledownload&s=email").replace(/^http:\/\/mail.qq.com/,""));return e},e.DoXfBatchDownload())}},addToAddrBook:function(e,t,i){var n=e.getAttribute("email"),a=e.getAttribute("name"),o=getTop().T("/cgi-bin/laddr_detail?sid=$sid$&view=normal&t=contact_detail&edit=1&dlgname=newAddr&name=$name$&from=$from$&inbox=true&mailid=$mailid$&resp_charset=UTF8").replace({from:n,name:a,mailid:t,sid:getTop().getSid()});new(getTop().QMDialog)({sId:"newAddr",sTitle:"\u65b0\u5efa\u8054\u7cfb\u4eba",sUrl:o,nHeight:500,nWidth:600,onload:function(){this.S("_dlgiframe_").scrolling="yes"}})},optMail2:function(e,t,i){var n=this._moWin,a="_blank",o=this.attr(e,"opt"),r=T(d).replace({sid:getSid(),mailid:t});switch(o){case"remind":r=T("/cgi-bin/readtemplate?t=calendar&sid=$sid$&cmd=moncal,,new,$subject$,mail,$mailid$").replace({sid:getSid(),mailid:t,subject:encodeURIComponent(this._moMailInfo.subject||"(\u65e0\u4e3b\u9898)")}),a="mainFrame",rdVer(t,1);break;case"print":r+=T("&t=readmail_print&s=$s$&filterflag=true").replace({s:this.attr(e,"s")||"print"}),-1!=window.location.hostname.indexOf("exmail.qq.com")&&(r=getTop().getTopHost()+r);break;case"mime":r+="&action=readmailmime";break;case"dleml":r+="&action=downloademl",a="actionFrame";break;case"code":r+="&action=readmailcode",-1!=window.location.hostname.indexOf("exmail.qq.com")&&(r=getTop().getTopHost()+r);break;case"fwgroup":r+="&t=compose_group&s=forward",a="mainFrame";break;case"note":r+="&notefmt=1&t=note_edit_show",a="mainFrame";break;case"fweml":r+="&t=compose&s=forward&action=readmaileml",a="mainFrame";break;case"addc":r+="&filterflag=false&t=addr_detail_edit&s=addfrommail",a="mainFrame"}n.open(r,a),preventDefault(i)},newWinRead:function(e,t,i){goNewWin(this._moWin.location,!1),preventDefault(i)},createRule:function(e,t,i){showSimpleRuleFilter(this.attr(e,"fromaddr"),"readmail"),preventDefault(i)},showMoreSummary:function(e){var t=this._moWin,i=getTop().isShow(getTop().S("sub_summary_info",t));getTop().show(getTop().S("sub_summary_info",t),!i),i?(getTop().rmClass(getTop().S("display_more_operator",t),"qm_ico_quickup"),getTop().addClass(getTop().S("display_more_operator",t),"qm_ico_quickdown")):(getTop().rmClass(getTop().S("display_more_operator",t),"qm_ico_quickdown"),getTop().addClass(getTop().S("display_more_operator",t),"qm_ico_quickup"))},delMail:function(e){var n=this,a=n._moWin;if(rmMail(n.attr(e,"opt")||0,extend(n.getCBInfo(),{oncomplete:function(e,t){var i=t.url||"";if(-1!=i.indexOf("/cgi-bin/readmail?"))return n.prevandnext({mailid:a.location.getParams(i).mailid}),!0}}),n._moMailInfo)&&QMHistory.recordActionFrameChange(),!n.attr(e,"opt")&&"1"==n._moConfig.folderid){var t=n._moMailInfo;readmailCheckGrpSendSkipSelf(t)}},optMail:function(n,e,a){var o=this,r=o._moWin,t=o._moConfig,i=o.attr(n,"opt"),l=(t.folderid,h.replace({sid:getSid(),t:o.attr(n,"t"),s:i,mailid:e,disptype:"text"==t.disptype?"":"html"}));function s(e){var t=[o.attr(n,"more")||""];if("draft"==e&&t.push("&backurl="+encodeURIComponent(r.location.href)),bnewwin&&t.push("&newwin=true&fwreplynewwin=true"),a&&a.shiftKey)window.open(l+t.join(""));else{var i=l+t.join("");goUrl(r,i,!0)}preventDefault(a)}switch((getTop()||window).currentReadMailID&&!o.hasLeave&&(l=l+"&currentReadMailID="+(getTop()||window).currentReadMailID+"&currentReadMailSendTime="+(getTop()||window).currentReadMailSendTime+"&st_replytime="+(+new Date-getTop().currentReadMailStartTime),o.hasLeave=!0),i){case"reply_all":case"reply":case"forward":if("forward"==i){var d,c,m=[],u=[];"qmSubMail"==o._msModuleName?((m=(_oTop.attr(n,"hasExpired")||"").split("|")).pop(),(u=(_oTop.attr(n,"hasDeleted")||"").split("|")).pop()):(m=[].concat(t.hadExpiredAttachs&&t.hadExpiredAttachs.hasExpired||[]),u=[].concat(t.hadExpiredAttachs&&t.hadExpiredAttachs.hasDeleted||[]));var f=m.length,p=u.length;if(0<f&&0<p?(d=m[0],c="\u7b49"+(f+p)+"\u4e2a\u6587\u4ef6\u5df2\u8fc7\u671f\u6216\u5df2\u88ab\u53d1\u9001\u8005\u5220\u9664"):0<f?(d=m[0],c=1==f?"\u5df2\u8fc7\u671f":"\u7b49"+f+"\u4e2a\u6587\u4ef6\u5df2\u8fc7\u671f"):0<p&&(d=u[0],c=1==p?"\u5df2\u88ab\u53d1\u9001\u8005\u5220\u9664":"\u7b49"+p+"\u4e2a\u6587\u4ef6\u5df2\u88ab\u53d1\u9001\u8005\u5220\u9664"),d){var g=d.lastIndexOf(".")||d.length,_='<span id="span_filename_desc" style="text-overflow: ellipsis;overflow: hidden;max-width:175px;display: inline-block;vertical-align: middle;white-space: nowrap;">'+d.substring(0,g)+"</span>"+d.substring(g);_oTop.confirmBox({title:"\u63d0\u793a",nWidth:440,msg:['<div class="dialog_f_t" style="font-weight: normal;word-break: break-all;">\u8d85\u5927\u9644\u4ef6 "',_,'" ',c,"\uff0c\u8f6c\u53d1\u5c06\u81ea\u52a8\u5220\u9664\u3002</div>"].join(""),confirmBtnTxt:"\u7ee7\u7eed\u8f6c\u53d1",onreturn:function(e){e&&s(i)},onshow:function(){var e=this.S("span_filename_desc");e&&(_nWidth=_oTop.calcPos(e)[4],175<_nWidth&&(e.style.width="175px"))}});break}}case"draft":s(i)}},setStatus:function(e){this._mnStatus=e},addCalEvent:function(e,t,i){var n=getTop(),a=this._moWin,o=n.S("showcalpanel",a),r=e.innerHTML,l=T(['<span id="showcalpanel" class="showcalpanel" onmouseover="getTop().attr(this.parentNode, \'isout\', 0);QMReadMail.setStatus(1)" onmouseout="QMReadMail.setStatus(0);QMReadMail.hideCalEvent()">','<a onclick="QMReadMail.goCal(\'$date$\', \'$mailId$\')" class="add2calendar"><span class="ico_add2cal"></span>\u6dfb\u52a0\u5230\u65e5\u5386</a>',"</span>"]),s=n.attr(e,"times")||"";(s&&(r+=" "+n.trim(s)),r.match(/((?!0000)[0-9]{4}\u5E74)?((0?[1-9]|1[0-2])\u6708(0?[1-9]|1[0-9]|2[0-8])\u65E5|(0?[13-9]|1[0-2])\u6708(29|30)\u65E5|(0?[13578]|1[02])\u670831\u65E5)/g)&&(r=r.replace(/\u5E74/,"-").replace(/\u6708/,"-").replace(/\u65E5/,"")),(r=r.replace(/\//g,"-")).indexOf("-")<4)&&(r=(new Date).getFullYear()+"-"+r);o&&n.removeSelf(o),/^[\d\-\:\s]+$/.test(r)&&!isNaN(new Date(r.replace(/-/g,"/")).getTime())&&(e.style.cssText="border-bottom:1px dashed #ccc;position:relative;_display:inline-block;",n.insertHTML(e,"beforeEnd",l.replace({date:r,images_path:n.getPath("images"),mailId:i})))},hideCalEvent:function(e,t){var i=this,n=getTop(),a=i._moWin,o=n.S("showcalpanel",a);setTimeout(function(){o&&n.isShow(o)&&1!=i._mnStatus&&n.removeSelf(o)},100)},goCal:function(e,t,i){var n=this,a=t||n.getMailId(),o="mail",r=getTop(),l=i||n._moMailInfo.subject||r.tmpSubject;"qmGroupMail"==n._msModuleName?o="group":"qmNote"==n._msModuleName&&(o="note");var s=T("/cgi-bin/readtemplate?t=calendar&sid=$sid$&from=readmail&cmd=moncal,$date$,new,$subject$,$from$,$mailId$,&loc=readmail,calendar,,,0,1").replace({sid:r.getSid(),date:e,subject:encodeURIComponent(l||"(\u65e0\u4e3b\u9898)"),mailId:a,from:o});goUrl(n._moWin,s,!0)}}}),w.qmQReply=inherit("qmQReply",w._qmBaseDM,function(e){return{_initMemVar:function(e,t,i){var n=this;n._moConfig=e,n._moReplyMail=t,n._moSendConfig=i,n._moSource=n.S($._sQSource),n._mbStopFold},getSource:function(){var e=this._moSource;return-1!=e.className.indexOf("graytext")?"":textToHtml(htmlEncode(e.value))},_combineContent:function(e){var t=this._moConfig,i=this.S(t.sMailContent),n=this._moReplyMail,a=[e||textToHtml(htmlEncode(this.S($._sQSource).value))];try{var o=getSignature(t.folderid,t.saveFrom);o&&a.push("<div>&nbsp;</div>"+o)}catch(l){}if(t.noIncludeArtcle)return{content:a.join("")};n.orgcontent=i?filteSignatureTag(function s(e){return filteScript(e.replace(/<div id=\'?\"?QQMailBgMusicInfo\'?\"?.*?>.*?<\/div>/gi,"").replace(/<player .*?><\/player>/gi,"").replace(/(^\s+)|(\s+$)/gi,""))}(i.innerHTML)):"";var r=u._REFERPART.replace(extend({},n,"1"==t.titlePrefix?f._EN_US:f._ZH_CN));return n.orgcontent?(a.push(r),{content:u._BODY.replace({content:a.join(""),fontName:getGlobalVarValue("DEF_FONT_FAMILY")||"Verdana",fontSize:getGlobalVarValue("DEF_FONT_SIZE")||"14px",fontColor:getGlobalVarValue("DEF_FONT_COLOR")||"#000"})}):{citeprev:"yes",rmref:r,content:a.join("")}},_getValidHtmlContent:function(e){return e&&trim(e.replace(/<[^(img)]([^>]+)?>/gi,"").replace("&nbsp;",""))},send:function(e,t){var o=this,r=o._moWin,i=(o._moConfig,o._moEditor),l=o._moSendConfig,n=o.S($._sQSource);if(!e.disabled)if(o.stopFold(!0),i&&o._getValidHtmlContent(i.getContent(!1))){var a;try{a=getTop().S("subject",getTop().getMainWin()).innerHTML}catch(c){}var s=o._moReplyMail,d=extend({ReAndFw:"reply",contenttype:"html",from_s:"comm_quick",t:"compose.json",s:l.s||"",ReAndFwMailid:t,to:m.replace({addrs:s.replyTo}),cc:m.replace({addrs:s.replyCc}),subject:("1"==o._moConfig.titlePrefix?"Re:":"\u56de\u590d\uff1a")+(a||s.reSubject),savesendbox:1,sendname:"",sendmailname:o._moConfig.sendmailname,LastMsgId:o._moConfig.sLastMsgId,References:o._moConfig.sReferences},o._combineContent(i.getContent(!1)));waitFor(function(){return!!getTop().ComposeLib},function(e){if(e){var t,a="1"==getTop().gbBackGroundSend&&(t=getTop().BackGroundSend),i={onready:function(){if(a){var e=S($._sQSource,r);e.value="",e.blur(),o.stopFold(!1),e.view("sending")}else o._disableSendBtn(!0),show($._sAfterSendingDiv,!0,r)},oncomplete:function(e,t){if(a){if(e){var i=S($._sQSource,r),n=evalValue(t);n&&"ok"==n.compose?i.view("init"):l.fQReplyComplete&&callBack(l.fQReplyComplete,[t])}}else{i=S($._sQSource,r);e?(i.value="",i.blur(),i.view("init"),showInfo("\u60a8\u7684\u90ae\u4ef6\u5df2\u6210\u529f\u53d1\u9001"),show($._sAfterSendDiv,!0,r),show($._sQuickReplyPart,!1,r),callBack(l.fQReplyComplete,[t])):(i.focus(),show($._sQuickReplyPart,!0,r)),o._disableSendBtn(!1)}show(o.S($._sAfterSendingDiv),!1)}};a?t.quickReply(d,"comm",i):ComposeLib.send(d,i)}else debug("\u52a0\u8f7dComposeLib\u5931\u8d25")},100)}else showError("\u8bf7\u5148\u8f93\u5165\u56de\u590d\u5185\u5bb9"),n.focus()},readyToWrite:function(e,t){show(this.S($._sQuickReplyPart),!0),show(this.S($._sAfterSendDiv),!1),this.S($._sQSource).focus()},checkBcc:function(){callBack(this._moSendConfig.fCheckBcc,arguments)},jump:function(e,t,i){if(!e.disabled){var n=this._moEditor,a=n?n.getContent(!1):this.getSource(),o=this._moWin,r=h.replace({sid:getSid(),mailid:t,s:"reply_all",disptype:"html"});setClass(this._moSource,"graytext qm_txt"),_({oWin:o,sTarget:"_self",sAction:r+(getTop().bnewwin?"&newwin=true":"")},{pluscontent:getTop().htmlEncode(a)}).submit(),preventDefault(i)}},_disableSendBtn:function(e){return this.S($._sJumpToNewWin).disabled=this.S($._sQSendBtn).disabled=e,this},_setEvent:function(){var o=this,r=o._moWin,t=o._moSource,i=o.S($._sQSendBtn),n=o.S($._sChangeWriteMode),a=(o.S($._sQReplyTxtContainer),o.S($._sQReplyBtnContainer));t.view=function l(e){switch(e){case"init":o._moEditor&&o._moEditor.setContent("");case"sending":setClass(t,"graytext qm_txt").value=t.getAttribute("graytxt"),t.style.height="20px",show("rteContainer",!1,r),show("qmQuickReplyTextContainer",!0,r),show(a,!1,r);break;case"show":show("rteContainer",!0,r),show("qmQuickReplyTextContainer",!1,r),show(a,!0,r),o._moEditor&&o._moEditor.focus&&o._moEditor.focus()}show($._sAfterSendDiv,"init"==e,r),show($._sAfterSendingDiv,"sending"==e,r)},addEvents(setClass(t,"graytext qm_txt"),{keydown:function(e){M(e)&&fireMouseEvent(i,"click")},focus:function e(){-1!=t.className.indexOf("graytext")&&(t.setAttribute("graytxt",t.value),setClass(t,"qm_txt b_size").value="",qmAnimation.expand(t,{to:54,oncomplete:function(){var e=this;show(a,!0),show(n,!0),t.style.overflow="auto",bodyScroll(r,"scrollTop",bodyScroll(r,"scrollTop")+30),o._moEditor?e.view("show"):QMEditor.createEditor({editorId:"newReadMailQuickSend",editorAreaWin:r,isOpenEditBar:!0,funclist:QMEditor.CONST.FUNCLIST.READMAIL,photoCGI:getPhotoCGI(),onshowinstallactive:getTop().showInstallActiveXDialog&&getTop().showInstallActiveXDialog,onkeydown:function(e){M(e)&&fireMouseEvent(i,"click")},onload:function(){o._moEditor=this,S("tooBarContain",r).innerHTML=getTop().outputToolBarControlBtn&&getTop().outputToolBarControlBtn()||"",show(S("editor_toolbar_btn_container",r),!0),function a(e){e=null==e||e,o._moEditor.showToolBar(e);var t=getTop().S("editor_toolbar_btn_container",r);if(!t)return!1;var i=getTop().GelTags("span",t);getTop().show(i[0],e),getTop().show(i[1],!e);var n=arguments.callee;t.onclick=function(){return n(!e),!1}}(!1),setTimeout(function(){e.view("show")})}}).initialize(QMEditor.getBreakLine(),!1,3)}}),getTop().ComposeLib||(loadJsFileToTop(getPath("js"),[getFullResSuffix("libcompose.js")]),"1"==getTop().gbBackGroundSend&&loadJsFileToTop(getPath("js"),[getFullResSuffix("backsend.js")])))}}),o.evt(["ck","md"],$._sQReply),addEvent(r,"beforeunload",function(e){removeEvent(r,"beforeunload",arguments.callee);try{o._beforeCancelSend(e)}catch(t){}})},focus:function(){this._moSource.focus()},stopFold:function(e){this._mbStopFold=e==undefined||e},_cancelSend:function(){},_beforeCancelSend:function(e){var t=this._moSource,i=this._moEditor;-1==t.className.indexOf("graytext")&&(i&&this._getValidHtmlContent(i.getContent(!1))||t.value)&&!this.S($._sQSendBtn).disabled&&(e.returnValue="\u60a8\u586b\u5199\u7684\u5185\u5bb9\u6ca1\u6709\u53d1\u9001\uff0c\u786e\u5b9a\u8981\u79bb\u5f00\u5417\uff1f")}}}),w.qmPlayerParser=inherit("qmPlayerParser",w._qmBaseDM,function(e){return{_get:function(e,t){return decodeURIComponent(attr(e,t))},_fPlay:function(n){var a=this;if(n.auto||confirm("\u64ad\u653e\u5916\u90e8\u97f3\u4e50\u6709\u98ce\u9669\uff0c\u786e\u5b9a\u64ad\u653e\uff1f")){var e=a.S($._sMp3PlayerContainer),t=a.S($._sMp3PlayerInfo);n.sosoGet?getMusicUrl(n.title,n.author,function(e,t,i){a._fPlay({auto:!0,url:i||n.url,title:e,author:t,sosoGet:!1})}):(show(e,!0),audioPlay({container:e,url:n.url,author:n.author,title:n.title,autoplay:!0,global:!0}),t.innerHTML=o.replace({images_path:getPath("image"),author:htmlEncode(n.author)||"\u672a\u77e5",title:htmlEncode(n.title)||"\u672a\u77e5"}),show(t,!0))}},_fPlayBgMusic:function(e,t,i,n){var a=this,o=(a._moWin,a.S($._sBgMusic)),r={auto:i,url:e,sosoGet:!!t,author:t&&t.author,title:t&&t.title};if("bgmusic"==n){show(o,!0);var l=GelTags("a",o);l[0].href=e,l[1].onclick=function(){return a._fPlay(r),!1}}i&&a._fPlay(r),show(a.S($._sQQMailBgMusicInfo),!1)},_ready:function(e){var t=GelTags("player",e.oContentDom);if(t.length)for(var i=this,n=i._moWin,a=i.S($._sAttachment),o=!1,r=0;r<t.length;r++){var l=t[r],s=l.id||"",d=s.toLowerCase();if(0==d.indexOf("cmd:"))switch(d=d.split(":").pop()){case"voice":if(!a)return;for(var c=escape(attr(l,"param")),m=attr(l,"media")||"voice",u=GelTags("span",a),f=u.length,p="",g=0;g<f;g++){var _=u[g];if((p=attr(_,"player"))&&(_.innerText||_.textContent)==c){var h=l.parentNode;if("video"==m)n.sFlvPlayUrl||(n.sFlvPlayUrl=p,h.innerHTML=generateFlashCode(unikey("flvplayer"),"/zh_CN/htmledition/swf/WebFlvPlayer.swf",{width:400,height:335},{wmode:"opaque"}));else{h.innerHTML='<div style="padding-left:10px;" ></div>';var b={id:c,container:h.firstChild,url:p,title:(l.getAttribute("alias")||"\u60a8\u670b\u53cb")+"\u7684\u8bed\u97f3",dispInfo:{title:(l.getAttribute("alias")||"\u60a8\u670b\u53cb")+"\u7684\u8bed\u97f3"},global:!0,autoplay:!o};o=!0,r--,audioPlay(b);var v=GelTags("a",_.parentNode.parentNode);v[0].onclick=v[v.length-1].onclick=function(){audioStop(),audioPlay(b)}}break}}break;case"bgmusic":var y=attr(l,"url"),M=i._get(l,"song"),w=i._get(l,"singer");i._fPlayBgMusic(y,!y||M||w?{author:w,title:M}:null,!e.bManuPlay,d);break;case"pcbgmusic":y=attr(l,"url"),M=i._get(l,"song"),w=i._get(l,"singer");var S=n.document.createElement("div");S.innerHTML="\u64ad\u653e\u5668\u52a0\u8f7d\u4e2d...",l.parentNode.insertBefore(S,l),audioPlay({skin:"Postcard",container:S,author:w,title:M,autoplay:1==t.length,url:y}),addEvent(n,"unload",function(){audioStop()})}else s&&i._fPlayBgMusic(s)}}}}),w.qmMoreOptSel=inherit("qmMoreOptSel",w._qmBaseDM,function(e){return{_ready:function(t){for(var n=this._moData={},e=t.oMoreOpt,i=["\u5220\u9664\u90ae\u4ef6\u5907\u6ce8","\u6dfb\u52a0\u90ae\u4ef6\u5907\u6ce8","\u53d6\u6d88\u63d0\u9192","\u8bbe\u7f6e\u63d0\u9192","\u6253\u5370"],a=["delremark","addremark","delremind","addremind","print"],o=a.length-1;0<=o;o--)n[a[o]]=0;for(o=e.length-1;0<=o;o--)n[e[o]]=1;E(SN(r,t.oWin),function(e){new QMSelect({oContainer:e,nWidth:86,sDefaultItemValue:"\u66f4\u591a\u64cd\u4f5c...",oMenu:{nWidth:"auto",nMaxWidth:180,nMaxItemView:10,oItems:QMMenu.makeMenuItem(i,a)},onafteropenmenu:function(e,t){for(var i=a.length-1;0<=i;i--)e.itemOption(a[i],"bDisplay",n[a[i]])},onselect:function(e){callBack(t.fOnSelect,[e.sId])}})})},switchPair:function(e,t){this._moData[e]=1,this._moData[e]=0}}}),w.qmRemark=inherit("qmRemark",w._qmBaseDM,function(e){return{_initMemVar:function(e){this._mfOnChange=e},_setEvent:function(){var i=this,e=i._moWin;return i.evt(["ck"],[$._sRemarkContainer,$._sRmd]),addEvents(i.S($._sRemarkText),{focus:function(){i.onFocus()},keydown:function(e){i.onKeydown(e)},blur:function(){i.onBlur()}}),addEvent(e,"beforeunload",function(e){var t=i._hasModify();t&&(e.returnValue=t)}),i},getMailId:function(){return this._moContext.sContext},toggle:function(e){var t=this,i=t.S($._sRmd),n=t.S($._sRemarkContainer),a=t.S($._sRemarkText),o=t.S($._sRemarkWrite);return 0<=i.title.indexOf("\u5220\u9664")?t.del():(e.blur(),show(n,!0),show(o,!0),a.focus()),!1},del:function(e){var t=this,i=t.S($._sRmd),n=t.S($._sRemarkContent),a=t.S($._sRemarkContainer),o=t.S($._sRemarkText),r=t.S($._sRemarkWrite),l=t.S($._sRemarkRead);if(!n.innerHTML)return show(a,!1),!1;var s=t.getMailId(),d=new QMAjax("/cgi-bin/mail_mgr?mailaction=remarks&type=del");return d.onError=function(e){showError("\u5220\u9664\u5907\u6ce8\u5185\u5bb9\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),t._changeButtonMode(!1)},d.onComplete=function(e){if(-1==e.responseText.indexOf("del successful"))return this.onError();showInfo("\u5220\u9664\u6210\u529f"),i&&(i.title="\u6dfb\u52a0\u90ae\u4ef6\u5907\u6ce8",i.className="qm_ico_remarkoff"),o.value="",n.innerHTML="",show(a,0),show(r,0),show(l,0),t._changeButtonMode(!1),callBack(t._mfOnChange,["del"])},confirmBox({msg:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u6b64\u90ae\u4ef6\u5907\u6ce8\u5417\uff1f<br/>&nbsp;",title:"QQ\u90ae\u7bb1\u63d0\u793a",cancelBtnTxt:"\u53d6\u6d88",confirmBtnTxt:"\u786e\u5b9a",onreturn:function(e){e&&(t._changeButtonMode(!0),d.send(T("mailaction=remarks&sid=$sid$&type=del&mailid=$mailid$").replace({sid:getSid(),mailid:s})))}}),!1},_text2html:function(e){return htmlEncode(e).replace(/\n/gi,"<br/>").replace(/\x20/gi,"&nbsp;")},_html2text:function(e){return htmlDecode(e.replace(/&nbsp;/gi," ").replace(/<br\/?>/gi,"\n"))},save:function(){var i=this,n=(i._moWin,i.S($._sRemarkContent)),e=i.S($._sRemarkText),t=(i.S($._sRemarkWrite),i.S($._sRemarkRead),new QMAjax("/cgi-bin/mail_mgr?mailaction=remarks&type=mdy")),a=e.value;return a&&a!=l?1e3<=a.replace(/[^\x00-\xff]/g,"aa").length?(e.focus(),!!showError("\u90ae\u4ef6\u5907\u6ce8\u7684\u5b57\u7b26\u4e0d\u80fd\u8d85\u8fc71000\u4e2a")):(t.onError=function(e){showError("\u4fdd\u5b58\u5907\u6ce8\u5185\u5bb9\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),i._changeButtonMode(!1)},t.onComplete=function(e){if(-1==e.responseText.indexOf("mdy successful"))return this.onError();showInfo("\u4fdd\u5b58\u6210\u529f");var t=i.S($._sRmd);t&&(t.title="\u5220\u9664\u90ae\u4ef6\u5907\u6ce8",t.className="qm_ico_remarkon"),n.innerHTML=i._text2html(a),i._changeButtonMode(!1),i.cancel(),callBack(i._mfOnChange,["save"])},n.innerHTML==a?t.onComplete({responseText:"mdy successful"}):(i._changeButtonMode(!0),t.send(T("mailaction=remarks&sid=$sid$&resp_charset=UTF8&type=mdy&mailid=$mailid$&content=$content$").replace({sid:getSid(),mailid:i.context("sContext"),content:encodeURI(a)})),!1)):(e.focus(),!!showError("\u8bf7\u5148\u8f93\u5165\u5907\u6ce8\u5185\u5bb9"))},cancel:function(){var e=this,t=e.S($._sRemarkContent),i=e.S($._sRemarkContainer),n=e.S($._sRemarkText),a=e.S($._sRemarkWrite),o=e.S($._sRemarkRead);""==t.innerHTML?(n.value=e._html2text(l),show(o,!1),show(a,!1),show(i,!1)):(n.value=e._html2text(t.innerHTML),show(o,!0),show(a,!1))},modify:function(e){var t=this,i=t.S($._sRemarkContent),n=(t.S($._sRemarkContainer),t.S($._sRemarkText)),a=t.S($._sRemarkWrite),o=t.S($._sRemarkRead);n.value=t._html2text(i.innerHTML),show(o,!1),show(a,!0),n.focus()},onFocus:function(){this._moWin;var e=this.S($._sRemarkText);return e.value==l&&(e.value=""),e.style.color="#000",!(e.style.fontSize="14px")},onBlur:function(){var e=this.S($._sRemarkText);return""==e.value&&(e.value=l,e.style.color="#A0A0A0",e.style.fontSize="12px"),!1},onKeydown:function(e){(e.ctrlKey&&13==e.keyCode||e.altKey&&83==e.keyCode)&&(this.save(),preventDefault(e))},_changeButtonMode:function(e){this.S($._sRemarkSave).disabled=e},_hasModify:function(){var e=this.S($._sRemarkContent),t=this.S($._sRemarkText);return _bEqual=t&&t.value.replace(/\r/gi,"")!=this._html2text(e.innerHTML).replace(/\r/gi,""),t&&t.value&&_bEqual&&t.value!=l?"\u60a8\u586b\u5199\u7684\u5907\u6ce8\u6ca1\u6709\u4fdd\u5b58\uff0c\u786e\u5b9a\u8981\u79bb\u5f00\u5417\uff1f":""}}}),w.qmAntiSpam=inherit("qmAntiSpam",w._qmBaseDM,function(e){return{_initMemVar:function(e,t){this._moMailInfo=t,this._moConfig=e,this._moCheatCodeBar=this.S($._sCheatCodeBar)},_setEvent:function(){this._moWin;this.evt(["ck"],this.SN(i))},_locMore:function(e){var t=this._moWin.location;t.replace(appendToUrl(cookQueryString(t.href,{ver:""}),e))},_createMailFrm:function(e,t){_({oWin:this._moWin,sFormId:"mail_frm",sAction:"/cgi-bin/mail_mgr"},extend({s:"readmail_spam",s_reject_what:"11",isspam:"true",mailid:e,reporttype:"",location:"readmail",srcfolderid:this._moConfig.folderid,mailaction:"mail_spam"},t))},reject:function(e,t){this._createMailFrm(t),this._moWin.QMReadMail.clearCache(),doReject(!0,attr(e,"groupmail"),this._moWin,attr(e,"mimefrom"))},notSpam:function(e,t){this._moWin;reportNoSpamJson({},{oWin:this._moWin,sFid:this._moConfig.folderid,oACB:null,bPop:!1,bML:!1,oMail:[{sMid:t,bUnr:!1}]})},reportSpam:function(e,t){var i=this,n=(i._moConfig,"1"!=i.attr(e,"noaddblack")),a=0,o=new Array,r=i.attr(e,"mimefrom"),l=i.attr(e,"mailfrom");r&&0<r.length&&(o[a++]=r),l&&0<l.length&&(o[a++]=l),reportSpamJson({bBlackList:n,oAddrList:o},{oWin:i._moWin,sFid:i._moConfig.folderid,oACB:null,bPop:!1,bML:!1,oMail:[{sMid:t,bUnr:!1}]})},openSpam:function(){this._locMore("&disptype=html&dispimg=1&clickshowimage=1")},addWhiteSubmit:function(e,t,i){var n=this._moWin,a=this._moMailInfo.from.addr;if(!checkMail(trim(a)))return!1;_({oWin:n,sMethod:"POST",sAction:p.replace({sid:getSid(),fromaddr:a})}).submit(),runUrlWithSid(g.replace({rtype:1000006,rmsg:t})),rdVer(t,1),this.openSpam(),show(this._moCheatCodeBar,!1),preventDefault(i)},addSpamVote:function(e,t){var i=this,n=i.attr(e,"rtype");if(runUrlWithSid(g.replace({rtype:n,rmsg:t})+"&r_subtype=spamvote"),"1"==n)i.S($._sGreenBar).innerHTML='\u60a8\u8fd8\u53ef\u4ee5\u5c06\u6b64\u53d1\u4ef6\u4eba\u53d1\u6765\u7684\u90ae\u4ef6\uff0c\u81ea\u52a8\u5f52\u6863\u5230"\u90ae\u4ef6\u5f52\u6863"\u6587\u4ef6\u5939',i.S($._sGreenBarText).innerHTML="\u81ea\u52a8\u5f52\u6863";else if("2"==n)i.S($._sGreenBar).innerHTML="\u5982\u679c\u4e0d\u60f3\u518d\u6536\u5230\u6b64\u53d1\u4ef6\u4eba\u7684\u90ae\u4ef6\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9&nbsp;<a ck='reject' href='javascript:;'>\u62d2\u6536</a>",show(i.S($._sGreenBarText),!1);else{getTop().showInfo("\u5df2\u6210\u529f\u53cd\u9988\u60c5\u51b5"),i.S($._sGreenBar).parentNode.style.display="none"}rdVer(t,1)},openHttpImage:function(e,t,i){runUrlWithSid(g.replace({rtype:"1000004",rmsg:t,rresult:1})),this.openSpam(),preventDefault(i)},openHttpSecureImage:function(e,t,i){runUrlWithSid(g.replace({rtype:1000005,rresult:1,rmsg:t})),this._locMore("&dispimg=1"),preventDefault(i)},openUserEdu:function(e,t){runUrlWithSid(g.replace({rtype:1000007,rresult:1,rmsg:t}))},exbookEmlMgr:function(e,t){var i=this,n=i.attr(e,"book"),a=i.attr(e,"tuan")||0;loadingBox({model:"\u53cd\u5783\u573e",js:["$js_path$"+getTop().getFullResSuffix("qmantispam.js")],oncheck:function(){return!!getTop().QMAntiSpam},onload:function(){var e=new QMAntiSpam.qmExbookEmlMgr({sMailId:t,from:i._moMailInfo.from,fOnReload:function(){v(t,i._moWin)}});"1"==n?e.book1():e.book2(a)}})}}}),w.qmSenderInfo=inherit("qmSenderInfo",w._qmBaseDM,function(e){return{_initMemVar:function(e,t){this._moMail=t,this._moConfig=e},_setEvent:function(){this.evt(["ck"],[$._sSenderInfo,$._sSenderInfo2,$._sSenderInfo3])},_getBlogList:function(){createIframe(this._moWin,a.replace({sid:getSid(),mail:this._moMail}),{id:"iframeRss"})},_getMailList:function(){},_createMailFrm:function(e,t){_({oWin:this._moWin,sFormId:"mail_frm",sAction:"/cgi-bin/mail_mgr"},extend({s:"readmail_spam",s_reject_what:"11",isspam:"true",mailid:e,reporttype:"",location:"readmail",srcfolderid:this._moConfig.folderid,mailaction:"mail_spam"},t))},showSenderDlg:function(l,s){var o=this;new(getTop().QMDialog)({sId:"ViewContactDetail",sTitle:"\u53d1\u4ef6\u4eba\u8be6\u7ec6\u4fe1\u606f",sBodyHtml:'<div id="info_box" style="height:325px;overflow:hidden;"><div style="padding-top:130px;background:#fff;"><div class="ico_loading_all"</div></div></div>',sFootHtml:'<a class="button_gray button_spaceRight" id="close" md="0" nocheck="true" initlized="true">\u5173\u95ed</a>',nHeight:400,nWidth:600,onload:function(){var r=this;getTop().QMAjax.send(getTop().TE("/cgi-bin/mail_list?sid=$sid$&t=mail_list_preview&s=searchcontact&sender=$sender$&receiver=$receiver$&matchtype=include&folderid=all&category=all&from=profile&mailidx=$mailid$&is_get_ww_info=$is_get_ww_info$&r=$r$").replace({sid:getSid(),mailid:s,sender:encodeURIComponent(o._moMail.from.addr),receiver:encodeURIComponent(o._moMail.from.addr),name:encodeURIComponent(o._moMail.from.name),is_get_ww_info:l.getAttribute("is_get_ww_info"),r:Math.random()}),{method:"GET",onload:function(e,t){if(e){var i=evalValue(t),n=r.S("info_box"),a=r.getPanelDom();n.innerHTML="_"+i.sHtml||"",n.removeChild(n.firstChild),getTop().addEvent(getTop().finds("#sender_dlg_more",a)[0],"click",function(){r.close()}),getTop().addEvent(getTop().finds("#sender_dlg_reject",a)[0],"click",function(){o._moWin.QMReadMail.clearCache(),o._createMailFrm(s),r.close(),doReject(!0,l.getAttribute("groupmail"),o._moWin,l.getAttribute("email"))}),getTop().addEvent(getTop().finds("#sender_dlg_add",a)[0],"click",function(e){var t=l.getAttribute("addrid"),i="none"!=t?"editAddr":"newAddr",n="none"!=t?"\u7f16\u8f91\u8054\u7cfb\u4eba":"\u65b0\u5efa\u8054\u7cfb\u4eba",a=e.target||e.srcElement,o=getTop().T("none"!=t?"/cgi-bin/laddr_detail?sid=$sid$&view=normal&t=contact_detail&edit=2&dlgname=editAddr&AddrID=$addrid$&inbox=true":"/cgi-bin/laddr_detail?sid=$sid$&view=normal&t=contact_detail&edit=1&dlgname=newAddr&name=$name$&from=$from$&inbox=true&mailid=$mailid$&resp_charset=UTF8").replace({from:a.getAttribute("email"),name:encodeURIComponent(a.getAttribute("name")),addrid:t,mailid:s,sid:getTop().getSid()});new(getTop().QMDialog)({sId:i,sTitle:n,sUrl:o,nHeight:500,nWidth:600,onload:function(){r.close()}})}),getTop().addEvent(getTop().finds("#sender_dlg_qywx_msg",a)[0],"click",function(){var e=new QMAjax;e.method="post",e.url="/cgi-bin/readtemplate?action=get_self_wework_info&t=rss_mgr&sid="+getSid(),e.send(),e.onComplete=function(e){var t=null;e&&"1"!=(t=evalValue(e.responseText)).feed.active&&(getTop().confirmBox({title:"\u4f01\u4e1a\u5fae\u4fe1\u5de5\u4f5c\u4fe1\u606f\u5c55\u793a",msg:'<p style="font-size: 12px; margin: 0; line-height: 12px;">\u4f60\u7684\u4f01\u4e1a\u5df2\u5f00\u901a\u201c\u4f01\u4e1a\u5fae\u4fe1\u201d\uff0c\u5b89\u88c5\u540e\u5373\u53ef\u53d1\u9001\u6d88\u606f</p><p style="margin: 0; font-size: 12px; color: #9F9F9F; margin-top: 3px;">\u5df2\u7ecf\u6709'+t.feed.ww_user_cnt+'\u4eba\u540c\u4e8b\u4f7f\u7528\u4f01\u4e1a\u5fae\u4fe1 <a href="http://work.weixin.qq.com/wework_admin/mail_promote_activedcnt?vccode='+t.feed.vcode+'&from=exmail_web_profile_message"  target="_blank">\u4e86\u89e3\u66f4\u591a</a></p> ',confirmBtnTxt:"\u7acb\u5373\u5b89\u88c5",cancelBtnTxt:"\u53d6\u6d88",onreturn:function(e){e&&(window.open("https://work.weixin.qq.com/wework_admin/commdownload?vccode="+t.feed.ww_user_cnt+"&from=exmail_web_profile_message"),(new Image).src="/cgi-bin/sellonlinestatic?sid="+getSid()+"&type=session_statistics&businame=qywework&item=biz_wwlogo_profile_chat_download&r="+Math.random())}}),(new Image).src="/cgi-bin/sellonlinestatic?sid="+getSid()+"&type=session_statistics&businame=qywework&item=biz_wwlogo_profile_chat_dialog&r="+Math.random())},(new Image).src="/cgi-bin/sellonlinestatic?sid="+getSid()+"&type=session_statistics&businame=qywework&item=biz_wwlogo_detail_profile_chat&r="+Math.random()}),getTop().addEvent(getTop().finds("#sender_dlg_qywx_tel",a)[0],"click",function(){var e=new QMAjax;(new Image).src="/cgi-bin/sellonlinestatic?sid="+getSid()+"&type=session_statistics&businame=qywework&item=biz_wwlogo_detail_profile_call&r="+Math.random(),e.method="post",e.url="/cgi-bin/readtemplate?action=get_self_wework_info&t=rss_mgr&sid="+getSid(),e.send(),e.onComplete=function(e){var t=null;if(e)if("1"===(t=evalValue(e.responseText)).feed.active){var i=new QMAjax;i.method="post",i.url="/cgi-bin/readtemplate?sid="+getSid()+"&action=call_by_wework&t=rss_mgr&callee_email="+getTop().finds("#sender_dlg_qywx_tel",a)[0].getAttribute("email"),i.send(),i.onComplete=function(e){var t=null;e&&("0"===(t=evalValue(e.responseText)).feed.errcode?new(getTop().QMDialog)({sTitle:"\u547c\u53eb\u5df2\u7ecf\u53d1\u51fa",sBodyHtml:'<div class="cnfx_content"><span class="dialog_icon icon_finish_b"></span><div class="dialog_f_c"><p style="font-size: 12px; margin: 0; line-height: 12px;">\u547c\u53eb\u5df2\u7ecf\u53d1\u51fa\u3002\u8bf7\u5148\u5728\u4f60\u7684\u624b\u673a\u4e0a\u63a5\u542c\u6765\u7535\uff0c\u968f\u540e\u5c06\u81ea\u52a8\u547c\u53eb\u5bf9\u65b9\u3002</p> </div></div>',sFootHtml:'<div class=" txt_right cnfx_btn"><input class="btn_gray btn_input" type="button" id="cancel" value="\u5173\u95ed" />',onload:function(){var t=this,e=t.S("cancel");addEvents([e],{click:function(e){t.close()}})}}):new(getTop().QMDialog)({sTitle:"\u547c\u53eb\u5931\u8d25",sBodyHtml:'<div class="cnfx_content"><span class="dialog_icon icon_info_b"></span><div class="dialog_f_c"><p style="margin: 0;">'+t.feed.errmsg+"</p></div></div>",sFootHtml:'<div class=" txt_right cnfx_btn"><input class="btn_gray btn_input" type="button" id="cancel" value="\u5173\u95ed" />',onload:function(){var t=this,e=t.S("cancel");addEvents([e],{click:function(e){t.close()}})}}))}}else(new Image).src="/cgi-bin/sellonlinestatic?sid="+getSid()+"&type=session_statistics&businame=qywework&item=biz_wwlogo_profile_call_dialog&r="+Math.random(),getTop().confirmBox({title:"\u4f01\u4e1a\u5fae\u4fe1\u5de5\u4f5c\u4fe1\u606f\u5c55\u793a",msg:'<p style="font-size: 12px; margin: 0; line-height: 18px; margin-top: -10px;">\u4f60\u7684\u4f01\u4e1a\u5df2\u5f00\u901a\u201c\u4f01\u4e1a\u5fae\u4fe1\u201d\uff0c\u5b89\u88c5\u540e\u5373\u53ef\u4f7f\u7528\u516c\u8d39\u7535\u8bdd\u529f\u80fd\u7ed9<br>\u540c\u4e8b\u6253\u7535\u8bdd\u3002</p><p style="margin: 0; font-size: 12px; color: #9F9F9F; margin-top: 3px; margin-bottom: -10px;">\u5df2\u7ecf\u6709'+t.feed.ww_user_cnt+'\u4f4d\u540c\u4e8b\u4f7f\u7528\u4f01\u4e1a\u5fae\u4fe1 <a href="http://work.weixin.qq.com/wework_admin/mail_promote_activedcnt?vccode='+t.feed.vcode+'&from=exmail_web_profile_telephone"  target="_blank">\u4e86\u89e3\u66f4\u591a</a></p> ',confirmBtnTxt:"\u7acb\u5373\u5b89\u88c5",cancelBtnTxt:"\u53d6\u6d88",onreturn:function(e){e&&((new Image).src="/cgi-bin/sellonlinestatic?sid="+getSid()+"&type=session_statistics&businame=qywework&item=biz_wwlogo_profile_call_download&r="+Math.random(),new(getTop().QMDialog)({nWidth:300,sTitle:"\u626b\u7801\u4e0b\u8f7d\u4f01\u4e1a\u5fae\u4fe1",sBodyHtml:'<div><img src="https://work.weixin.qq.com/wework_admin/genqrcode?action=commdownload&vccode='+t.feed.vcode+'&from=exmail_profile_tips&qr_size=32" style="width:250px; height:250px; margin-top: 10px;"><p style="margin: 0px;padding-bottom: 30px;">\u626b\u7801\u4e0b\u8f7d\u4f01\u4e1a\u5fae\u4fe1\u5ba2\u6237\u7aef</p></div>',onload:function(){var t=this,e=t.S("cancel");addEvents([e],{click:function(e){t.close()}})}}))}})}}),getTop().addEvent(r.S("close"),"click",function(e){r.close()})}}})}})}}}),w.qmConvMail=inherit("qmConvMail",w.qmReadMail,function(r){return{_initMemVar:function(){r._initMemVar.apply(this,arguments),this._moSubMails={}},_setEvent:function(){this.evt(["ck","dck"],this._moWin.document.body)},_startSubMod:function(e){var t,i=this,n=i._moMailInfo,a=extend({},i._moContext,e);switch(a.sModuleName){case"qmSubMail":var o=n.oSubMails[a.sAux]||[{},{}],r=a.sContext||"";o[0].cmailid=i.getMailId(),t=new w.qmSubMail(o[0],o[1],a),r&&(i._moSubMails[r]=t);break;case"qmQReply":o=n.oSubMails[0];t=i._moQReply=new w.qmQReply(o[0],o[1],{fCheckBcc:function(){callBack.call(i,i.checkBcc,arguments)},fQReplyComplete:function(e){i._qReplyComplete(e)},s:"conv_send"},a);break;case b:var l=getTop();"1"==l.getGlobalVarValue("DEF_TRANSLATE")&&loadJsFile(l.getPath("js")+l.getFullResSuffix("qmtranslate.js"),!0,s.document,function(){waitFor(function(){return i.S($._sContentDiv)&&s.QMTranslate},function(e){if(e){var t=i.S($._sContentDiv);new s.QMTranslate({oDom:t})}})})}return t},_qReplyComplete:function(e){var t=evalValue(e),i=this.S($._sSubMailStartDiv);t?(this.S($._sQSource).view("init"),insertHTML(i,"afterEnd",t.mailstr)):this.S($._sQSource).view("show")},optMail:function(e,t,i){var n=this.S("submail_inner_body"),a=finds('div[ck="dispSubMail"]',n),o=this.parentToContextDom(a[0]);o&&(t=o.getAttribute("context")),r.optMail.call(this,e,t,i)},parentToContextDom:function(e){return parents("div[module='qmSubMail']",e)[0]},_pageReady:function(){var t=this,e=t._moWin,i=t._moConfig,n=t._moMailInfo;if(t._fakeReadMail(),t._readMailFinish(),initMailSelect(i.oMoveItems,!0,"1"==i.bOpenTag,e,i.folderid,i.bAutoTag),E(n.oSubMails,function(e){e&&!e[1].bAsyn&&(t._startSubMod(e[2]),"0"==e[2].sAux&&t._startSubMod({sModuleName:"qmQReply",sAux:"",sContext:e[2].sContext})),e&&getTop().QMWebpushTip&&getTop().QMWebpushTip.read(1,e[2].sContext)}),0!=i.nRet&&""==i.bRetry){var a=t._moWin.location.href+"";a=a.replace(/#.*/gi,"")+"&retry=1",t.clearCache(),t._moWin.location=a}t._flushFolder(),container_name="submail_inner_body";for(var o=0,r=document.getElementById("mainFrame").contentWindow.document.getElementById(container_name).getElementsByTagName("*"),l=r.length,s=0;s<l;s++)null!=r[s].getAttribute("lazybackground")?o+=1:"img"==r[s].tagName.toLowerCase()&&null!=r[s].getAttribute("lazysrc")&&(o+=1);if(50<o){!function d(){for(var e=[],t=0;t<l;t++)null!=r[t].getAttribute("lazybackground")?(r[t].setAttribute("lazybackground",r[t].getAttribute("lazybackground")+"?"+Math.random()),e.push(r[t])):"img"==r[t].tagName.toLowerCase()&&null!=r[t].getAttribute("lazysrc")&&(r[t].setAttribute("lazysrc",r[t].getAttribute("lazysrc")+"?"+Math.random()),e.push(r[t]));new ImagesLazyLoad({container:container_name,mode:"cross",holder:"",onLoad:function(e){},images:e,getSrc:function(e){return null!=e.getAttribute("lazybackground")?e.getAttribute("lazybackground"):"img"==e.tagName.toLowerCase()&&null!=e.getAttribute("lazysrc")?e.getAttribute("lazysrc"):void 0}})}()}else for(s=0;s<l;s++)null!=r[s].getAttribute("lazybackground")?(r[s].setAttribute("background",r[s].getAttribute("lazybackground")),r[s].removeAttribute("lazybackground")):"img"==r[s].tagName.toLowerCase()&&null!=r[s].getAttribute("lazysrc")&&(r[s].src=r[s].getAttribute("lazysrc"),r[s].removeAttribute("lazysrc"))},getSubMailWithDom:function(e){for(var t,i,n=e,a=e.ownerDocument;n&&n!=a;){if((t=attr(n,x._CON_ATTR))&&(i=this._moSubMails[t]))return i.getMailInfo();n=n.parentNode}return null},getSubMailFrom:function(e){var t=this._moSubMails[e];if(t)return t.getMailInfo().from.name}}}),w.qmSubMail=inherit("qmSubMail",w.qmReadMail,function(e){return{_setEvent:function(){var e=this._moWin;"0"==this._moConfig.sIndex&&this.evt(["ck"],SN(t,e)),this.evt(["ck","dck"],$._sSubMail)},_ready:function(e){var t=this,i=t._moWin,n=t._moConfig,a=t._moMailInfo,o=t.S($._sContentDiv);n.bMusicManuPlay="0"!=n.sIndex,a.bAsyn||(swapLink(o,a.disptype,i,t.getMailId()),t.checkDecryptMail()),t._startSubMod({sModuleName:"qmRemark"}),t._startSubMod({sModuleName:"qmAntiSpam"}),t._startSubMod({sModuleName:"qmPlayerParser"}),t._adjustMailContainer(),getTop().goUserInfo.deferget("DEF_TRANSLATE",function(e){t._startSubMod({sModuleName:b})}),n&&"string"==typeof n.sIndex&&t._fixAbsoluteContent(n.sIndex)},_getCMailId:function(){return this._moConfig.cmailid},clearCache:function(){rdVer(this._moConfig.cmailid,1)},afterDecrytMail:function(){showInfo("\u90ae\u4ef6\u52a0\u5bc6\u6210\u529f"),this._asyncGetSubMail(),this.clearCache()},_asyncGetMail:function(e,n){QMAjax.send(T("/cgi-bin/readmail?sid=$sid$&t=readsubmail&s=$s$&mailid=$mailid$&submailid=$submailid$&frid=$frid$&index=$index$").replace({sid:getSid(),mailid:this._getCMailId(),submailid:this.getMailId(),frid:this._moMailInfo.frid,s:e,index:this._moContext.sAux}),{method:"GET",headers:{"If-Modified-Since":"0","Cache-Control":"no-cache, max-age=0"},onload:function(e,t){var i=trim(t);e&&0!=i.indexOf("\x3c!--cgi exception--\x3e")?n(evalValue(i)):n()}})},_setRefer:function(e,t){var i=t.innerHTML,n=0,a=GelTags("form",this.S($._sContentDiv)),o=parents("div[module='qmSubMail']",t)[0],r=!1;try{r="true"==getTop().finds(".translateMailContainer",o)[0].children[0].getAttribute("data-hastrans")}catch(d){}function l(e,t){e.style.display="none",e.innerHTML=t;for(var i=e.getElementsByTagName("*"),n=0;n<i.length;n++)i[n].className.indexOf("mailAppOrigin")&&(i[n].className=i[n].className.replace("mailAppOrigin",""));e.style.display=""}for(n=0;n<a.length;n++){var s=a[n];if("1"==attr(s,"_refer_")){if(e.length){if(n>=e.length)break;try{r?function(i,n){console.log("dom = ",i,", content = ",n),C({method:"POST",url:"/qy_mng_logic/translateMail?from=web&sid="+getSid()+"&r="+Math.random(),data:"content="+encodeURIComponent(n),success:function(e){if(e.data.content){var t=e.data.content;i.innerHTML=t,console.log("dom = ",i,", html = ",t)}else l(i,n)},error:function(){l(i,n)}})}(s,e[n]):l(s,e[n])}catch(d){debug("error:innerHTML readonly "+n)}}s.className=e?"":"qQmAIlcOnV"}}i=e?(attr(t,"disp","0"),i.replace("\u663e\u793a","\u9690\u85cf")):(attr(t,"disp","1"),i.replace("\u9690\u85cf","\u663e\u793a")),t.innerHTML=i},seek:function(){var e=this._moWin;scrollIntoMidView(this.S($._sSubMail),e.document.body)},newWinRead:function(e,t,i){goNewWin(T([d,"&t=readmail&folderid=$folderid$"]).replace({folderid:this._moConfig.folderid,mailid:t}),!1)},delMail:function(e){var t=this;rmMail(t.attr(e,"opt")||0,extend(t.getCBInfo(),{oncomplete:function(e){return rdVer(t._moConfig.cmailid,1),t._fandx("0",function(){removeSelf(t.S($._sSubMail)),t._moWin.QMReadMail.notify("delsubmail")}),!0}}))},getCBInfo:function(){var e=this._moConfig,t=this._moMailInfo.from||{};return{oWin:this._moWin,sFid:e.folderid,bML:!1,oMail:[{sMid:this.getMailId(),bSys:e.bSys,bUnr:!1,bSubUnr:!1,bTms:!1,sSName:t.name,sSEmail:t.addr}]}},moreOpt:function(i,n){var e=calcPos(i),a=this;new QMMenu({oEmbedWin:a._moWin,sId:"menu_"+n,oItems:[{sId:"reportSpam",sItemValue:"\u4e3e\u62a5"},{sId:"PerDel",sItemValue:"\u5f7b\u5e95\u5220\u9664"},{sId:"note",sItemValue:"\u4fdd\u5b58\u5230\u8bb0\u4e8b\u672c"},{sId:"fweml",sItemValue:"\u4f5c\u4e3a\u9644\u4ef6\u8f6c\u53d1"},{sId:"dleml",sItemValue:"\u5bfc\u51fa\u4e3aeml\u6587\u4ef6"},{sId:"mime",sItemValue:"\u663e\u793a\u90ae\u4ef6\u539f\u6587"},{sId:"code",sItemValue:"\u90ae\u4ef6\u6709\u4e71\u7801\uff1f"}],nX:e[3],nY:e[2],onitemclick:function(e,t){"reportSpam"==e?(a._moAntiSpam.reportSpam(i,n),a.clearCache()):"PerDel"==e?a.delMail({opt:"1"}):a.optMail2({opt:e},n)}})},dispRef:function(r){var l=this,e=l.attr(r,"disp");r&&!r.disabled&&("1"==e?l._setRefer(!0,r):"asyn"==e?(r.disabled=!0,showProcess(1,!0,"\u90ae\u4ef6\u8bfb\u53d6\u4e2d...",null,!1),l._asyncGetMail("refer",function(e){if(showProcess(0),e){l._setRefer(e,r),container_name="submail_inner_body";for(var t=0,i=document.getElementById("mainFrame").contentWindow.document.getElementById(container_name).getElementsByTagName("*"),n=i.length,a=0;a<n;a++)null!=i[a].getAttribute("lazybackground")?t+=1:"img"==i[a].tagName.toLowerCase()&&null!=i[a].getAttribute("lazysrc")&&(t+=1);if(50<t){!function o(){for(var e=[],t=0;t<n;t++)null!=i[t].getAttribute("lazybackground")?(i[t].setAttribute("lazybackground",i[t].getAttribute("lazybackground")+"?"+Math.random()),e.push(i[t])):"img"==i[t].tagName.toLowerCase()&&null!=i[t].getAttribute("lazysrc")&&(i[t].setAttribute("lazysrc",i[t].getAttribute("lazysrc")+"?"+Math.random()),e.push(i[t]));new ImagesLazyLoad({container:container_name,mode:"cross",holder:"",onLoad:function(e){},images:e,getSrc:function(e){return null!=e.getAttribute("lazybackground")?e.getAttribute("lazybackground"):"img"==e.tagName.toLowerCase()&&null!=e.getAttribute("lazysrc")?e.getAttribute("lazysrc"):void 0}})}()}else for(a=0;a<n;a++)null!=i[a].getAttribute("lazybackground")?(i[a].setAttribute("background",i[a].getAttribute("lazybackground")),i[a].removeAttribute("lazybackground")):"img"==i[a].tagName.toLowerCase()&&null!=i[a].getAttribute("lazysrc")&&(i[a].src=i[a].getAttribute("lazysrc"),i[a].removeAttribute("lazysrc"))}else showError("\u90ae\u4ef6\u8bfb\u53d6\u5931\u8d25");r.disabled=!1})):"0"==e&&l._setRefer(!1,r))},dispDetail:function(e){var t=this,i=t._moMailInfo,n=t.attr(e,"disp"),a=t.S($._sDetailBtn),o=t.S($._sDetail),r=t.S($._sSum),l=GelTags("img",a)[0],s=GelTags("a",a)[0],d=t.S($._sReferInfo);if("1"==n){if(isShow(o))return;show(r,!1),qmAnimation.expand(o),l.title=s.title="\u9690\u85cf\u90ae\u4ef6\u8be6\u60c5",l.className="qm_conversation_input_hidemail",s.innerHTML="\u9690\u85cf",attr(a,"disp","0"),d&&""==d.innerHTML&&(d.innerHTML=t._moWin.QMReadMail.getSubMailFrom(i.refermailid)||"")}else{if(isShow(r))return;qmAnimation.fold(o,{oncomplete:function(){show(r,!0)}}),l.title=s.title="\u663e\u793a\u90ae\u4ef6\u8be6\u60c5",l.className="qm_conversation_input_showmail",s.innerHTML="\u90ae\u4ef6\u8be6\u60c5",attr(a,"disp","1")}},_fandx:function(e,t){var i=this.S($._sFold),n=this.S($._sExpand),a=this.S($._sSubMail);if(isShow(i)){var o=i.scrollHeight;show(i,!1),show(n,!0),setClass(a,"qm_con_expand"),qmAnimation.expand(n,{from:o,speed:"fast",tween:"Sine"})}else if(isShow(n)){show(i,!0);var r=i.scrollHeight;show(i,!1),qmAnimation.fold(n,{speed:"fast",to:r||48,oncomplete:t||function(){setClass(a,"qm_con_fold"),show(n,!1),show(i,!0)}})}},toReferMail:function(e){this._moWin.QMReadMail.notify("toRefer",this._moMailInfo.refermailid)},_asyncGetSubMail:function(){var r=this;showProcess(1,!0,"\u90ae\u4ef6\u8bfb\u53d6\u4e2d...",null,!1),r._asyncGetMail("submail",function(e){if(e){showProcess(0),r.S($._sSubMail).innerHTML=e.mailstr,r._fandx(),r._moMailInfo.bAsyn=!1,r._ready(),container_name="submail_inner_body";for(var t=0,i=document.getElementById("mainFrame").contentWindow.document.getElementById(container_name).getElementsByTagName("*"),n=i.length,a=0;a<n;a++)null!=i[a].getAttribute("lazybackground")?t+=1:"img"==i[a].tagName.toLowerCase()&&null!=i[a].getAttribute("lazysrc")&&(t+=1);if(50<t){!function o(){for(var e=[],t=0;t<n;t++)null!=i[t].getAttribute("lazybackground")?(i[t].setAttribute("lazybackground",i[t].getAttribute("lazybackground")+"?"+Math.random()),e.push(i[t])):"img"==i[t].tagName.toLowerCase()&&null!=i[t].getAttribute("lazysrc")&&(i[t].setAttribute("lazysrc",i[t].getAttribute("lazysrc")+"?"+Math.random()),e.push(i[t]));new ImagesLazyLoad({container:container_name,mode:"cross",holder:"",onLoad:function(e){},images:e,getSrc:function(e){return null!=e.getAttribute("lazybackground")?e.getAttribute("lazybackground"):"img"==e.tagName.toLowerCase()&&null!=e.getAttribute("lazysrc")?e.getAttribute("lazysrc"):void 0}})}()}else for(a=0;a<n;a++)null!=i[a].getAttribute("lazybackground")?(i[a].setAttribute("background",i[a].getAttribute("lazybackground")),i[a].removeAttribute("lazybackground")):"img"==i[a].tagName.toLowerCase()&&null!=i[a].getAttribute("lazysrc")&&(i[a].src=i[a].getAttribute("lazysrc"),i[a].removeAttribute("lazysrc"))}else showError("\u90ae\u4ef6\u8bfb\u53d6\u5931\u8d25")})},dispSubMail:function(e){var t=this;"1"==t.attr(e,"asyn")?(t._asyncGetSubMail(),"true"==t.attr(e,"newmail")&&(t.attr(e,"newmail","false"),hasClass(e,"mailunread")&&rmClass(e,"mailunread"),!hasClass(e,"mailread")&&addClass(e,"mailread"))):t._fandx()}}}),s.QMReadMail=w,s.readmailSpread=function k(e,t,i){var n,a=getTop(),o=e;if(o.location&&(/^(set\d\.)?exmail.qq.com$/.test(o.location.hostname)||/dev.exmail.qq.com$/.test(o.location.hostname))){var r=o.document.getElementById("webmail")||null,l=o.document.getElementById("notWebmail")||null;r&&(r.style.display=""),l&&(l.style.display="none"),i&&i.isNname&&(n=a.getUserInfoText("alias"))&&""!=n&&(o.document.getElementById("qqmlNickName").innerHTML="Hi\uff0c"+a.htmlEncode(n)+"\uff1a")}}})(window);